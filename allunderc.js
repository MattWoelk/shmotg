d3=function(){function k(a){return null!=a&&!isNaN(a)}function q(a){return a.length}function v(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function A(){}function F(){}function J(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function E(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.substring(1);for(var c=0,d=ge.length;d>c;++c){var f=ge[c]+b;if(f in a)return f}}function I(){}function O(){}function S(a){function b(){for(var b, d=c,n=-1,m=d.length;++n<m;)(b=d[n].on)&&b.apply(this,arguments);return a}var c=[],d=new A;return b.on=function(b,g){var n,m=d.get(b);return 2>arguments.length?m&&m.on:(m&&(m.on=null,c=c.slice(0,n=c.indexOf(m)).concat(c.slice(n+1)),d.remove(b)),g&&c.push(d.set(b,{on:g})),a)},b}function z(){r.event.preventDefault()}function s(){for(var a,b=r.event;a=b.sourceEvent;)b=a;return b}function x(a){for(var b=new O,c=0,d=arguments.length;++c<d;)b[arguments[c]]=S(b);return b.of=function(c,d){return function(n){try{var m= n.sourceEvent=r.event;n.target=a;r.event=n;b[n.type].apply(c,d)}finally{r.event=m}}},b}function h(a){return cc(a,Y),a}function e(a){return"function"==typeof a?a:function(){return dd(a,this)}}function t(a){return"function"==typeof a?a:function(){return ed(a,this)}}function K(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function f(){this.setAttribute(a,b)}function g(){this.setAttributeNS(a.space,a.local,b)}function n(){var c=b.apply(this,arguments); null==c?this.removeAttribute(a):this.setAttribute(a,c)}function m(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=r.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?m:n:a.local?g:f}function Q(a){return a.trim().replace(/\s+/g," ")}function da(a){return RegExp("(?:^|\\s+)"+r.requote(a)+"(?:\\s+|$)","g")}function pa(a,b){function c(){for(var c=-1;++c<f;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this, arguments);++c<f;)a[c](this,d)}a=a.trim().split(/\s+/).map(la);var f=a.length;return"function"==typeof b?d:c}function la(a){var b=da(a);return function(c,d){if(f=c.classList)return d?f.add(a):f.remove(a);var f=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(f)||c.setAttribute("class",Q(f+" "+a))):c.setAttribute("class",Q(f.replace(b," ")))}}function p(a,b,c){function d(){this.style.removeProperty(a)}function f(){this.style.setProperty(a,b,c)}function g(){var d=b.apply(this,arguments);null==d? this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?g:f}function W(a,b){function c(){delete this[a]}function d(){this[a]=b}function f(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?f:d}function ea(a){return"function"==typeof a?a:(a=r.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,a)}} function ta(a){return function(){return he(this,a)}}function na(a){return arguments.length||(a=r.ascending),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function ha(a,b){for(var c=0,d=a.length;d>c;c++)for(var f,g=a[c],n=0,m=g.length;m>n;n++)(f=g[n])&&b(f,n,c);return a}function ua(a){return cc(a,Ya),a}function Ba(a){var b,c;return function(d,f,g){d=a[g].update;var n=d.length;g!=c&&(c=g,b=0);for(f>=b&&(b=f+1);!(f=d[b])&&++b<n;);return f}}function ja(){var a=this.__transition__;a&&++a.active} function Na(a,b,c){function d(){var b=this[n];b&&(this.removeEventListener(a,b,b.$),delete this[n])}function f(){var g=y(b,gb(arguments));d.call(this);this.addEventListener(a,this[n]=g,g.$=c);g._=b}function g(){var b,c=RegExp("^__on([^.]+)"+r.requote(a)+"$"),d;for(d in this)if(b=d.match(c)){var g=this[d];this.removeEventListener(b[1],g,g.$);delete this[d]}}var n="__on"+a,m=a.indexOf("."),y=Oa;0<m&&(a=a.substring(0,m));var u=fd.get(a);return u&&(a=u,y=X),m?b?f:d:b?I:g}function Oa(a,b){return function(c){var d= r.event;r.event=c;b[0]=this.__data__;try{a.apply(this,b)}finally{r.event=d}}}function X(a,b){var c=Oa(a,b);return function(a){var b=a.relatedTarget;b&&(b===this||8&b.compareDocumentPosition(this))||c.call(this,a)}}function Ca(){var a=".dragsuppress-"+ ++xg,b="click"+a,c=r.select(qa).on("touchmove"+a,z).on("dragstart"+a,z).on("selectstart"+a,z);if(Nb){var d=hb.style,f=d[Nb];d[Nb]="none"}return function(g){function n(){c.on(b,null)}c.on(a,null);Nb&&(d[Nb]=f);g&&(c.on(b,function(){z();n()},!0),setTimeout(n, 0))}}function fa(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(0>gd&&(qa.scrollX||qa.scrollY)){var c=r.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),f=c[0][0].getScreenCTM();gd=!(f.f||f.e);c.remove()}return gd?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}c=a.getBoundingClientRect();return[b.clientX- c.left-a.clientLeft,b.clientY-c.top-a.clientTop]}function xa(a){return 1<a?0:-1>a?T:Math.acos(a)}function l(a){return 1<a?ya:-1>a?-ya:Math.asin(a)}function w(a){return((a=Math.exp(a))-1/a)/2}function C(a){return((a=Math.exp(a))+1/a)/2}function B(a){return(a=Math.sin(a/2))*a}function ga(){}function $(a,b,c){return new pb(a,b,c)}function pb(a,b,c){this.h=a;this.s=b;this.l=c}function Ia(a,b,c){function d(a){return 360<a?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}var f, g;return a=isNaN(a)?0:0>(a%=360)?a+360:a,b=isNaN(b)?0:0>b?0:1<b?1:b,c=0>c?0:1<c?1:c,g=0.5>=c?c*(1+b):c+b-c*b,f=2*c-g,Ja(Math.round(255*d(a+120)),Math.round(255*d(a)),Math.round(255*d(a-120)))}function ba(a,b,c){return new Ta(a,b,c)}function Ta(a,b,c){this.h=a;this.c=b;this.l=c}function Z(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),aa(c,Math.cos(a*=R)*b,Math.sin(a)*b)}function aa(a,b,c){return new ma(a,b,c)}function ma(a,b,c){this.l=a;this.a=b;this.b=c}function Ua(a,b,c){a=(a+16)/116;b=a+b/500;c= a-c/200;return b=Da(b)*ie,a=Da(a)*je,c=Da(c)*ke,Ja(Ob(3.2404542*b-1.5371385*a-0.4985314*c),Ob(-0.969266*b+1.8760108*a+0.041556*c),Ob(0.0556434*b-0.2040259*a+1.0572252*c))}function Bb(a,b,c){return 0<a?ba(Math.atan2(c,b)*ca,Math.sqrt(b*b+c*c),a):ba(0/0,0/0,a)}function Da(a){return 0.206893034<a?a*a*a:(a-4/29)/7.787037}function oa(a){return 0.008856<a?Math.pow(a,1/3):7.787037*a+4/29}function Ob(a){return Math.round(255*(0.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-0.055))}function qb(a){return Ja(a>> 16,255&a>>8,255&a)+""}function Ja(a,b,c){return new Pb(a,b,c)}function Pb(a,b,c){this.r=a;this.g=b;this.b=c}function Ea(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function dc(a,b,c){var d,f,g,n=0,m=0,y=0;if(d=/([a-z]+)\((.*)\)/i.exec(a))switch(f=d[2].split(","),d[1]){case "hsl":return c(parseFloat(f[0]),parseFloat(f[1])/100,parseFloat(f[2])/100);case "rgb":return b(N(f[0]),N(f[1]),N(f[2]))}return(g=ec.get(a))?b(g.r,g.g,g.b):(null!=a&&"#"===a.charAt(0)&&(4===a.length? (n=a.charAt(1),n+=n,m=a.charAt(2),m+=m,y=a.charAt(3),y+=y):7===a.length&&(n=a.substring(1,3),m=a.substring(3,5),y=a.substring(5,7)),n=parseInt(n,16),m=parseInt(m,16),y=parseInt(y,16)),b(n,m,y))}function fc(a,b,c){var d,f,g=Math.min(a/=255,b/=255,c/=255),n=Math.max(a,b,c),m=n-g,y=(n+g)/2;return m?(f=0.5>y?m/(n+g):m/(2-n-g),d=a==n?(b-c)/m+(c>b?6:0):b==n?(c-a)/m+2:(a-b)/m+4,d*=60):(d=0/0,f=0<y&&1>y?0:d),$(d,f,y)}function Qb(a,b,c){a=Pa(a);b=Pa(b);c=Pa(c);var d=oa((0.4124564*a+0.3575761*b+0.1804375*c)/ ie),f=oa((0.2126729*a+0.7151522*b+0.072175*c)/je);a=oa((0.0193339*a+0.119192*b+0.9503041*c)/ke);return aa(116*f-16,500*(d-f),200*(f-a))}function Pa(a){return 0.04045>=(a/=255)?a/12.92:Math.pow((a+0.055)/1.055,2.4)}function N(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function V(a){return"function"==typeof a?a:function(){return a}}function ra(a){return a}function hd(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),id(b,c,a, d)}}function id(a,b,c,d){function f(){var a,b=y.status;if(!b&&y.responseText||200<=b&&300>b||304===b){try{a=c.call(g,y)}catch(d){return n.error.call(g,d),void 0}n.load.call(g,a)}else n.error.call(g,y)}var g={},n=r.dispatch("beforesend","progress","load","error"),m={},y=new XMLHttpRequest,u=null;return!qa.XDomainRequest||"withCredentials"in y||!/^(http(s)?:)?\/\//.test(a)||(y=new XDomainRequest),"onload"in y?y.onload=y.onerror=f:y.onreadystatechange=function(){3<y.readyState&&f()},y.onprogress=function(a){var b= r.event;r.event=a;try{n.progress.call(g,y)}finally{r.event=b}},g.header=function(a,b){return a=(a+"").toLowerCase(),2>arguments.length?m[a]:(null==b?delete m[a]:m[a]=b+"",g)},g.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",g):b},g.responseType=function(a){return arguments.length?(u=a,g):u},g.response=function(a){return c=a,g},["get","post"].forEach(function(a){g[a]=function(){return g.send.apply(g,[a].concat(gb(arguments)))}}),g.send=function(c,d,f){if(2===arguments.length&&"function"== typeof d&&(f=d,d=null),y.open(c,a,!0),null==b||"accept"in m||(m.accept=b+",*/*"),y.setRequestHeader)for(var l in m)y.setRequestHeader(l,m[l]);return null!=b&&y.overrideMimeType&&y.overrideMimeType(b),null!=u&&(y.responseType=u),null!=f&&g.on("error",f).on("load",function(a){f(null,a)}),n.beforesend.call(g,y),y.send(null==d?null:d),g},g.abort=function(){return y.abort(),g},r.rebind(g,n,"on"),null==d?g:g.get(yg(d))}function yg(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function jd(){var a= le(),a=me()-a;24<a?(isFinite(a)&&(clearTimeout(gc),gc=setTimeout(jd,a)),hc=0):(hc=1,ne(jd))}function le(){var a=Date.now();for(Za=ic;Za;)a>=Za.t&&(Za.f=Za.c(a-Za.t)),Za=Za.n;return a}function me(){for(var a,b=ic,c=1/0;b;)b.f?b=a?a.n=b.n:ic=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return jc=a,c}function kd(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function zg(a){return a+""}function ld(){}function oe(a,b,c){var d=c.s=a+b,f=d-a;c.t=a-(d-f)+(b-f)}function kc(a,b){a&&pe.hasOwnProperty(a.type)&&pe[a.type](a, b)}function md(a,b,c){var d=-1,f=a.length-c;for(b.lineStart();++d<f;)c=a[d],b.point(c[0],c[1],c[2]);b.lineEnd()}function qe(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)md(a[c],b,1);b.polygonEnd()}function Ag(){function a(a,b){a*=R;b=b*R/2+T/4;var c=a-d,u=Math.cos(b),D=Math.sin(b),Ha=g*D,G=f*u+Ha*Math.cos(c),c=Ha*Math.sin(c);rb.add(Math.atan2(c,G));d=a;f=u;g=D}var b,c,d,f,g;Fa.point=function(n,m){Fa.point=a;d=(b=n)*R;f=Math.cos(m=(c=m)*R/2+T/4);g=Math.sin(m)};Fa.lineEnd=function(){a(b,c)}} function sb(a){var b=a[0];a=a[1];var c=Math.cos(a);return[c*Math.cos(b),c*Math.sin(b),Math.sin(a)]}function lc(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function Cb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function nd(a,b){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2]}function mc(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function nc(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b;a[1]/=b;a[2]/=b}function oc(a){return[Math.atan2(a[1],a[0]),l(a[2])]}function pc(a,b){return U(a[0]- b[0])<L&&U(a[1]-b[1])<L}function od(a,b){a*=R;var c=Math.cos(b*=R);Rb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function Rb(a,b,c){++Sb;$a+=(a-$a)/Sb;ab+=(b-ab)/Sb;Va+=(c-Va)/Sb}function re(){function a(a,g){a*=R;var n=Math.cos(g*=R),m=n*Math.cos(a),n=n*Math.sin(a),y=Math.sin(g),u=Math.atan2(Math.sqrt((u=c*y-d*n)*u+(u=d*m-b*y)*u+(u=b*n-c*m)*u),b*m+c*n+d*y);Db+=u;Ka+=u*(b+(b=m));La+=u*(c+(c=n));za+=u*(d+(d=y));Rb(b,c,d)}var b,c,d;Qa.point=function(f,g){f*=R;var n=Math.cos(g*=R);b=n*Math.cos(f);c=n* Math.sin(f);d=Math.sin(g);Qa.point=a;Rb(b,c,d)}}function se(){Qa.point=od}function Bg(){function a(a,b){a*=R;var c=Math.cos(b*=R),u=c*Math.cos(a),c=c*Math.sin(a),D=Math.sin(b),Ha=f*D-g*c,G=g*u-d*D,l=d*c-f*u,r=Math.sqrt(Ha*Ha+G*G+l*l),h=d*u+f*c+g*D,e=r&&-xa(h)/r,r=Math.atan2(r,h);ib+=e*Ha;jb+=e*G;Wa+=e*l;Db+=r;Ka+=r*(d+(d=u));La+=r*(f+(f=c));za+=r*(g+(g=D));Rb(d,f,g)}var b,c,d,f,g;Qa.point=function(n,m){b=n;c=m;Qa.point=a;n*=R;var y=Math.cos(m*=R);d=y*Math.cos(n);f=y*Math.sin(n);g=Math.sin(m);Rb(d, f,g)};Qa.lineEnd=function(){a(b,c);Qa.lineEnd=se;Qa.point=od}}function Eb(){return!0}function te(a,b,c,d,f){var g=[],n=[];if(a.forEach(function(a){if(!(0>=(b=a.length-1))){var b,c=a[0],d=a[b];if(pc(c,d)){f.lineStart();for(d=0;b>d;++d)f.point((c=a[d])[0],c[1]);return f.lineEnd(),void 0}b=new qc(c,a,null,!0);c=new qc(c,null,b,!1);b.o=c;g.push(b);n.push(c);b=new qc(d,a,null,!1);c=new qc(d,null,b,!0);b.o=c;g.push(b);n.push(c)}}),n.sort(b),ue(g),ue(n),g.length){a=0;b=c;for(c=n.length;c>a;++a)n[a].e=b= !b;for(var m,y=g[0];;){for(var u=y,D=!0;u.v;)if((u=u.n)===y)return;b=u.z;f.lineStart();do{if(u.v=u.o.v=!0,u.e){if(D)for(a=0,c=b.length;c>a;++a)f.point((m=b[a])[0],m[1]);else d(u.x,u.n.x,1,f);u=u.n}else{if(D)for(b=u.p.z,a=b.length-1;0<=a;--a)f.point((m=b[a])[0],m[1]);else d(u.x,u.p.x,-1,f);u=u.p}u=u.o;b=u.z;D=!D}while(!u.v);f.lineEnd()}}}function ue(a){if(b=a.length){for(var b,c,d=0,f=a[0];++d<b;)f.n=c=a[d],c.p=f,f=c;f.n=c=a[0];c.p=f}}function qc(a,b,c,d){this.x=a;this.z=b;this.o=c;this.e=d;this.v= !1;this.n=this.p=null}function ve(a,b,c,d){return function(f,g){function n(b,c){var d=f(b,c);a(b=d[0],c=d[1])&&g.point(b,c)}function m(a,b){var c=f(a,b);p.point(c[0],c[1])}function y(){H.point=m;p.lineStart()}function u(){H.point=n;p.lineEnd()}function D(a,b){w.push([a,b]);var c=f(a,b);k.point(c[0],c[1])}function Ha(){k.lineStart();w=[]}function G(){D(w[0][0],w[0][1]);k.lineEnd();var a;a=k.clean();var b=P.buffer(),c=b.length;if(w.pop(),e.push(w),w=null,c){if(1&a){a=b[0];var d,c=a.length-1,b=-1;for(g.lineStart();++b< c;)g.point((d=a[b])[0],d[1]);return g.lineEnd(),void 0}1<c&&2&a&&b.push(b.pop().concat(b.shift()));h.push(b.filter(Cg))}}var h,e,w,p=b(g),Dg=f.invert(d[0],d[1]),H={point:n,lineStart:y,lineEnd:u,polygonStart:function(){H.point=D;H.lineStart=Ha;H.lineEnd=G;h=[];e=[];g.polygonStart()},polygonEnd:function(){H.point=n;H.lineStart=y;H.lineEnd=u;h=r.merge(h);var a,b=Dg;a=e;var d=b[0],f=b[1],m=[Math.sin(d),-Math.cos(d),0],D=0,G=0;rb.reset();for(var Ha=0,w=a.length;w>Ha;++Ha){var P=a[Ha],p=P.length;if(p)for(var bb= P[0],k=bb[0],b=bb[1]/2+T/4,Tb=Math.sin(b),C=Math.cos(b),t=1;;){t===p&&(t=0);var b=P[t],s=b[0],x=b[1]/2+T/4,q=Math.sin(x),x=Math.cos(x),B=s-k,rc=U(B)>T,Tb=Tb*q;if(rb.add(Math.atan2(Tb*Math.sin(B),C*x+Tb*Math.cos(B))),D+=rc?B+(0<=B?Aa:-Aa):B,rc^k>=d^s>=d)bb=Cb(sb(bb),sb(b)),nc(bb),k=Cb(m,bb),nc(k),k=(rc^0<=B?-1:1)*l(k[2]),(f>k||f===k&&(bb[0]||bb[1]))&&(G+=rc^0<=B?1:-1);if(!t++)break;k=s;Tb=q;C=x;bb=b}}a=(-L>D||L>D&&0>rb)^1&G;h.length?te(h,Eg,a,c,g):a&&(g.lineStart(),c(null,null,1,g),g.lineEnd());g.polygonEnd(); h=e=null},sphere:function(){g.polygonStart();g.lineStart();c(null,null,1,g);g.lineEnd();g.polygonEnd()}},P=we(),k=b(P);return H}}function Cg(a){return 1<a.length}function we(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,d){a.push([b,d])},lineEnd:I,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){1<b.length&&b.push(b.pop().concat(b.shift()))}}}function Eg(a,b){return(0>(a=a.x)[0]?a[1]-ya-L:ya-a[1])-(0>(b=b.x)[0]?b[1]-ya-L:ya-b[1])}function Fg(a){function b(a, b){return Math.cos(a)*Math.cos(b)>f}function c(a,b,c){var d=sb(a),g=sb(b),m=[1,0,0],g=Cb(d,g),n=lc(g,g),d=g[0],l=n-d*d;if(!l)return!c&&a;n=f*n/l;l=-f*d/l;d=Cb(m,g);m=mc(m,n);g=mc(g,l);nd(m,g);g=lc(m,d);n=lc(d,d);l=g*g-n*(lc(m,m)-1);if(!(0>l)){var r=Math.sqrt(l),l=mc(d,(-g-r)/n);if(nd(l,m),l=oc(l),!c)return l;var h;c=a[0];var e=b[0];a=a[1];b=b[1];c>e&&(h=c,c=e,e=h);var w=e-c,p=U(w-T)<L,k=p||L>w;if(!p&&a>b&&(h=a,a=b,b=h),k?p?0<a+b^l[1]<(U(l[0]-c)<L?a:b):a<=l[1]&&l[1]<=b:w>T^(c<=l[0]&&l[0]<=e))return h= mc(d,(-g+r)/n),nd(h,m),[l,oc(h)]}}function d(b,c){var d=g?a:T-a,f=0;return-d>b?f|=1:b>d&&(f|=2),-d>c?f|=4:c>d&&(f|=8),f}var f=Math.cos(a),g=0<f,n=U(f)>L,m=pd(a,6*R);return ve(b,function(a){var f,m,l,G,r;return{lineStart:function(){G=l=!1;r=1},point:function(h,e){var w,p=[h,e],H=b(h,e),P=g?H?0:d(h,e):H?d(h+(0>h?T:-T),e):0;if(!f&&(G=l=H)&&a.lineStart(),H!==l&&(w=c(f,p),(pc(f,w)||pc(p,w))&&(p[0]+=L,p[1]+=L,H=b(p[0],p[1]))),H!==l)r=0,H?(a.lineStart(),w=c(p,f),a.point(w[0],w[1])):(w=c(f,p),a.point(w[0], w[1]),a.lineEnd()),f=w;else if(n&&f&&g^H){var k;P&m||!(k=c(p,f,!0))||(r=0,g?(a.lineStart(),a.point(k[0][0],k[0][1]),a.point(k[1][0],k[1][1]),a.lineEnd()):(a.point(k[1][0],k[1][1]),a.lineEnd(),a.lineStart(),a.point(k[0][0],k[0][1])))}!H||f&&pc(f,p)||a.point(p[0],p[1]);f=p;l=H;m=P},lineEnd:function(){l&&a.lineEnd();f=null},clean:function(){return r|(G&&l)<<1}}},m,g?[0,-a]:[-T,a-T])}function xe(a,b,c,d){return function(f){var g,n=f.a,m=f.b,y=n.x,n=n.y,u=0,D=1,l=m.x-y,m=m.y-n;if(g=a-y,l||!(0<g)){if(g/= l,0>l){if(u>g)return;D>g&&(D=g)}else if(0<l){if(g>D)return;g>u&&(u=g)}if(g=c-y,l||!(0>g)){if(g/=l,0>l){if(g>D)return;g>u&&(u=g)}else if(0<l){if(u>g)return;D>g&&(D=g)}if(g=b-n,m||!(0<g)){if(g/=m,0>m){if(u>g)return;D>g&&(D=g)}else if(0<m){if(g>D)return;g>u&&(u=g)}if(g=d-n,m||!(0>g)){if(g/=m,0>m){if(g>D)return;g>u&&(u=g)}else if(0<m){if(u>g)return;D>g&&(D=g)}return 0<u&&(f.a={x:y+u*l,y:n+u*m}),1>D&&(f.b={x:y+D*l,y:n+D*m}),f}}}}}}function ye(a,b,c,d){function f(d,g){return U(d[0]-a)<L?0<g?0:3:U(d[0]- c)<L?0<g?2:1:U(d[1]-b)<L?0<g?1:0:0<g?3:2}function g(a,b){return n(a.x,b.x)}function n(a,b){var c=f(a,1),d=f(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(m){function y(g,m,y,u){var D=0,l=0;if(null==g||(D=f(g,y))!==(l=f(m,y))||0>n(g,m)^0<y){do u.point(0===D||3===D?a:c,1<D?d:b);while((D=(D+y+4)%4)!==l)}else u.point(m[0],m[1])}function u(g,f){g>=a&&c>=g&&f>=b&&d>=f&&m.point(g,f)}function D(g,f){g=Math.max(-sc,Math.min(sc,g));f=Math.max(-sc,Math.min(sc, f));var n=g>=a&&c>=g&&f>=b&&d>=f;if(G&&h.push([g,f]),C)e=g,w=f,p=n,C=!1,n&&(m.lineStart(),m.point(g,f));else if(n&&P)m.point(g,f);else{var y={a:{x:k,y:H},b:{x:g,y:f}};q(y)?(P||(m.lineStart(),m.point(y.a.x,y.a.y)),m.point(y.b.x,y.b.y),n||m.lineEnd(),t=!1):n&&(m.lineStart(),m.point(g,f),t=!1)}k=g;H=f;P=n}var l,G,h,e,w,p,k,H,P,C,t,s=m,x=we(),q=xe(a,b,c,d),B={point:u,lineStart:function(){B.point=D;G&&G.push(h=[]);C=!0;P=!1;k=H=0/0},lineEnd:function(){l&&(D(e,w),p&&P&&x.rejoin(),l.push(x.buffer()));B.point= u;P&&m.lineEnd()},polygonStart:function(){m=x;l=[];G=[];t=!0},polygonEnd:function(){m=s;l=r.merge(l);var b;b=[a,d];for(var c=0,f=G.length,n=b[1],u=0;f>u;++u)for(var D,e=1,w=G[u],H=w.length,p=w[0];H>e;++e)D=w[e],p[1]<=n?D[1]>n&&0<(D[0]-p[0])*(b[1]-p[1])-(b[0]-p[0])*(D[1]-p[1])&&++c:D[1]<=n&&0>(D[0]-p[0])*(b[1]-p[1])-(b[0]-p[0])*(D[1]-p[1])&&--c,p=D;b=0!==c;c=t&&b;f=l.length;(c||f)&&(m.polygonStart(),c&&(m.lineStart(),y(null,null,1,m),m.lineEnd()),f&&te(l,g,b,y,m),m.polygonEnd());l=G=h=null}};return B}} function ze(a,b){function c(c,f){return c=a(c,f),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,f){return c=b.invert(c,f),c&&a.invert(c[0],c[1])}),c}function qd(a){var b=0,c=T/3,d=rd(a);a=d(b,c);return a.parallels=function(a){return arguments.length?d(b=a[0]*T/180,c=a[1]*T/180):[b/T*180,c/T*180]},a}function Ae(a,b){function c(a,b){var c=Math.sqrt(g-2*f*Math.sin(b))/f;return[c*Math.sin(a*=f),n-c*Math.cos(a)]}var d=Math.sin(a),f=(d+Math.sin(b))/2,g=1+d*(2*f-d),n=Math.sqrt(g)/f;return c.invert= function(a,b){var c=n-b;return[Math.atan2(a,c)/f,l((g-(a*a+c*c)*f*f)/(2*f))]},c}function Gg(){function a(a,b){tc+=f*a-d*b;d=a;f=b}var b,c,d,f;kb.point=function(g,n){kb.point=a;b=d=g;c=f=n};kb.lineEnd=function(){a(b,c)}}function Hg(){function a(a,b){n.push("M",a,",",b,g)}function b(a,b){n.push("M",a,",",b);m.point=c}function c(a,b){n.push("L",a,",",b)}function d(){m.point=a}function f(){n.push("Z")}var g=Be(4.5),n=[],m={point:a,lineStart:function(){m.point=b},lineEnd:d,polygonStart:function(){m.lineEnd= f},polygonEnd:function(){m.lineEnd=d;m.point=a},pointRadius:function(a){return g=Be(a),m},result:function(){if(n.length){var a=n.join("");return n=[],a}}};return m}function Be(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function tb(a,b){$a+=a;ab+=b;++Va}function Ce(){function a(a,f){var g=a-b,n=f-c,g=Math.sqrt(g*g+n*n);Ka+=g*(b+a)/2;La+=g*(c+f)/2;za+=g;tb(b=a,c=f)}var b,c;Ra.point=function(d,f){Ra.point=a;tb(b=d,c=f)}}function De(){Ra.point=tb}function Ig(){function a(a, b){var c=a-d,y=b-f,c=Math.sqrt(c*c+y*y);Ka+=c*(d+a)/2;La+=c*(f+b)/2;za+=c;c=f*a-d*b;ib+=c*(d+a);jb+=c*(f+b);Wa+=3*c;tb(d=a,f=b)}var b,c,d,f;Ra.point=function(g,n){Ra.point=a;tb(b=d=g,c=f=n)};Ra.lineEnd=function(){a(b,c)}}function Jg(a){function b(b,c){a.moveTo(b,c);a.arc(b,c,n,0,Aa)}function c(b,c){a.moveTo(b,c);m.point=d}function d(b,c){a.lineTo(b,c)}function f(){m.point=b}function g(){a.closePath()}var n=4.5,m={point:b,lineStart:function(){m.point=c},lineEnd:f,polygonStart:function(){m.lineEnd= g},polygonEnd:function(){m.lineEnd=f;m.point=b},pointRadius:function(a){return n=a,m},result:I};return m}function Ee(a){function b(a){return(m?d:c)(a)}function c(b){return Fe(b,function(c,d){c=a(c,d);b.point(c[0],c[1])})}function d(b){function c(d,g){d=a(d,g);b.point(d[0],d[1])}function d(){s=0/0;v.point=g;b.lineStart()}function g(c,d){var n=sb([c,d]),u=a(c,d);f(s,x,t,q,B,K,s=u[0],x=u[1],t=c,q=n[0],B=n[1],K=n[2],m,b);b.point(s,x)}function n(){v.point=c;b.lineEnd()}function l(){d();v.point=r;v.lineEnd= h}function r(a,b){g(e=a,b);w=s;p=x;P=q;k=B;C=K;v.point=g}function h(){f(s,x,t,q,B,K,w,p,e,P,k,C,m,b);v.lineEnd=n;n()}var e,w,p,P,k,C,t,s,x,q,B,K,v={point:c,lineStart:d,lineEnd:n,polygonStart:function(){b.polygonStart();v.lineStart=l},polygonEnd:function(){b.polygonEnd();v.lineStart=d}};return v}function f(b,c,d,m,l,r,h,e,w,p,H,P,k,C){var t=h-b,s=e-c,x=t*t+s*s;if(x>4*g&&k--){var q=m+p,B=l+H,K=r+P,v=Math.sqrt(q*q+B*B+K*K),Q=Math.asin(K/=v),z=U(U(K)-1)<L||U(d-w)<L?(d+w)/2:Math.atan2(B,q),V=a(z,Q),Q= V[0],V=V[1],A=Q-b,E=V-c,ga=s*A-t*E;(ga*ga/x>g||0.3<U((t*A+s*E)/x-0.5)||n>m*p+l*H+r*P)&&(f(b,c,d,m,l,r,Q,V,z,q/=v,B/=v,K,k,C),C.point(Q,V),f(Q,V,z,q,B,K,h,e,w,p,H,P,k,C))}}var g=0.5,n=Math.cos(30*R),m=16;return b.precision=function(a){return arguments.length?(m=0<(g=a*a)&&16,b):Math.sqrt(g)},b}function Kg(a){var b=Ee(function(b,d){return a([b*ca,d*ca])});return function(a){return Ge(b(a))}}function He(a){this.stream=a}function Fe(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()}, lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function lb(a){return rd(function(){return a})()}function rd(a){function b(a){return a=m(a[0]*R,a[1]*R),[a[0]*G+y,u-a[1]*G]}function c(a){return a=m.invert((a[0]-y)/G,(u-a[1])/G),a&&[a[0]*ca,a[1]*ca]}function d(){m=ze(n=sd(k,H,P),g);var a=g(w,p);return y=h-a[0]*G,u=e+a[1]*G,f()}function f(){return D&&(D.valid=!1,D=null),b}var g,n,m,y,u,D,l=Ee(function(a,b){return a=g(a,b),[a[0]*G+y,u-a[1]* G]}),G=150,h=480,e=250,w=0,p=0,k=0,H=0,P=0,C=Ie,t=ra,s=null,x=null;return b.stream=function(a){return D&&(D.valid=!1),D=Ge(C(n,l(t(a)))),D.valid=!0,D},b.clipAngle=function(a){return arguments.length?(C=null==a?(s=a,Ie):Fg((s=+a)*R),f()):s},b.clipExtent=function(a){return arguments.length?(x=a,t=a?ye(a[0][0],a[0][1],a[1][0],a[1][1]):ra,f()):x},b.scale=function(a){return arguments.length?(G=+a,d()):G},b.translate=function(a){return arguments.length?(h=+a[0],e=+a[1],d()):[h,e]},b.center=function(a){return arguments.length? (w=a[0]%360*R,p=a[1]%360*R,d()):[w*ca,p*ca]},b.rotate=function(a){return arguments.length?(k=a[0]%360*R,H=a[1]%360*R,P=2<a.length?a[2]%360*R:0,d()):[k*ca,H*ca,P*ca]},r.rebind(b,l,"precision"),function(){return g=a.apply(this,arguments),b.invert=g.invert&&c,d()}}function Ge(a){return Fe(a,function(b,c){a.point(b*R,c*R)})}function Ub(a,b){return[a,b]}function Je(a,b){return[a>T?a-Aa:-T>a?a+Aa:a,b]}function sd(a,b,c){return a?b||c?ze(Ke(a),Le(b,c)):Ke(a):b||c?Le(b,c):Je}function Me(a){return function(b, c){return b+=a,[b>T?b-Aa:-T>b?b+Aa:b,c]}}function Ke(a){var b=Me(a);return b.invert=Me(-a),b}function Le(a,b){function c(a,b){var c=Math.cos(b),D=Math.cos(a)*c,c=Math.sin(a)*c,h=Math.sin(b),G=h*d+D*f;return[Math.atan2(c*g-G*n,D*d-h*f),l(G*g+c*n)]}var d=Math.cos(a),f=Math.sin(a),g=Math.cos(b),n=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),D=Math.cos(a)*c,c=Math.sin(a)*c,h=Math.sin(b),G=h*g-c*n;return[Math.atan2(c*g+h*n,D*d+G*f),l(G*d-D*f)]},c}function pd(a,b){var c=Math.cos(a),d=Math.sin(a); return function(f,g,n,m){var y=n*b;null!=f?(f=Ne(c,f),g=Ne(c,g),(0<n?g>f:f>g)&&(f+=n*Aa)):(f=a+n*Aa,g=a-0.5*y);for(var u;0<n?f>g:g>f;f-=y)m.point((u=oc([c,-d*Math.cos(f),-d*Math.sin(f)]))[0],u[1])}}function Ne(a,b){var c=sb(b);c[0]-=a;nc(c);var d=xa(-c[1]);return((0>-c[2]?-d:d)+2*Math.PI-L)%(2*Math.PI)}function Oe(a,b,c){var d=r.range(a,b-L,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function Pe(a,b,c){var d=r.range(a,b-L,c).concat(b);return function(a){return d.map(function(b){return[b, a]})}}function td(a){return a.source}function ud(a){return a.target}function Lg(a,b,c,d){var f=Math.cos(b),g=Math.sin(b),n=Math.cos(d),m=Math.sin(d),y=f*Math.cos(a),u=f*Math.sin(a),D=n*Math.cos(c),l=n*Math.sin(c),G=2*Math.asin(Math.sqrt(B(d-b)+f*n*B(c-a))),h=1/Math.sin(G);c=G?function(a){var b=Math.sin(a*=G)*h,c=Math.sin(G-a)*h;a=c*y+b*D;var d=c*u+b*l,b=c*g+b*m;return[Math.atan2(d,a)*ca,Math.atan2(b,Math.sqrt(a*a+d*d))*ca]}:function(){return[a*ca,b*ca]};return c.distance=G,c}function Vb(a,b){function c(b, c){var g=Math.cos(b),n=Math.cos(c),g=a(g*n);return[g*n*Math.sin(b),g*Math.sin(c)]}return c.invert=function(a,c){var g=Math.sqrt(a*a+c*c),n=b(g),m=Math.sin(n),n=Math.cos(n);return[Math.atan2(a*m,g*n),Math.asin(g&&c*m/g)]},c}function Qe(a,b){function c(a,b){var c=U(U(b)-ya)<L?0:g/Math.pow(Math.tan(T/4+b/2),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(Math.tan(T/4+b/2)/Math.tan(T/4+a/2)),g=d*Math.pow(Math.tan(T/4+a/2),f)/f;return f? (c.invert=function(a,b){var c=g-b,d=(0<f?1:0>f?-1:0)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-ya]},c):uc}function Re(a,b){function c(a,b){var c=g-b;return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),f=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),g=d/f+a;return U(f)<L?Ub:(c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/f,g-(0<f?1:0>f?-1:0)*Math.sqrt(a*a+c*c)]},c)}function uc(a,b){return[a,Math.log(Math.tan(T/4+b/2))]}function Se(a){var b,c=lb(a),d=c.scale, f=c.translate,g=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=f.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var m=g.apply(c,arguments);if(m===c){if(b=null==a){var y=T*d(),u=f();g([[u[0]-y,u[1]-y],[u[0]+y,u[1]+y]])}}else b&&(m=null);return m},c.clipExtent(null)}function vd(a,b){var c=Math.cos(b)*Math.sin(a);return[Math.log((1+c)/(1-c))/2,Math.atan2(Math.tan(b),Math.cos(a))]} function ub(a){return a[0]}function Fb(a){return a[1]}function Mg(a,b,c,d){var f,g,n,m,y,u,D;return f=d[a],g=f[0],n=f[1],f=d[b],m=f[0],y=f[1],f=d[c],u=f[0],D=f[1],0<(D-n)*(m-g)-(y-n)*(u-g)}function wd(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Te(a,b,c,d){var f=a[0],g=c[0],n=b[0]-f,m=d[0]-g;a=a[1];c=c[1];b=b[1]-a;d=d[1]-c;g=(m*(a-c)-d*(f-g))/(d*n-m*b);return[f+g*n,a+g*b]}function Ue(a){var b=a[0];a=a[a.length-1];return!(b[0]-a[0]||b[1]-a[1])}function Ng(){vc(this);this.edge= this.site=this.circle=null}function Ve(a){var b=We.pop()||new Ng;return b.site=a,b}function xd(a){Gb(a);Hb.remove(a);We.push(a);vc(a)}function Xe(a,b){var c=a.site,d=c.x,f=c.y,g=f-b;if(!g)return d;var n=a.P;if(!n)return-1/0;var c=n.site,n=c.x,c=c.y,m=c-b;if(!m)return n;var y=n-d,u=1/g-1/m,D=y/m;return u?(-D+Math.sqrt(D*D-2*u*(y*y/(-2*m)-c+m/2+f-g/2)))/u+d:(d+n)/2}function Ye(a){this.site=a;this.edges=[]}function Ze(a,b){return b.angle-a.angle}function Og(){vc(this);this.x=this.y=this.arc=this.site= this.cy=null}function Ib(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,b=a.site,f=c.site;if(d!==f){var c=b.x,g=b.y,n=d.x-c,m=d.y-g,d=f.x-c,f=f.y-g,y=2*(n*f-m*d);if(!(y>=-yd)){var u=n*n+m*m,D=d*d+f*f,m=(f*u-m*D)/y,n=(n*D-d*u)/y,f=n+g,g=$e.pop()||new Og;g.arc=a;g.site=b;g.x=m+c;g.y=f+Math.sqrt(m*m+n*n);g.cy=f;a.circle=g;a=null;for(b=Wb._;b;)if(g.y<b.y||g.y===b.y&&g.x<=b.x){if(!b.L){a=b.P;break}b=b.L}else{if(!b.R){a=b;break}b=b.R}Wb.insert(a,g);a||(zd=g)}}}}function Gb(a){var b=a.circle;b&&(b.P||(zd=b.N), Wb.remove(b),$e.push(b),vc(b),a.circle=null)}function Pg(a,b){var c=a.b;if(c)return!0;var d,f,g=a.a,c=b[0][0],n=b[1][0],m=b[0][1],y=b[1][1],u=a.l,D=a.r,l=u.x,u=u.y,G=D.x,D=D.y;f=(l+G)/2;if(D===u){if(c>f||f>=n)return;if(l>G){if(g){if(g.y>=y)return}else g={x:f,y:m};c={x:f,y:y}}else{if(g){if(g.y<m)return}else g={x:f,y:y};c={x:f,y:m}}}else if(d=(l-G)/(D-u),f=(u+D)/2-d*f,-1>d||1<d)if(l>G){if(g){if(g.y>=y)return}else g={x:(m-f)/d,y:m};c={x:(y-f)/d,y:y}}else{if(g){if(g.y<m)return}else g={x:(y-f)/d,y:y}; c={x:(m-f)/d,y:m}}else if(D>u){if(g){if(g.x>=n)return}else g={x:c,y:d*c+f};c={x:n,y:d*n+f}}else{if(g){if(g.x<c)return}else g={x:n,y:d*n+f};c={x:c,y:d*c+f}}return a.a=g,a.b=c,!0}function af(a,b){this.l=a;this.r=b;this.a=this.b=null}function Xb(a,b,c,d){var f=new af(a,b);return Jb.push(f),c&&wc(f,a,b,c),d&&wc(f,b,a,d),vb[a.i].edges.push(new xc(f,a,b)),vb[b.i].edges.push(new xc(f,b,a)),f}function Qg(a,b,c){a=new af(a,null);return a.a=b,a.b=c,Jb.push(a),a}function wc(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a= d:(a.a=d,a.l=b,a.r=c)}function xc(a,b,c){var d=a.a,f=a.b;this.edge=a;this.site=b;this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(f.x-d.x,d.y-f.y):Math.atan2(d.x-f.x,f.y-d.y)}function Ad(){this._=null}function vc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function Yb(a,b){var c=b.R,d=b.U;d?d.L===b?d.L=c:d.R=c:a._=c;c.U=d;b.U=c;b.R=c.L;b.R&&(b.R.U=b);c.L=b}function Zb(a,b){var c=b.L,d=b.U;d?d.L===b?d.L=c:d.R=c:a._=c;c.U=d;b.U=c;b.L=c.R;b.L&&(b.L.U=b);c.R=b}function bf(a){for(;a.L;)a=a.L;return a}function Bd(a, b){var c,d,f,g=a.sort(Rg).pop();Jb=[];vb=Array(a.length);Hb=new Ad;for(Wb=new Ad;;)if(f=zd,g&&(!f||g.y<f.y||g.y===f.y&&g.x<f.x)){if(g.x!==c||g.y!==d){vb[g.i]=new Ye(g);c=g;for(var n=d=void 0,m=void 0,y=void 0,u=c.x,D=c.y,l=Hb._;l;)if(m=Xe(l,D)-u,m>L)l=l.L;else{var G=u,h;var r=l;h=D;var e=r.N;e?h=Xe(e,h):(r=r.site,h=r.y===h?r.x:1/0);if(y=G-h,!(y>L)){m>-L?(d=l.P,n=l):y>-L?(d=l,n=l.N):d=n=l;break}if(!l.R){d=l;break}l=l.R}m=Ve(c);if(Hb.insert(d,m),d||n)if(d===n)Gb(d),n=Ve(d.site),Hb.insert(m,n),m.edge= n.edge=Xb(d.site,m.site),Ib(d),Ib(n);else if(n){Gb(d);Gb(n);y=d.site;D=y.x;l=y.y;G=c.x-D;h=c.y-l;var u=n.site,r=u.x-D,e=u.y-l,w=2*(G*e-h*r),p=G*G+h*h,H=r*r+e*e,D={x:(e*p-h*H)/w+D,y:(G*H-r*p)/w+l};wc(n.edge,y,u,D);m.edge=Xb(y,c,null,D);n.edge=Xb(c,u,null,D);Ib(d);Ib(n)}else m.edge=Xb(d.site,m.site);c=g.x;d=g.y}g=a.pop()}else{if(!f)break;u=f.arc;n=u.circle;y=n.x;D=n.cy;n={x:y,y:D};G=u.P;l=u.N;m=[u];xd(u);for(u=G;u.circle&&U(y-u.circle.x)<L&&U(D-u.circle.cy)<L;)G=u.P,m.unshift(u),xd(u),u=G;m.unshift(u); Gb(u);for(G=l;G.circle&&U(y-G.circle.x)<L&&U(D-G.circle.cy)<L;)l=G.N,m.push(G),xd(G),G=l;m.push(G);Gb(G);y=void 0;D=m.length;for(y=1;D>y;++y)G=m[y],u=m[y-1],wc(G.edge,u.site,G.site,n);u=m[0];G=m[D-1];G.edge=Xb(u.site,G.site,null,n);Ib(u);Ib(G)}if(b){g=Jb;c=xe(b[0][0],b[0][1],b[1][0],b[1][1]);for(d=g.length;d--;)f=g[d],(!Pg(f,b)||!c(f)||U(f.a.x-f.b.x)<L&&U(f.a.y-f.b.y)<L)&&(f.a=f.b=null,g.splice(d,1));var P,u=b[0][0],D=b[1][0],l=b[0][1],G=b[1][1];h=vb;for(r=h.length;r--;)if(P=h[r],P&&P.prepare())for(n= P.edges,m=n.length,d=0;m>d;)y=n[d].end(),g=y.x,c=y.y,e=n[++d%m].start(),f=e.x,e=e.y,(U(g-f)>L||U(c-e)>L)&&(n.splice(d,0,new xc(Qg(P.site,y,U(g-u)<L&&G-c>L?{x:u,y:U(f-u)<L?e:G}:U(c-G)<L&&D-g>L?{x:U(e-G)<L?f:D,y:G}:U(g-D)<L&&c-l>L?{x:D,y:U(f-D)<L?e:l}:U(c-l)<L&&g-u>L?{x:U(e-l)<L?f:u,y:l}:null),P.site,null)),++m)}P={cells:vb,edges:Jb};return Hb=Wb=Jb=vb=null,P}function Rg(a,b){return b.y-a.y||b.x-a.x}function Sg(a){return a.x}function Tg(a){return a.y}function cf(){return{leaf:!0,nodes:[],point:null, x:null,y:null}}function $b(a,b,c,d,f,g){if(!a(b,c,d,f,g)){var n=0.5*(c+f),m=0.5*(d+g);b=b.nodes;b[0]&&$b(a,b[0],c,d,n,m);b[1]&&$b(a,b[1],n,d,f,m);b[2]&&$b(a,b[2],c,m,n,g);b[3]&&$b(a,b[3],n,m,f,g)}}function Cd(a,b){a=r.rgb(a);b=r.rgb(b);var c=a.r,d=a.g,f=a.b,g=b.r-c,n=b.g-d,m=b.b-f;return function(a){return"#"+Ea(Math.round(c+g*a))+Ea(Math.round(d+n*a))+Ea(Math.round(f+m*a))}}function df(a,b){var c,d={},f={};for(c in a)c in b?d[c]=wb(a[c],b[c]):f[c]=a[c];for(c in b)c in a||(f[c]=b[c]);return function(a){for(c in d)f[c]= d[c](a);return f}}function cb(a,b){return b-=a=+a,function(c){return a+b*c}}function ef(a,b){var c,d,f,g,n=0,m=[],y=[];a+="";b+="";for(d=yc.lastIndex=0;c=yc.exec(b);++d)c.index&&m.push(b.substring(n,c.index)),y.push({i:m.length,x:c[0]}),m.push(null),n=yc.lastIndex;n<b.length&&m.push(b.substring(n));d=0;for(f=y.length;(c=yc.exec(a))&&f>d;++d)if(g=y[d],g.x==c[0]){if(g.i)if(null==m[g.i+1])for(m[g.i-1]+=g.x,m.splice(g.i,1),c=d+1;f>c;++c)y[c].i--;else for(m[g.i-1]+=g.x+m[g.i+1],m.splice(g.i,2),c=d+1;f> c;++c)y[c].i-=2;else if(null==m[g.i+1])m[g.i]=g.x;else for(m[g.i]=g.x+m[g.i+1],m.splice(g.i+1,1),c=d+1;f>c;++c)y[c].i--;y.splice(d,1);f--;d--}else g.x=cb(parseFloat(c[0]),parseFloat(g.x));for(;f>d;)g=y.pop(),null==m[g.i+1]?m[g.i]=g.x:(m[g.i]=g.x+m[g.i+1],m.splice(g.i+1,1)),f--;return 1===m.length?null==m[0]?(g=y[0].x,function(a){return g(a)+""}):function(){return b}:function(a){for(d=0;f>d;++d)m[(g=y[d]).i]=g.x(a);return m.join("")}}function wb(a,b){for(var c,d=r.interpolators.length;0<=--d&&!(c= r.interpolators[d](a,b)););return c}function zc(a,b){var c,d=[],f=[],g=a.length,n=b.length,m=Math.min(a.length,b.length);for(c=0;m>c;++c)d.push(wb(a[c],b[c]));for(;g>c;++c)f[c]=a[c];for(;n>c;++c)f[c]=b[c];return function(a){for(c=0;m>c;++c)f[c]=d[c](a);return f}}function Ug(a){return function(b){return 0>=b?0:1<=b?1:a(b)}}function ff(a){return function(b){return 1-a(1-b)}}function gf(a){return function(b){return 0.5*(0.5>b?a(2*b):2-a(2-2*b))}}function Vg(a){return a*a}function Wg(a){return a*a*a} function Xg(a){if(0>=a)return 0;if(1<=a)return 1;var b=a*a,c=b*a;return 4*(0.5>a?c:3*(a-b)+c-0.75)}function Yg(a){return 1-Math.cos(a*ya)}function Zg(a){return Math.pow(2,10*(a-1))}function $g(a){return 1-Math.sqrt(1-a*a)}function ah(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+0.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375}function hf(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function jf(a){var b=[a.a,a.b],c=[a.c,a.d],d=kf(b),f=b[0]* c[0]+b[1]*c[1],g;g=-f;g=(c[0]+=g*b[0],c[1]+=g*b[1],c);g=kf(g)||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,f*=-1);this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*ca;this.translate=[a.e,a.f];this.scale=[d,g];this.skew=g?Math.atan2(f,g)*ca:0}function kf(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return b&&(a[0]/=b,a[1]/=b),b}function lf(a,b){var c,d=[],f=[],g=r.transform(a),n=r.transform(b),m=g.translate,y=n.translate,u=g.rotate,l=n.rotate,h=g.skew,G=n.skew,g=g.scale,n=n.scale;return m[0]!= y[0]||m[1]!=y[1]?(d.push("translate(",null,",",null,")"),f.push({i:1,x:cb(m[0],y[0])},{i:3,x:cb(m[1],y[1])})):y[0]||y[1]?d.push("translate("+y+")"):d.push(""),u!=l?(180<u-l?l+=360:180<l-u&&(u+=360),f.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:cb(u,l)})):l&&d.push(d.pop()+"rotate("+l+")"),h!=G?f.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:cb(h,G)}):G&&d.push(d.pop()+"skewX("+G+")"),g[0]!=n[0]||g[1]!=n[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),f.push({i:c-4,x:cb(g[0],n[0])},{i:c-2,x:cb(g[1], n[1])})):(1!=n[0]||1!=n[1])&&d.push(d.pop()+"scale("+n+")"),c=f.length,function(a){for(var b,g=-1;++g<c;)d[(b=f[g]).i]=b.x(a);return d.join("")}}function bh(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function ch(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function dh(a){var b=a.source;a=a.target;var c;var d=a;if(b===d)c=b;else{c=mf(b);for(var d=mf(d),f=c.pop(),g=d.pop(),n=null;f===g;)n=f,f=c.pop(),g=d.pop();c=n}for(d=[b];b!==c;)b=b.parent, d.push(b);for(b=d.length;a!==c;)d.splice(b,0,a),a=a.parent;return d}function mf(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function eh(a){a.fixed|=2}function fh(a){a.fixed&=-7}function gh(a){a.fixed|=4;a.px=a.x;a.py=a.y}function hh(a){a.fixed&=-5}function nf(a,b,c){var d=0,f=0;if(a.charge=0,!a.leaf)for(var g,n=a.nodes,m=n.length,y=-1;++y<m;)g=n[y],null!=g&&(nf(g,b,c),a.charge+=g.charge,d+=g.charge*g.cx,f+=g.charge*g.cy);a.point&&(a.leaf||(a.point.x+=Math.random()- 0.5,a.point.y+=Math.random()-0.5),b*=c[a.point.index],a.charge+=a.pointCharge=b,d+=b*a.point.x,f+=b*a.point.y);a.cx=d/a.charge;a.cy=f/a.charge}function ac(a,b){return r.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=ih,a}function jh(a){return a.children}function kh(a){return a.value}function lh(a,b){return b.value-a.value}function ih(a){return r.merge(a.map(function(a){return(a.children||[]).map(function(c){return{source:a,target:c}})}))}function mh(a){return a.x}function nh(a){return a.y} function oh(a,b,c){a.y0=b;a.y=c}function Dd(a){return r.range(a.length)}function Ed(a){var b=-1;a=a[0].length;for(var c=[];++b<a;)c[b]=0;return c}function ph(a){for(var b,c=1,d=0,f=a[0][1],g=a.length;g>c;++c)(b=a[c][1])>f&&(d=c,f=b);return d}function qh(a){return a.reduce(rh,0)}function rh(a,b){return a+b[1]}function sh(a,b){return of(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function of(a,b){for(var c=-1,d=+a[0],f=(a[1]-d)/b,g=[];++c<=b;)g[c]=f*c+d;return g}function th(a){return[r.min(a),r.max(a)]} function pf(a,b){return a.parent==b.parent?1:2}function Fd(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function Gd(a){var b,c=a.children;return c&&(b=c.length)?c[b-1]:a._tree.thread}function Ac(a,b){var c=a.children;if(c&&(f=c.length))for(var d,f,g=-1;++g<f;)0<b(d=Ac(c[g],b),a)&&(a=d);return a}function uh(a,b){return a.x-b.x}function vh(a,b){return b.x-a.x}function wh(a,b){return a.depth-b.depth}function db(a,b){function c(a,f){var g=a.children;if(g&&(m=g.length))for(var n,m,y=null, u=-1;++u<m;)n=g[u],c(n,y),y=n;b(a,f)}c(a,null)}function xh(a,b){return a.value-b.value}function Hd(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function qf(a,b){a._pack_next=b;b._pack_prev=a}function rf(a,b){var c=b.x-a.x,d=b.y-a.y,f=a.r+b.r;return 0.999*f*f>c*c+d*d}function sf(a){function b(a){l=Math.min(a.x-a.r,l);h=Math.max(a.x+a.r,h);G=Math.min(a.y-a.r,G);e=Math.max(a.y+a.r,e)}if((c=a.children)&&(u=c.length)){var c,d,f,g,n,m,y,u,l=1/0,h=-1/0,G=1/0,e=-1/0; if(c.forEach(yh),d=c[0],d.x=-d.r,d.y=0,b(d),1<u&&(f=c[1],f.x=f.r,f.y=0,b(f),2<u))for(g=c[2],tf(d,f,g),b(g),Hd(d,g),d._pack_prev=g,Hd(g,f),f=d._pack_next,n=3;u>n;n++){tf(d,f,g=c[n]);var r=0,w=1,p=1;for(m=f._pack_next;m!==f;m=m._pack_next,w++)if(rf(m,g)){r=1;break}if(1==r)for(y=d._pack_prev;y!==m._pack_prev&&!rf(y,g);y=y._pack_prev,p++);r?(p>w||w==p&&f.r<d.r?qf(d,f=m):qf(d=y,f),n--):(Hd(d,g),f=g,b(g))}d=(l+h)/2;f=(G+e)/2;for(n=m=0;u>n;n++)g=c[n],g.x-=d,g.y-=f,m=Math.max(m,g.r+Math.sqrt(g.x*g.x+g.y* g.y));a.r=m;c.forEach(zh)}}function yh(a){a._pack_next=a._pack_prev=a}function zh(a){delete a._pack_next;delete a._pack_prev}function uf(a,b,c,d){var f=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,f){a=-1;for(var g=f.length;++a<g;)uf(f[a],b,c,d)}}function tf(a,b,c){var d=a.r+c.r,f=b.x-a.x,g=b.y-a.y;if(d&&(f||g)){var n=b.r+c.r,m=f*f+g*g,n=n*n,d=d*d;b=0.5+(d-n)/(2*m);n=Math.sqrt(Math.max(0,2*n*(d+m)-(d-=m)*d-n*n))/(2*m);c.x=a.x+b*f+n*g;c.y=a.y+b*g-n*f}else c.x=a.x+d,c.y=a.y}function Ah(a){return 1+ r.max(a,function(a){return a.y})}function Bh(a){return a.reduce(function(a,c){return a+c.x},0)/a.length}function vf(a){var b=a.children;return b&&b.length?vf(b[0]):a}function wf(a){var b,c=a.children;return c&&(b=c.length)?wf(c[b-1]):a}function Id(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function xf(a,b){var c=a.x+b[3],d=a.y+b[0],f=a.dx-b[1]-b[3],g=a.dy-b[0]-b[2];return 0>f&&(c+=f/2,f=0),0>g&&(d+=g/2,g=0),{x:c,y:d,dx:f,dy:g}}function Kb(a){var b=a[0];a=a[a.length-1];return a>b?[b,a]:[a,b]}function Bc(a){return a.rangeExtent? a.rangeExtent():Kb(a.range())}function Ch(a,b,c,d){var f=c(a[0],a[1]),g=d(b[0],b[1]);return function(a){return g(f(a))}}function Cc(a,b){var c,d=0,f=a.length-1,g=a[d],n=a[f];return g>n&&(c=d,d=f,f=c,c=g,g=n,n=c),a[d]=b.floor(g),a[f]=b.ceil(n),a}function yf(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:Dh}function Eh(a,b,c,d){var f=[],g=[],n=0,m=Math.min(a.length,b.length)-1;for(a[m]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++n<=m;)f.push(c(a[n- 1],a[n])),g.push(d(b[n-1],b[n]));return function(b){var c=r.bisect(a,b,1,m)-1;return g[c](f[c](b))}}function zf(a,b,c,d){function f(){var f=2<Math.min(a.length,b.length)?Eh:Ch,u=d?ch:bh;return n=f(a,b,u,c),m=f(b,a,u,wb),g}function g(a){return n(a)}var n,m;return g.invert=function(a){return m(a)},g.domain=function(b){return arguments.length?(a=b.map(Number),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.rangeRound=function(a){return g.range(a).interpolate(hf)},g.clamp=function(a){return arguments.length? (d=a,f()):d},g.interpolate=function(a){return arguments.length?(c=a,f()):c},g.ticks=function(b){return r.range.apply(r,mb(a,b))},g.tickFormat=function(b,c){return Jd(a,b,c)},g.nice=function(b){return Cc(a,yf(mb(a,b)[2])),f()},g.copy=function(){return zf(a,b,c,d)},f()}function Kd(a,b){return r.rebind(a,b,"range","rangeRound","interpolate","clamp")}function mb(a,b){null==b&&(b=10);var c=Kb(a),d=c[1]-c[0],f=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),d=b/d*f;return 0.15>=d?f*=10:0.35>=d?f*=5:0.75>= d&&(f*=2),c[0]=Math.ceil(c[0]/f)*f,c[1]=Math.floor(c[1]/f)*f+0.5*f,c[2]=f,c}function Jd(a,b,c){var d=mb(a,b);return r.format(c?c.replace(Af,function(a,b,c,m,y,u,l,h,G,e){return[b,c,m,y,u,l,h,G||"."+Fh(e,d),e].join("")}):",."+Ld(d[2])+"f")}function Ld(a){return-Math.floor(Math.log(a)/Math.LN10+0.01)}function Fh(a,b){var c=Ld(b[2]);return a in Gh?Math.abs(c-Ld(Math.max(Math.abs(b[0]),Math.abs(b[1]))))+ +("e"!==a):c-2*("%"===a)}function Bf(a,b,c,d){function f(a){return(c?Math.log(0>a?0:a):-Math.log(0< a?0:-a))/Math.log(b)}function g(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function n(b){return a(f(b))}return n.invert=function(b){return g(a.invert(b))},n.domain=function(b){return arguments.length?(c=0<=b[0],a.domain((d=b.map(Number)).map(f)),n):d},n.base=function(c){return arguments.length?(b=+c,a.domain(d.map(f)),n):b},n.nice=function(){var b=Cc(d.map(f),c?Math:Hh);return a.domain(b),d=b.map(g),n},n.ticks=function(){var a=Kb(d),n=[],u=a[0],a=a[1],l=Math.floor(f(u)),h=Math.ceil(f(a)),G=b%1?2:b; if(isFinite(h-l)){if(c){for(;h>l;l++)for(var e=1;G>e;e++)n.push(g(l)*e);n.push(g(l))}else for(n.push(g(l));l++<h;)for(e=G-1;0<e;e--)n.push(g(l)*e);for(l=0;n[l]<u;l++);for(h=n.length;n[h-1]>a;h--);n=n.slice(l,h)}return n},n.tickFormat=function(a,b){if(!arguments.length)return Cf;2>arguments.length?b=Cf:"function"!=typeof b&&(b=r.format(b));var d,l=Math.max(0.1,a/n.ticks().length),h=c?(d=1E-12,Math.ceil):(d=-1E-12,Math.floor);return function(a){return a/g(h(f(a)+d))<=l?b(a):""}},n.copy=function(){return Bf(a.copy(), b,c,d)},Kd(n,a)}function Df(a,b,c){function d(b){return a(f(b))}var f=Dc(b),g=Dc(1/b);return d.invert=function(b){return g(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(f)),d):c},d.ticks=function(a){return r.range.apply(r,mb(c,a))},d.tickFormat=function(a,b){return Jd(c,a,b)},d.nice=function(a){return d.domain(Cc(c,yf(mb(c,a)[2])))},d.exponent=function(n){return arguments.length?(f=Dc(b=n),g=Dc(1/b),a.domain(c.map(f)),d):b},d.copy=function(){return Df(a.copy(), b,c)},Kd(d,a)}function Dc(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function Ef(a,b){function c(c){return g[((f.get(c)||"range"===b.t&&f.set(c,a.push(c)))-1)%g.length]}function d(b,c){return r.range(a.length).map(function(a){return b+c*a})}var f,g,n;return c.domain=function(d){if(!arguments.length)return a;a=[];f=new A;for(var g,n=-1,l=d.length;++n<l;)f.has(g=d[n])||f.set(g,a.push(g));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(g=a,n=0,b={t:"range", a:arguments},c):g},c.rangePoints=function(f,y){2>arguments.length&&(y=0);var u=f[0],l=f[1],h=(l-u)/(Math.max(1,a.length-1)+y);return g=d(2>a.length?(u+l)/2:u+h*y/2,h),n=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(f,y,u){2>arguments.length&&(y=0);3>arguments.length&&(u=y);var l=f[1]<f[0],h=f[l-0],e=(f[1-l]-h)/(a.length-y+2*u);return g=d(h+e*u,e),l&&g.reverse(),n=e*(1-y),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(f,y,u){2>arguments.length&&(y=0);3>arguments.length&& (u=y);var l=f[1]<f[0],h=f[l-0],e=f[1-l],r=Math.floor((e-h)/(a.length-y+2*u));return g=d(h+Math.round((e-h-(a.length-y)*r)/2),r),l&&g.reverse(),n=Math.round(r*(1-y)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return n},c.rangeExtent=function(){return Kb(b.a[0])},c.copy=function(){return Ef(a,b)},c.domain(a)}function Ff(a,b){function c(){var c=0,n=b.length;for(f=[];++c<n;)f[c-1]=r.quantile(a,c/n);return d}function d(a){return isNaN(a=+a)?void 0:b[r.bisect(f,a)]}var f;return d.domain= function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(r.ascending),c()):a},d.range=function(a){return arguments.length?(b=a,c()):b},d.quantiles=function(){return f},d.invertExtent=function(c){return c=b.indexOf(c),0>c?[0/0,0/0]:[0<c?f[c-1]:a[0],c<f.length?f[c]:a[a.length-1]]},d.copy=function(){return Ff(a,b)},c()}function Gf(a,b,c){function d(b){return c[Math.max(0,Math.min(n,Math.floor(g*(b-a))))]}function f(){return g=c.length/(b-a),n=c.length-1,d}var g,n;return d.domain= function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],f()):[a,b]},d.range=function(a){return arguments.length?(c=a,f()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?0/0:b/g+a,[b,b+1/g]},d.copy=function(){return Gf(a,b,c)},f()}function Hf(a,b){function c(c){return c>=c?b[r.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy= function(){return Hf(a,b)},c}function If(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return r.range.apply(r,mb(a,b))},b.tickFormat=function(b,d){return Jd(a,b,d)},b.copy=function(){return If(a)},b}function Ih(a){return a.innerRadius}function Jh(a){return a.outerRadius}function Jf(a){return a.startAngle}function Kf(a){return a.endAngle}function Lf(a){function b(b){function n(){h.push("M",g(a(e),m))}for(var l, h=[],e=[],r=-1,w=b.length,p=V(c),k=V(d);++r<w;)f.call(this,l=b[r],r)?e.push([+p.call(this,l,r),+k.call(this,l,r)]):e.length&&(n(),e=[]);return e.length&&n(),h.length?h.join(""):null}var c=ub,d=Fb,f=Eb,g=Ga,n=g.key,m=0.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(f=a,b):f},b.interpolate=function(a){return arguments.length?(n="function"==typeof a?g=a:(g=Md.get(a)||Ga).key,b):n},b.tension= function(a){return arguments.length?(m=a,b):m},b}function Ga(a){return a.join("L")}function Nd(a){for(var b=0,c=a.length,d=a[0],f=[d[0],",",d[1]];++b<c;)f.push("V",(d=a[b])[1],"H",d[0]);return f.join("")}function Od(a){for(var b=0,c=a.length,d=a[0],f=[d[0],",",d[1]];++b<c;)f.push("H",(d=a[b])[0],"V",d[1]);return f.join("")}function Ec(a,b){if(1>b.length||a.length!=b.length&&a.length!=b.length+2)return Ga(a);var c=a.length!=b.length,d="",f=a[0],g=a[1],n=b[0],m=n,y=1;if(c&&(d+="Q"+(g[0]-2*n[0]/3)+","+ (g[1]-2*n[1]/3)+","+g[0]+","+g[1],f=a[1],y=2),1<b.length)for(m=b[1],g=a[y],y++,d+="C"+(f[0]+n[0])+","+(f[1]+n[1])+","+(g[0]-m[0])+","+(g[1]-m[1])+","+g[0]+","+g[1],f=2;f<b.length;f++,y++)g=a[y],m=b[f],d+="S"+(g[0]-m[0])+","+(g[1]-m[1])+","+g[0]+","+g[1];c&&(c=a[y],d+="Q"+(g[0]+2*m[0]/3)+","+(g[1]+2*m[1]/3)+","+c[0]+","+c[1]);return d}function Pd(a,b){for(var c,d=[],f=(1-b)/2,g=a[0],n=a[1],m=1,y=a.length;++m<y;)c=g,g=n,n=a[m],d.push([f*(n[0]-c[0]),f*(n[1]-c[1])]);return d}function Mf(a){if(3>a.length)return Ga(a); var b=1,c=a.length,d=a[0],f=d[0],g=d[1],n=[f,f,f,(d=a[1])[0]],m=[g,g,g,d[1]],f=[f,",",g,"L",Ma(nb,n),",",Ma(nb,m)];for(a.push(a[c-1]);++b<=c;)d=a[b],n.shift(),n.push(d[0]),m.shift(),m.push(d[1]),Qd(f,n,m);return a.pop(),f.push("L",d),f.join("")}function Ma(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Qd(a,b,c){a.push("C",Ma(Nf,b),",",Ma(Nf,c),",",Ma(Of,b),",",Ma(Of,c),",",Ma(nb,b),",",Ma(nb,c))}function Rd(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Pf(a){for(var b,c,d,f=-1,g=a.length;++f< g;)b=a[f],c=b[0],d=b[1]+xb,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Qf(a){function b(b){function y(){p.push("M",m(a(P),h),l,u(a(H.reverse()),h),"Z")}for(var e,r,w,p=[],H=[],P=[],k=-1,C=b.length,t=V(c),s=V(f),x=c===d?function(){return r}:V(d),q=f===g?function(){return w}:V(g);++k<C;)n.call(this,e=b[k],k)?(H.push([r=+t.call(this,e,k),w=+s.call(this,e,k)]),P.push([+x.call(this,e,k),+q.call(this,e,k)])):H.length&&(y(),H=[],P=[]);return H.length&&y(),p.length?p.join(""):null}var c=ub,d= ub,f=0,g=Fb,n=Eb,m=Ga,y=m.key,u=m,l="L",h=0.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(f=g=a,b):g},b.y0=function(a){return arguments.length?(f=a,b):f},b.y1=function(a){return arguments.length?(g=a,b):g},b.defined=function(a){return arguments.length?(n=a,b):n},b.interpolate=function(a){return arguments.length?(y="function"==typeof a?m=a: (m=Md.get(a)||Ga).key,u=m.reverse||m,l=m.closed?"M":"L",b):y},b.tension=function(a){return arguments.length?(h=a,b):h},b}function Kh(a){return a.radius}function Rf(a){return[a.x,a.y]}function Lh(a){return function(){var b=a.apply(this,arguments),c=b[0],b=b[1]+xb;return[c*Math.cos(b),c*Math.sin(b)]}}function Mh(){return 64}function Nh(){return"circle"}function Sf(a){a=Math.sqrt(a/T);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}function bc(a,b){return cc(a,ka),a.id=b,a}function Sd(a, b,c,d){var f=a.id;return ha(a,"function"==typeof c?function(a,n,m){a.__transition__[f].tween.set(b,d(c.call(a,a.__data__,n,m)))}:(c=d(c),function(a){a.__transition__[f].tween.set(b,c)}))}function Oh(a){return null==a&&(a=""),function(){this.textContent=a}}function Fc(a,b,c,d){var f=a.__transition__||(a.__transition__={active:0,count:0}),g=f[c];if(!g){var n=d.time,g=f[c]={tween:new A,time:n,ease:d.ease,delay:d.delay,duration:d.duration};++f.count;r.timer(function(d){function y(d){return f.active>c? l():(f.active=c,g.event&&g.event.start.call(a,h,b),g.tween.forEach(function(c,d){(d=d.call(a,h,b))&&C.push(d)}),r.timer(function(){return k.c=u(d||1)?Eb:u,1},0,n),void 0)}function u(d){if(f.active!==c)return l();d/=p;for(var m=e(d),n=C.length;0<n;)C[--n].call(a,m);return 1<=d?(g.event&&g.event.end.call(a,h,b),l()):void 0}function l(){return--f.count?delete f[c]:delete a.__transition__,1}var h=a.__data__,e=g.ease,w=g.delay,p=g.duration,k=Za,C=[];return k.t=w+n,d>=w?y(d-w):(k.c=y,void 0)},0,n)}}function Tf(a, b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function Uf(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function eb(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function yb(a,b,c){function d(b){var c=a(b),d=g(c,1);return d-b>b-c?c:d}function f(c){return b(c=a(new sa(c-1)),1),c}function g(a,c){return b(a=new sa(+a),c),a}function n(a,d,g){a=f(a);var m=[];if(1<g)for(;d>a;)c(a)%g||m.push(new Date(+a)),b(a,1);else for(;d>a;)m.push(new Date(+a)), b(a,1);return m}a.floor=a;a.round=d;a.ceil=f;a.offset=g;a.range=n;var m=a.utc=Gc(a);return m.floor=m,m.round=Gc(d),m.ceil=Gc(f),m.offset=Gc(g),m.range=function(a,b,c){try{sa=eb;var d=new eb;return d._=a,n(d,b,c)}finally{sa=Date}},a}function Gc(a){return function(b,c){try{sa=eb;var d=new eb;return d._=b,a(d,c)._}finally{sa=Date}}}function va(a){function b(b){for(var f,g,n,m=[],y=-1,l=0;++y<c;)37===a.charCodeAt(y)&&(m.push(a.substring(l,y)),null!=(g=Vf[f=a.charAt(++y)])&&(f=a.charAt(++y)),(n=Hc[f])&& (f=n(b,null==g?"e"===f?" ":"0":g)),m.push(f),l=y+1);return m.push(a.substring(l,y)),m.join("")}var c=a.length;return b.parse=function(b){var c={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(Ic(c,a,b,0)!=b.length)return null;"p"in c&&(c.H=c.H%12+12*c.p);b=null!=c.Z&&sa!==eb;var g=new (b?eb:sa);return"j"in c?g.setFullYear(c.y,0,c.j):"w"in c&&("W"in c||"U"in c)?(g.setFullYear(c.y,0,1),g.setFullYear(c.y,0,"W"in c?(c.w+6)%7+7*c.W-(g.getDay()+5)%7:c.w+7*c.U-(g.getDay()+6)%7)):g.setFullYear(c.y,c.m,c.d),g.setHours(c.H+ Math.floor(c.Z/100),c.M+c.Z%100,c.S,c.L),b?g._:g},b.toString=function(){return a},b}function Ic(a,b,c,d){for(var f,g,n,m=0,y=b.length,l=c.length;y>m;){if(d>=l)return-1;if(f=b.charCodeAt(m++),37===f){if(n=b.charAt(m++),g=Ph[n in Vf?b.charAt(m++):n],!g||0>(d=g(a,c,d)))return-1}else if(f!=c.charCodeAt(d++))return-1}return d}function Jc(a){return RegExp("^(?:"+a.map(r.requote).join("|")+")","i")}function Kc(a){for(var b=new A,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function wa(a,b, c){var d=0>a?"-":"";a=(d?-a:a)+"";var f=a.length;return d+(c>f?Array(c-f+1).join(b)+a:a)}function Wf(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+2)))?(a.d=+b[0],c+b[0].length):-1}function Xf(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+2)))?(a.H=+b[0],c+b[0].length):-1}function Xa(a){function b(a){try{sa=eb;var b=new sa;return b._=a,c(b)}finally{sa=Date}}var c=va(a);return b.parse=function(a){try{sa=eb;var b=c.parse(a);return b&&b._}finally{sa=Date}},b.toString=c.toString,b}function Td(a){return a.toISOString()} function Ud(a,b,c){function d(b){return a(b)}function f(a,c){var d=(a[1]-a[0])/c,f=r.bisect(Lc,d);return f==Lc.length?[b.year,mb(a.map(function(a){return a/31536E6}),c)[2]]:f?b[d/Lc[f-1]<Lc[f]/d?f-1:f]:[Qh,mb(a,c)[2]]}return d.invert=function(b){return zb(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(zb)},d.nice=function(a,b){function c(d){return!isNaN(d)&&!a.range(d,zb(+d+1),b).length}var l=d.domain(),u=Kb(l),u=null==a?f(u,10):"number"==typeof a&&f(u,a); return u&&(a=u[0],b=u[1]),d.domain(Cc(l,1<b?{floor:function(b){for(;c(b=a.floor(b));)b=zb(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=zb(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Kb(d.domain()),l=null==a?f(c,10):"number"==typeof a?f(c,a):!a.range&&[{range:a},b];return l&&(a=l[0],b=l[1]),a.range(c[0],zb(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Ud(a.copy(),b,c)},Kd(d,a)}function zb(a){return new Date(a)}function Yf(a){return function(b){for(var c= a.length-1,d=a[c];!d[1](b);)d=a[--c];return d[0](b)}}function Rh(a){return JSON.parse(a.responseText)}function Sh(a){var b=Sa.createRange();return b.selectNode(Sa.body),b.createContextualFragment(a.responseText)}var r={version:"3.3.10"};Date.now||(Date.now=function(){return+new Date});var Zf=[].slice,gb=function(a){return Zf.call(a)},Sa=document,hb=Sa.documentElement,qa=window;try{gb(hb.childNodes)[0].nodeType}catch(zi){gb=function(a){for(var b=a.length,c=Array(b);b--;)c[b]=a[b];return c}}try{Sa.createElement("div").style.setProperty("opacity", 0,"")}catch(Ai){var Mc=qa.Element.prototype,Th=Mc.setAttribute,Uh=Mc.setAttributeNS,$f=qa.CSSStyleDeclaration.prototype,Vh=$f.setProperty;Mc.setAttribute=function(a,b){Th.call(this,a,b+"")};Mc.setAttributeNS=function(a,b,c){Uh.call(this,a,b,c+"")};$f.setProperty=function(a,b,c){Vh.call(this,a,b+"",c)}}r.ascending=function(a,b){return b>a?-1:a>b?1:a>=b?0:0/0};r.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0};r.min=function(a,b){var c,d,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&& !(null!=(c=a[f])&&c>=c);)c=void 0;for(;++f<g;)null!=(d=a[f])&&c>d&&(c=d)}else{for(;++f<g&&!(null!=(c=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&c>d&&(c=d)}return c};r.max=function(a,b){var c,d,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=a[f])&&c>=c);)c=void 0;for(;++f<g;)null!=(d=a[f])&&d>c&&(c=d)}else{for(;++f<g&&!(null!=(c=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&d>c&&(c=d)}return c};r.extent=function(a,b){var c, d,f,g=-1,n=a.length;if(1===arguments.length){for(;++g<n&&!(null!=(c=f=a[g])&&c>=c);)c=f=void 0;for(;++g<n;)null!=(d=a[g])&&(c>d&&(c=d),d>f&&(f=d))}else{for(;++g<n&&!(null!=(c=f=b.call(a,a[g],g))&&c>=c);)c=void 0;for(;++g<n;)null!=(d=b.call(a,a[g],g))&&(c>d&&(c=d),d>f&&(f=d))}return[c,f]};r.sum=function(a,b){var c,d=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)isNaN(c=+a[g])||(d+=c);else for(;++g<f;)isNaN(c=+b.call(a,a[g],g))||(d+=c);return d};r.mean=function(a,b){var c,d=a.length,f=0,g=-1, n=0;if(1===arguments.length)for(;++g<d;)k(c=a[g])&&(f+=(c-f)/++n);else for(;++g<d;)k(c=b.call(a,a[g],g))&&(f+=(c-f)/++n);return n?f:void 0};r.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),f=+a[d-1];return(c-=d)?f+c*(a[d]-f):f};r.median=function(a,b){return 1<arguments.length&&(a=a.map(b)),a=a.filter(k),a.length?r.quantile(a.sort(r.ascending),0.5):void 0};r.bisector=function(a){return{left:function(b,c,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&(f=b.length);f>d;){var g= d+f>>>1;a.call(b,b[g],g)<c?d=g+1:f=g}return d},right:function(b,c,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&(f=b.length);f>d;){var g=d+f>>>1;c<a.call(b,b[g],g)?f=g:d=g+1}return d}}};var ag=r.bisector(function(a){return a});r.bisectLeft=ag.left;r.bisect=r.bisectRight=ag.right;r.shuffle=function(a){for(var b,c,d=a.length;d;)c=0|Math.random()*d--,b=a[d],a[d]=a[c],a[c]=b;return a};r.permute=function(a,b){for(var c=b.length,d=Array(c);c--;)d[c]=a[b[c]];return d};r.pairs=function(a){for(var b= 0,c=a.length-1,d=a[0],f=Array(0>c?0:c);c>b;)f[b]=[d,d=a[++b]];return f};r.zip=function(){if(!(d=arguments.length))return[];for(var a=-1,b=r.min(arguments,q),c=Array(b);++a<b;)for(var d,f=-1,g=c[a]=Array(d);++f<d;)g[f]=arguments[f][a];return c};r.transpose=function(a){return r.zip.apply(r,a)};r.keys=function(a){var b=[],c;for(c in a)b.push(c);return b};r.values=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};r.entries=function(a){var b=[],c;for(c in a)b.push({key:c,value:a[c]});return b}; r.merge=function(a){var b,c,d,f=a.length;b=-1;for(var g=0;++b<f;)g+=a[b].length;for(c=Array(g);0<=--f;)for(d=a[f],b=d.length;0<=--b;)c[--g]=d[b];return c};var U=Math.abs;r.range=function(a,b,c){if(3>arguments.length&&(c=1,2>arguments.length&&(b=a,a=0)),1/0===(b-a)/c)throw Error("infinite range");var d,f=[],g;d=U(c);for(g=1;d*g%1;)g*=10;var n=-1;if(a*=g,b*=g,c*=g,0>c)for(;(d=a+c*++n)>b;)f.push(d/g);else for(;(d=a+c*++n)<b;)f.push(d/g);return f};r.map=function(a){var b=new A;if(a instanceof A)a.forEach(function(a, c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b};v(A,{has:function(a){return ob+a in this},get:function(a){return this[ob+a]},set:function(a,b){return this[ob+a]=b},remove:function(a){return a=ob+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)=== bg&&a.call(this,b.substring(1),this[b])}});var ob="\x00",bg=ob.charCodeAt(0);r.nest=function(){function a(b,n,l){if(l>=g.length)return d?d.call(f,n):c?n.sort(c):n;for(var h,e,r,w,p=-1,k=n.length,C=g[l++],t=new A;++p<k;)(w=t.get(h=C(e=n[p])))?w.push(e):t.set(h,[e]);return b?(e=b(),r=function(c,d){e.set(c,a(b,d,l))}):(e={},r=function(c,d){e[c]=a(b,d,l)}),t.forEach(r),e}function b(a,c){if(c>=g.length)return a;var d=[],f=n[c++];return a.forEach(function(a,g){d.push({key:a,values:b(g,c)})}),f?d.sort(function(a, b){return f(a.key,b.key)}):d}var c,d,f={},g=[],n=[];return f.map=function(b,c){return a(c,b,0)},f.entries=function(c){return b(a(r.map,c,0),0)},f.key=function(a){return g.push(a),f},f.sortKeys=function(a){return n[g.length-1]=a,f},f.sortValues=function(a){return c=a,f},f.rollup=function(a){return d=a,f},f};r.set=function(a){var b=new F;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b};v(F,{has:function(a){return ob+a in this},add:function(a){return this[ob+a]=!0,a},remove:function(a){return a= ob+a,a in this&&delete this[a]},values:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===bg&&a.call(this,b.substring(1))}});r.behavior={};r.rebind=function(a,b){for(var c,d=1,f=arguments.length;++d<f;)a[c=arguments[d]]=J(a,b,b[c]);return a};var ge="webkit ms moz Moz o O".split(" ");r.dispatch=function(){for(var a=new O,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=S(a);return a};O.prototype.on=function(a,b){var c=a.indexOf("."), d="";if(0<=c&&(d=a.substring(c+1),a=a.substring(0,c)),a)return 2>arguments.length?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}};r.event=null;r.requote=function(a){return a.replace(Wh,"\\$&")};var Wh=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,cc={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},dd=function(a,b){return b.querySelector(a)},ed=function(a,b){return b.querySelectorAll(a)},Xh= hb[E(hb,"matchesSelector")],he=function(a,b){return Xh.call(a,b)};"function"==typeof Sizzle&&(dd=function(a,b){return Sizzle(a,b)[0]||null},ed=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))},he=Sizzle.matchesSelector);r.selection=function(){return cg};var Y=r.selection.prototype=[];Y.select=function(a){var b,c,d,f,g=[];a=e(a);for(var n=-1,m=this.length;++n<m;){g.push(b=[]);b.parentNode=(d=this[n]).parentNode;for(var l=-1,u=d.length;++l<u;)(f=d[l])?(b.push(c=a.call(f,f.__data__,l,n)),c&&"__data__"in f&&(c.__data__=f.__data__)):b.push(null)}return h(g)};Y.selectAll=function(a){var b,c,d=[];a=t(a);for(var f=-1,g=this.length;++f<g;)for(var n=this[f],m=-1,l=n.length;++m<l;)(c=n[m])&&(d.push(b=gb(a.call(c,c.__data__,m,f))),b.parentNode=c);return h(d)};var Vd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};r.ns={prefix:Vd,qualify:function(a){var b=a.indexOf(":"), c=a;return 0<=b&&(c=a.substring(0,b),a=a.substring(b+1)),Vd.hasOwnProperty(c)?{space:Vd[c],local:a}:a}};Y.attr=function(a,b){if(2>arguments.length){if("string"==typeof a){var c=this.node();return a=r.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(K(b,a[b]));return this}return this.each(K(a,b))};Y.classed=function(a,b){if(2>arguments.length){if("string"==typeof a){var c=this.node(),d=(a=a.trim().split(/^|\s+/g)).length,f=-1;if(b=c.classList)for(;++f< d;){if(!b.contains(a[f]))return!1}else for(b=c.getAttribute("class");++f<d;)if(!da(a[f]).test(b))return!1;return!0}for(b in a)this.each(pa(b,a[b]));return this}return this.each(pa(a,b))};Y.style=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(c in a)this.each(p(c,a[c],b));return this}if(2>d)return qa.getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(p(a,b,c))};Y.property=function(a,b){if(2>arguments.length){if("string"==typeof a)return this.node()[a]; for(b in a)this.each(W(b,a[b]));return this}return this.each(W(a,b))};Y.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent};Y.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML= a}):this.node().innerHTML};Y.append=function(a){return a=ea(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})};Y.insert=function(a,b){return a=ea(a),b=e(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})};Y.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})};Y.data=function(a,b){function c(a,c){var d,g,f,n=a.length,h=c.length,e=Math.min(n,h),r=Array(h),w=Array(h),p=Array(n); if(b){var k=new A,C=new A,t=[];for(d=-1;++d<n;)e=b.call(g=a[d],g.__data__,d),k.has(e)?p[d]=g:k.set(e,g),t.push(e);for(d=-1;++d<h;)e=b.call(c,f=c[d],d),(g=k.get(e))?(r[d]=g,g.__data__=f):C.has(e)||(w[d]={__data__:f}),C.set(e,f),k.remove(e);for(d=-1;++d<n;)k.has(t[d])&&(p[d]=a[d])}else{for(d=-1;++d<e;)g=a[d],f=c[d],g?(g.__data__=f,r[d]=g):w[d]={__data__:f};for(;h>d;++d)w[d]={__data__:c[d]};for(;n>d;++d)p[d]=a[d]}w.update=r;w.parentNode=r.parentNode=p.parentNode=a.parentNode;m.push(w);l.push(r);u.push(p)} var d,f,g=-1,n=this.length;if(!arguments.length){for(a=Array(n=(d=this[0]).length);++g<n;)(f=d[g])&&(a[g]=f.__data__);return a}var m=ua([]),l=h([]),u=h([]);if("function"==typeof a)for(;++g<n;)c(d=this[g],a.call(d,d.parentNode.__data__,g));else for(;++g<n;)c(d=this[g],a);return l.enter=function(){return m},l.exit=function(){return u},l};Y.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")};Y.filter=function(a){var b,c,d,f=[];"function"!=typeof a&&(a=ta(a)); for(var g=0,n=this.length;n>g;g++){f.push(b=[]);b.parentNode=(c=this[g]).parentNode;for(var m=0,l=c.length;l>m;m++)(d=c[m])&&a.call(d,d.__data__,m,g)&&b.push(d)}return h(f)};Y.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],f=d.length-1,g=d[f];0<=--f;)(c=d[f])&&(g&&g!==c.nextSibling&&g.parentNode.insertBefore(c,g),g=c);return this};Y.sort=function(a){a=na.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()};Y.each=function(a){return ha(this, function(b,c,d){a.call(b,b.__data__,c,d)})};Y.call=function(a){var b=gb(arguments);return a.apply(b[0]=this,b),this};Y.empty=function(){return!this.node()};Y.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,f=c.length;f>d;d++){var g=c[d];if(g)return g}return null};Y.size=function(){var a=0;return this.each(function(){++a}),a};var Ya=[];r.selection.enter=ua;r.selection.enter.prototype=Ya;Ya.append=Y.append;Ya.empty=Y.empty;Ya.node=Y.node;Ya.call=Y.call;Ya.size=Y.size;Ya.select= function(a){for(var b,c,d,f,g,n=[],m=-1,l=this.length;++m<l;){d=(f=this[m]).update;n.push(b=[]);b.parentNode=f.parentNode;for(var u=-1,e=f.length;++u<e;)(g=f[u])?(b.push(d[u]=c=a.call(f.parentNode,g.__data__,u,m)),c.__data__=g.__data__):b.push(null)}return h(n)};Ya.insert=function(a,b){return 2>arguments.length&&(b=Ba(this)),Y.insert.call(this,a,b)};Y.transition=function(){for(var a,b,c=Ab||++dg,d=[],f=Nc||{time:Date.now(),ease:Xg,delay:0,duration:250},g=-1,n=this.length;++g<n;){d.push(a=[]);for(var m= this[g],l=-1,u=m.length;++l<u;)(b=m[l])&&Fc(b,l,c,f),a.push(b)}return bc(d,c)};Y.interrupt=function(){return this.each(ja)};r.select=function(a){a=["string"==typeof a?dd(a,Sa):a];return a.parentNode=hb,h([a])};r.selectAll=function(a){a=gb("string"==typeof a?ed(a,Sa):a);return a.parentNode=hb,h([a])};var cg=r.select(hb);Y.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(Na(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c= !1}return this.each(Na(a,b,c))};var fd=r.map({mouseenter:"mouseover",mouseleave:"mouseout"});fd.forEach(function(a){"on"+a in Sa&&fd.remove(a)});var Nb="onselectstart"in Sa?null:E(hb.style,"userSelect"),xg=0;r.mouse=function(a){return fa(a,s())};var gd=/WebKit/.test(qa.navigator.userAgent)?-1:0;r.touches=function(a,b){return 2>arguments.length&&(b=s().touches),b?gb(b).map(function(b){var d=fa(a,b);return d.identifier=b.identifier,d}):[]};r.behavior.drag=function(){function a(){this.on("mousedown.drag", f).on("touchstart.drag",g)}function b(a,b,g,f){return function(){var l,h=this.parentNode,e=c.of(this,arguments),w=r.event.target,p=a(),k=null==p?"drag":"drag-"+p,C=b(h,p),t=0,H=r.select(qa).on(g+"."+k,function(){var a=b(h,p),c=a[0]-C[0],d=a[1]-C[1];t=t|c|d;C=a;e({type:"drag",x:a[0]+l[0],y:a[1]+l[1],dx:c,dy:d})}).on(f+"."+k,function(){H.on(g+"."+k,null).on(f+"."+k,null);P(t&&r.event.target===w);e({type:"dragend"})}),P=Ca();d?(l=d.apply(this,arguments),l=[l.x-C[0],l.y-C[1]]):l=[0,0];e({type:"dragstart"})}} var c=x(a,"drag","dragstart","dragend"),d=null,f=b(I,r.mouse,"mousemove","mouseup"),g=b(function(){return r.event.changedTouches[0].identifier},function(a,b){return r.touches(a).filter(function(a){return a.identifier===b})[0]},"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},r.rebind(a,c,"on")};var T=Math.PI,Aa=2*T,ya=T/2,L=1E-6,yd=L*L,R=T/180,ca=180/T,Oc=Math.SQRT2,Wd=2;r.interpolateZoom=function(a,b){function c(a){var b=a*k;if(p){a=C(r);var c=g/(Wd*h),n,u=Oc* b+r;n=((u=Math.exp(2*u))-1)/(u+1);c*=a*n-w(r);return[d+c*m,f+c*l,g*a/C(Oc*b+r)]}return[d+a*m,f+a*l,g*Math.exp(Oc*b)]}var d=a[0],f=a[1],g=a[2],n=b[2],m=b[0]-d,l=b[1]-f,u=m*m+l*l,h=Math.sqrt(u),e=(n*n-g*g+4*u)/(2*g*Wd*h),u=(n*n-g*g-4*u)/(2*n*Wd*h),r=Math.log(Math.sqrt(e*e+1)-e),p=Math.log(Math.sqrt(u*u+1)-u)-r,k=(p||Math.log(n/g))/Oc;return c.duration=1E3*k,c};r.behavior.zoom=function(){function a(a){a.on(Q,l).on(Yh+".zoom",h).on(V,e).on("dblclick.zoom",w).on(E,u)}function b(a){return[(a[0]-B.x)/B.k, (a[1]-B.y)/B.k]}function c(a){B.k=Math.max(v[0],Math.min(v[1],a))}function d(a,b){b=[b[0]*B.k+B.x,b[1]*B.k+B.y];B.x+=a[0]-b[0];B.y+=a[1]-b[1]}function f(){H&&H.domain(s.range().map(function(a){return(a-B.x)/B.k}).map(s.invert));q&&q.domain(P.range().map(function(a){return(a-B.y)/B.k}).map(P.invert))}function g(a){a({type:"zoomstart"})}function n(a){f();a({type:"zoom",scale:B.k,translate:[B.x,B.y]})}function m(a){a({type:"zoomend"})}function l(){var a=this,c=ga.of(a,arguments),f=r.event.target,u=0, y=r.select(qa).on(V,function(){u=1;d(r.mouse(a),h);n(c)}).on(A,function(){y.on(V,qa===a?e:null).on(A,null);w(u&&r.event.target===f);m(c)}),h=b(r.mouse(a)),w=Ca();ja.call(a);g(c)}function u(){function a(){var c=r.touches(e);return h=B.k,c.forEach(function(a){a.identifier in D&&(D[a.identifier]=b(a))}),c}function f(){for(var b=r.event.changedTouches,g=0,m=b.length;m>g;++g)D[b[g].identifier]=null;m=a();g=Date.now();1===m.length?(500>g-t&&(b=m[0],m=D[b.identifier],c(2*B.k),d(b,m),z(),n(w)),t=g):1<m.length&& (b=m[0],m=m[1],g=b[0]-m[0],b=b[1]-m[1],p=g*g+b*b)}var h,e=this,w=ga.of(e,arguments),D={},p=0,k=r.event.changedTouches[0].identifier,G="touchmove.zoom-"+k,H="touchend.zoom-"+k,C=r.select(qa).on(G,function(){for(var a,b,g,f,m=r.touches(e),l=0,u=m.length;u>l;++l,f=null)if(g=m[l],f=D[g.identifier]){if(b)break;a=g;b=f}if(f){var y=(y=g[0]-a[0])*y+(y=g[1]-a[1])*y,m=p&&Math.sqrt(y/p);a=[(a[0]+g[0])/2,(a[1]+g[1])/2];b=[(b[0]+f[0])/2,(b[1]+f[1])/2];c(m*h)}t=null;d(a,b);n(w)}).on(H,function(){if(r.event.touches.length){for(var b= r.event.changedTouches,c=0,d=b.length;d>c;++c)delete D[b[c].identifier];for(var g in D)return void a()}C.on(G,null).on(H,null);P.on(Q,l).on(E,u);s();m(w)}),P=r.select(e).on(Q,null).on(E,f),s=Ca();ja.call(e);f();g(w)}function h(){var a=ga.of(this,arguments);C?clearTimeout(C):(ja.call(this),g(a));C=setTimeout(function(){C=null;m(a)},50);z();var f=k||r.mouse(this);p||(p=b(f));c(Math.pow(2,0.002*Pc())*B.k);d(f,p);n(a)}function e(){p=null}function w(){var a=ga.of(this,arguments),f=r.mouse(this),l=b(f), u=Math.log(B.k)/Math.LN2;g(a);c(Math.pow(2,r.event.shiftKey?Math.ceil(u)-1:Math.floor(u)+1));d(f,l);n(a);m(a)}var p,k,C,t,s,H,P,q,B={x:0,y:0,k:1},K=[960,500],v=eg,Q="mousedown.zoom",V="mousemove.zoom",A="mouseup.zoom",E="touchstart.zoom",ga=x(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=ga.of(this,arguments),b=B;Ab?r.select(this).transition().each("start.zoom",function(){B=this.__chart__||{x:0,y:0,k:1};g(a)}).tween("zoom:zoom",function(){var c=K[0],d=c/2,g=K[1]/ 2,f=r.interpolateZoom([(d-B.x)/B.k,(g-B.y)/B.k,c/B.k],[(d-b.x)/b.k,(g-b.y)/b.k,c/b.k]);return function(b){b=f(b);var m=c/b[2];this.__chart__=B={x:d-b[0]*m,y:g-b[1]*m,k:m};n(a)}}).each("end.zoom",function(){m(a)}):(this.__chart__=B,g(a),n(a),m(a))})},a.translate=function(b){return arguments.length?(B={x:+b[0],y:+b[1],k:B.k},f(),a):[B.x,B.y]},a.scale=function(b){return arguments.length?(B={x:B.x,y:B.y,k:+b},f(),a):B.k},a.scaleExtent=function(b){return arguments.length?(v=null==b?eg:[+b[0],+b[1]],a): v},a.center=function(b){return arguments.length?(k=b&&[+b[0],+b[1]],a):k},a.size=function(b){return arguments.length?(K=b&&[+b[0],+b[1]],a):K},a.x=function(b){return arguments.length?(H=b,s=b.copy(),B={x:0,y:0,k:1},a):H},a.y=function(b){return arguments.length?(q=b,P=b.copy(),B={x:0,y:0,k:1},a):q},r.rebind(a,ga,"on")};var Pc,eg=[0,1/0],Yh="onwheel"in Sa?(Pc=function(){return-r.event.deltaY*(r.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Sa?(Pc=function(){return r.event.wheelDelta},"mousewheel"): (Pc=function(){return-r.event.detail},"MozMousePixelScroll");ga.prototype.toString=function(){return this.rgb()+""};r.hsl=function(a,b,c){return 1===arguments.length?a instanceof pb?$(a.h,a.s,a.l):dc(""+a,fc,$):$(+a,+b,+c)};var Xd=pb.prototype=new ga;Xd.brighter=function(a){return a=Math.pow(0.7,arguments.length?a:1),$(this.h,this.s,this.l/a)};Xd.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),$(this.h,this.s,a*this.l)};Xd.rgb=function(){return Ia(this.h,this.s,this.l)};r.hcl=function(a, b,c){return 1===arguments.length?a instanceof Ta?ba(a.h,a.c,a.l):a instanceof ma?Bb(a.l,a.a,a.b):Bb((a=Qb((a=r.rgb(a)).r,a.g,a.b)).l,a.a,a.b):ba(+a,+b,+c)};var Yd=Ta.prototype=new ga;Yd.brighter=function(a){return ba(this.h,this.c,Math.min(100,this.l+Qc*(arguments.length?a:1)))};Yd.darker=function(a){return ba(this.h,this.c,Math.max(0,this.l-Qc*(arguments.length?a:1)))};Yd.rgb=function(){return Z(this.h,this.c,this.l).rgb()};r.lab=function(a,b,c){return 1===arguments.length?a instanceof ma?aa(a.l, a.a,a.b):a instanceof Ta?Z(a.l,a.c,a.h):Qb((a=r.rgb(a)).r,a.g,a.b):aa(+a,+b,+c)};var Qc=18,ie=0.95047,je=1,ke=1.08883,Zd=ma.prototype=new ga;Zd.brighter=function(a){return aa(Math.min(100,this.l+Qc*(arguments.length?a:1)),this.a,this.b)};Zd.darker=function(a){return aa(Math.max(0,this.l-Qc*(arguments.length?a:1)),this.a,this.b)};Zd.rgb=function(){return Ua(this.l,this.a,this.b)};r.rgb=function(a,b,c){return 1===arguments.length?a instanceof Pb?Ja(a.r,a.g,a.b):dc(""+a,Ja,Ia):Ja(~~a,~~b,~~c)};var Rc= Pb.prototype=new ga;Rc.brighter=function(a){a=Math.pow(0.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b;return b||c||d?(b&&30>b&&(b=30),c&&30>c&&(c=30),d&&30>d&&(d=30),Ja(Math.min(255,~~(b/a)),Math.min(255,~~(c/a)),Math.min(255,~~(d/a)))):Ja(30,30,30)};Rc.darker=function(a){return a=Math.pow(0.7,arguments.length?a:1),Ja(~~(a*this.r),~~(a*this.g),~~(a*this.b))};Rc.hsl=function(){return fc(this.r,this.g,this.b)};Rc.toString=function(){return"#"+Ea(this.r)+Ea(this.g)+Ea(this.b)};var ec=r.map({aliceblue:15792383, antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520, darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740, indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670, magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966, palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856, violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ec.forEach(function(a,b){ec.set(a,Ja(b>>16,255&b>>8,255&b))});r.functor=V;r.xhr=hd(ra);r.dsv=function(a,b){function c(a,c,g){3>arguments.length&&(g=c,c=null);var m=r.xhr(a,b,g);return m.row=function(a){return arguments.length?m.response(null==(c=a)?d:f(a)):c},m.row(c)}function d(a){return c.parse(a.responseText)}function f(a){return function(b){return c.parse(b.responseText,a)}}function g(b){return b.map(n).join(a)} function n(a){return m.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var m=RegExp('["'+a+"\n]"),l=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var g=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(g(a),c)}:g})},c.parseRows=function(a,b){function c(){if(e>=h)return m;if(g)return g=!1,f;var b=e;if(34===a.charCodeAt(b)){for(var d=b;d++<h;)if(34===a.charCodeAt(d)){if(34!== a.charCodeAt(d+1))break;++d}e=d+2;var n=a.charCodeAt(d+1);return 13===n?(g=!0,10===a.charCodeAt(d+2)&&++e):10===n&&(g=!0),a.substring(b+1,d).replace(/""/g,'"')}for(;h>e;){n=a.charCodeAt(e++);d=1;if(10===n)g=!0;else if(13===n)g=!0,10===a.charCodeAt(e)&&(++e,++d);else if(n!==l)continue;return a.substring(b,e-d)}return a.substring(b)}for(var d,g,f={},m={},n=[],h=a.length,e=0,r=0;(d=c())!==m;){for(var w=[];d!==f&&d!==m;)w.push(d),d=c();b&&!(w=b(w,r++))||n.push(w)}return n},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b); var d=new F,g=[];return b.forEach(function(a){for(var b in a)d.has(b)||g.push(d.add(b))}),[g.map(n).join(a)].concat(b.map(function(b){return g.map(function(a){return n(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(g).join("\n")},c};r.csv=r.dsv(",","text/csv");r.tsv=r.dsv("\t","text/tab-separated-values");var ic,jc,hc,gc,Za,ne=qa[E(qa,"requestAnimationFrame")]||function(a){setTimeout(a,17)};r.timer=function(a,b,c){var d=arguments.length;2>d&&(b=0);3>d&&(c=Date.now());d={c:a, t:c+b,f:!1,n:null};jc?jc.n=d:ic=d;jc=d;hc||(gc=clearTimeout(gc),hc=1,ne(jd))};r.timer.flush=function(){le();me()};var Sc=[3,3],Zh="y z a f p n \u00b5 m k M G T P E Z Y".split(" ").map(function(a,b){var c=Math.pow(10,3*U(8-b));return{scale:8<b?function(a){return a/c}:function(a){return a*c},symbol:a}});r.formatPrefix=function(a,b){var c=0;return a&&(0>a&&(a*=-1),b&&(a=r.round(a,kd(a,b))),c=1+Math.floor(1E-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((0>=c?c+1:c-1)/3)))),Zh[8+ c/3]};r.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};r.format=function(a){a=Af.exec(a);var b=a[1]||" ",c=a[2]||">",d=a[3]||"",f=a[4]||"",g=a[5],n=+a[6],m=a[7],l=a[8],u=a[9],e=1,h="",w=!1;switch(l&&(l=+l.substring(1)),(g||"0"===b&&"="===c)&&(g=b="0",c="=",m&&(n-=Math.floor((n-1)/4))),u){case "n":m=!0;u="g";break;case "%":e=100;h="%";u="f";break;case "p":e=100;h="%";u="r";break;case "b":case "o":case "x":case "X":"#"===f&&(f="0"+u.toLowerCase());case "c":case "d":w= !0;l=0;break;case "s":e=-1,u="r"}"#"===f?f="":"$"===f&&(f="$");"r"!=u||l||(u="g");null!=l&&("g"==u?l=Math.max(1,Math.min(21,l)):("e"==u||"f"==u)&&(l=Math.max(0,Math.min(20,l))));var u=$h.get(u)||zg,p=g&&m;return function(a){if(w&&a%1)return"";var k=0>a||0===a&&0>1/a?(a=-a,"-"):d;if(0>e){var C=r.formatPrefix(a,l);a=C.scale(a);h=C.symbol}else a*=e;a=u(a,l);var t=a.lastIndexOf("."),C=0>t?a:a.substring(0,t),t=0>t?"":"."+a.substring(t+1);!g&&m&&(C=$d(C));var H=f.length+C.length+t.length+(p?0:k.length), P=n>H?Array(H=n-H+1).join(b):"";return p&&(C=$d(P+C)),k+=f,a=C+t,("<"===c?k+a+P:">"===c?P+k+a:"^"===c?P.substring(0,H>>=1)+k+a+P.substring(H):k+(p?a:P+a))+h}};var Af=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,$h=r.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a, b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=r.round(a,kd(a,b))).toFixed(Math.max(0,Math.min(20,kd(a*(1+1E-15),b))))}}),$d=ra;if(Sc)var ai=Sc.length,$d=function(a){for(var b=a.length,c=[],d=0,f=Sc[0];0<b&&0<f;)c.push(a.substring(b-=f,b+f)),f=Sc[d=(d+1)%ai];return c.reverse().join(",")};r.geo={};ld.prototype={s:0,t:0,add:function(a){oe(a,this.t,Tc);oe(Tc.s,this.s,this);this.s?this.t+=Tc.t:this.s=Tc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}}; var Tc=new ld;r.geo.stream=function(a,b){a&&fg.hasOwnProperty(a.type)?fg[a.type](a,b):kc(a,b)};var fg={Feature:function(a,b){kc(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,f=c.length;++d<f;)kc(c[d].geometry,b)}},pe={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates;b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,f=c.length;++d<f;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){md(a.coordinates,b,0)},MultiLineString:function(a, b){for(var c=a.coordinates,d=-1,f=c.length;++d<f;)md(c[d],b,0)},Polygon:function(a,b){qe(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,f=c.length;++d<f;)qe(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,f=c.length;++d<f;)kc(c[d],b)}};r.geo.area=function(a){return Lb=0,r.geo.stream(a,Fa),Lb};var Lb,rb=new ld,Fa={sphere:function(){Lb+=4*T},point:I,lineStart:I,lineEnd:I,polygonStart:function(){rb.reset();Fa.lineStart=Ag},polygonEnd:function(){var a= 2*rb;Lb+=0>a?4*T+a:a;Fa.lineStart=Fa.lineEnd=Fa.point=I}};r.geo.bounds=function(){function a(a,b){P.push(s=[e=a,w=a]);h>b&&(h=b);b>p&&(p=b)}function b(b,c){var d=sb([b*R,c*R]);if(B){var g=Cb(B,d),g=Cb([g[1],-g[0],0],g);nc(g);var g=oc(g),f=b-k,n=0<f?1:-1,l=g[0]*ca*n,f=180<U(f);f^(l>n*k&&n*b>l)?(g=g[1]*ca,g>p&&(p=g)):(l=(l+360)%360-180,f^(l>n*k&&n*b>l))?(g=-g[1]*ca,h>g&&(h=g)):(h>c&&(h=c),c>p&&(p=c));f?k>b?m(e,b)>m(e,w)&&(w=b):m(b,w)>m(e,w)&&(e=b):w>=e?(e>b&&(e=b),b>w&&(w=b)):b>k?m(e,b)>m(e,w)&&(w= b):m(b,w)>m(e,w)&&(e=b)}else a(b,c);B=d;k=b}function c(){x.point=b}function d(){s[0]=e;s[1]=w;x.point=a;B=null}function f(a,c){if(B){var d=a-k;H+=180<U(d)?d+(0<d?360:-360):d}else C=a,t=c;Fa.point(a,c);b(a,c)}function g(){Fa.lineStart()}function n(){f(C,t);Fa.lineEnd();U(H)>L&&(e=-(w=180));s[0]=e;s[1]=w;B=null}function m(a,b){return 0>(b-=a)?b+360:b}function l(a,b){return a[0]-b[0]}function u(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var e,h,w,p,k,C,t,B,H,P,s,x={point:a,lineStart:c,lineEnd:d, polygonStart:function(){x.point=f;x.lineStart=g;x.lineEnd=n;H=0;Fa.polygonStart()},polygonEnd:function(){Fa.polygonEnd();x.point=a;x.lineStart=c;x.lineEnd=d;0>rb?(e=-(w=180),h=-(p=90)):H>L?p=90:-L>H&&(h=-90);s[0]=e;s[1]=w}};return function(a){p=w=-(e=h=1/0);P=[];r.geo.stream(a,x);if(a=P.length){P.sort(l);for(var b,c=1,d=P[0],g=[d];a>c;++c)b=P[c],u(b[0],d)||u(b[1],d)?(m(d[0],b[1])>m(d[0],d[1])&&(d[1]=b[1]),m(b[0],d[1])>m(d[0],d[1])&&(d[0]=b[0])):g.push(d=b);var f,n=-1/0;a=g.length-1;c=0;for(d=g[a];a>= c;d=b,++c)b=g[c],(f=m(d[1],b[0]))>n&&(n=f,e=b[0],w=d[1])}return P=s=null,1/0===e||1/0===h?[[0/0,0/0],[0/0,0/0]]:[[e,h],[w,p]]}}();r.geo.centroid=function(a){Sb=Db=$a=ab=Va=Ka=La=za=ib=jb=Wa=0;r.geo.stream(a,Qa);a=ib;var b=jb,c=Wa,d=a*a+b*b+c*c;return yd>d&&(a=Ka,b=La,c=za,L>Db&&(a=$a,b=ab,c=Va),d=a*a+b*b+c*c,yd>d)?[0/0,0/0]:[Math.atan2(b,a)*ca,l(c/Math.sqrt(d))*ca]};var Sb,Db,$a,ab,Va,Ka,La,za,ib,jb,Wa,Qa={sphere:I,point:od,lineStart:re,lineEnd:se,polygonStart:function(){Qa.lineStart=Bg},polygonEnd:function(){Qa.lineStart= re}},Ie=ve(Eb,function(a){var b,c=0/0,d=0/0,f=0/0;return{lineStart:function(){a.lineStart();b=1},point:function(g,n){var m=0<g?T:-T,l=U(g-c);if(U(l-T)<L)a.point(c,d=0<(d+n)/2?ya:-ya),a.point(f,d),a.lineEnd(),a.lineStart(),a.point(m,d),a.point(g,d),b=0;else if(f!==m&&l>=T){U(c-f)<L&&(c-=f*L);U(g-m)<L&&(g-=m*L);var l=c,e=d,h=g,r,w,p=Math.sin(l-h);d=U(p)>L?Math.atan((Math.sin(e)*(w=Math.cos(n))*Math.sin(h)-Math.sin(n)*(r=Math.cos(e))*Math.sin(l))/(r*w*p)):(e+n)/2;a.point(f,d);a.lineEnd();a.lineStart(); a.point(m,d);b=0}a.point(c=g,d=n);f=m},lineEnd:function(){a.lineEnd();c=d=0/0},clean:function(){return 2-b}}},function(a,b,c,d){null==a?(c*=ya,d.point(-T,c),d.point(0,c),d.point(T,c),d.point(T,0),d.point(T,-c),d.point(0,-c),d.point(-T,-c),d.point(-T,0),d.point(-T,c)):U(a[0]-b[0])>L?(a=a[0]<b[0]?T:-T,c=c*a/2,d.point(-a,c),d.point(0,c),d.point(a,c)):d.point(b[0],b[1])},[-T,-T/2]),sc=1E9;r.geo.clipExtent=function(){var a,b,c,d,f,g,n={stream:function(a){return f&&(f.valid=!1),f=g(a),f.valid=!0,f},extent:function(m){return arguments.length? (g=ye(a=+m[0][0],b=+m[0][1],c=+m[1][0],d=+m[1][1]),f&&(f.valid=!1,f=null),n):[[a,b],[c,d]]}};return n.extent([[0,0],[960,500]])};(r.geo.conicEqualArea=function(){return qd(Ae)}).raw=Ae;r.geo.albers=function(){return r.geo.conicEqualArea().rotate([96,0]).center([-0.6,38.7]).parallels([29.5,45.5]).scale(1070)};r.geo.albersUsa=function(){function a(a){var g=a[0];a=a[1];return b=null,c(g,a),b||(d(g,a),b)||f(g,a),b}var b,c,d,f,g=r.geo.albers(),n=r.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55, 65]),m=r.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=g.scale(),c=g.translate(),d=(a[0]-c[0])/b,b=(a[1]-c[1])/b;return(0.12<=b&&0.234>b&&-0.425<=d&&-0.214>d?n:0.166<=b&&0.234>b&&-0.214<=d&&-0.115>d?m:g).invert(a)},a.stream=function(a){var b=g.stream(a),c=n.stream(a),d=m.stream(a);return{point:function(a,g){b.point(a,g);c.point(a,g);d.point(a,g)},sphere:function(){b.sphere();c.sphere();d.sphere()},lineStart:function(){b.lineStart(); c.lineStart();d.lineStart()},lineEnd:function(){b.lineEnd();c.lineEnd();d.lineEnd()},polygonStart:function(){b.polygonStart();c.polygonStart();d.polygonStart()},polygonEnd:function(){b.polygonEnd();c.polygonEnd();d.polygonEnd()}}},a.precision=function(b){return arguments.length?(g.precision(b),n.precision(b),m.precision(b),a):g.precision()},a.scale=function(b){return arguments.length?(g.scale(b),n.scale(0.35*b),m.scale(b),a.translate(g.translate())):g.scale()},a.translate=function(b){if(!arguments.length)return g.translate(); var e=g.scale(),h=+b[0],r=+b[1];return c=g.translate(b).clipExtent([[h-0.455*e,r-0.238*e],[h+0.455*e,r+0.238*e]]).stream(l).point,d=n.translate([h-0.307*e,r+0.201*e]).clipExtent([[h-0.425*e+L,r+0.12*e+L],[h-0.214*e-L,r+0.234*e-L]]).stream(l).point,f=m.translate([h-0.205*e,r+0.212*e]).clipExtent([[h-0.214*e+L,r+0.166*e+L],[h-0.115*e-L,r+0.234*e-L]]).stream(l).point,a},a.scale(1070)};var Uc,tc,Vc,Wc,Xc,Yc,kb={point:I,lineStart:I,lineEnd:I,polygonStart:function(){tc=0;kb.lineStart=Gg},polygonEnd:function(){kb.lineStart= kb.lineEnd=kb.point=I;Uc+=U(tc/2)}},bi={point:function(a,b){Vc>a&&(Vc=a);a>Xc&&(Xc=a);Wc>b&&(Wc=b);b>Yc&&(Yc=b)},lineStart:I,lineEnd:I,polygonStart:I,polygonEnd:I},Ra={point:tb,lineStart:Ce,lineEnd:De,polygonStart:function(){Ra.lineStart=Ig},polygonEnd:function(){Ra.point=tb;Ra.lineStart=Ce;Ra.lineEnd=De}};r.geo.path=function(){function a(a){return a&&("function"==typeof n&&f.pointRadius(+n.apply(this,arguments)),g&&g.valid||(g=d(f)),r.geo.stream(a,g)),f.result()}var b,c,d,f,g,n=4.5;return a.area= function(a){return Uc=0,r.geo.stream(a,d(kb)),Uc},a.centroid=function(a){return $a=ab=Va=Ka=La=za=ib=jb=Wa=0,r.geo.stream(a,d(Ra)),Wa?[ib/Wa,jb/Wa]:za?[Ka/za,La/za]:Va?[$a/Va,ab/Va]:[0/0,0/0]},a.bounds=function(a){return Xc=Yc=-(Vc=Wc=1/0),r.geo.stream(a,d(bi)),[[Vc,Wc],[Xc,Yc]]},a.projection=function(c){return arguments.length?(d=(b=c)?c.stream||Kg(c):ra,g=null,a):b},a.context=function(b){return arguments.length?(f=null==(c=b)?new Hg:new Jg(b),"function"!=typeof n&&f.pointRadius(n),g=null,a):c}, a.pointRadius=function(b){return arguments.length?(n="function"==typeof b?b:(f.pointRadius(+b),+b),a):n},a.projection(r.geo.albersUsa()).context(null)};r.geo.transform=function(a){return{stream:function(b){b=new He(b);for(var c in a)b[c]=a[c];return b}}};He.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}}; r.geo.projection=lb;r.geo.projectionMutator=rd;(r.geo.equirectangular=function(){return lb(Ub)}).raw=Ub.invert=Ub;r.geo.rotation=function(a){function b(b){return b=a(b[0]*R,b[1]*R),b[0]*=ca,b[1]*=ca,b}return a=sd(a[0]%360*R,a[1]*R,2<a.length?a[2]*R:0),b.invert=function(b){return b=a.invert(b[0]*R,b[1]*R),b[0]*=ca,b[1]*=ca,b},b};Je.invert=Ub;r.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=sd(-a[0]*R,-a[1]*R,0).invert,f=[];return c(null,null,1,{point:function(a, c){f.push(a=b(a,c));a[0]*=ca;a[1]*=ca}}),{type:"Polygon",coordinates:[f]}}var b,c,d=[0,0],f=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=pd((b=+d)*R,f*R),a):b},a.precision=function(d){return arguments.length?(c=pd(b*R,(f=+d)*R),a):f},a.angle(90)};r.geo.distance=function(a,b){var c,d=(b[0]-a[0])*R,f=a[1]*R,g=b[1]*R,n=Math.sin(d),d=Math.cos(d),m=Math.sin(f),f=Math.cos(f),l=Math.sin(g),g=Math.cos(g);return Math.atan2(Math.sqrt((c=g*n)* c+(c=f*l-m*g*d)*c),m*l+f*g*d)};r.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return r.range(Math.ceil(g/B)*B,f,B).map(p).concat(r.range(Math.ceil(e/s)*s,l,s).map(k)).concat(r.range(Math.ceil(d/C)*C,c,C).filter(function(a){return U(a%B)>L}).map(h)).concat(r.range(Math.ceil(m/t)*t,n,t).filter(function(a){return U(a%s)>L}).map(w))}var c,d,f,g,n,m,l,e,h,w,p,k,C=10,t=C,B=90,s=360,H=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString", coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[p(g).concat(k(l).slice(1),p(f).reverse().slice(1),k(e).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(g=+b[0][0],f=+b[1][0],e=+b[0][1],l=+b[1][1],g>f&&(b=g,g=f,f=b),e>l&&(b=e,e=l,l=b),a.precision(H)):[[g,e],[f,l]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],m=+b[0][1],n=+b[1][1], d>c&&(b=d,d=c,c=b),m>n&&(b=m,m=n,n=b),a.precision(H)):[[d,m],[c,n]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(B=+b[0],s=+b[1],a):[B,s]},a.minorStep=function(b){return arguments.length?(C=+b[0],t=+b[1],a):[C,t]},a.precision=function(b){return arguments.length?(H=+b,h=Oe(m,n,90),w=Pe(d,c,H),p=Oe(e,l,90),k=Pe(g,f,H),a):H},a.majorExtent([[-180,-90+L],[180,90-L]]).minorExtent([[-180,-80-L],[180,80+L]])};r.geo.greatArc= function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||f.apply(this,arguments)]}}var b,c,d=td,f=ud;return a.distance=function(){return r.geo.distance(b||d.apply(this,arguments),c||f.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(f=b,c="function"==typeof b?null:b,a):f},a.precision=function(){return arguments.length?a:0},a};r.geo.interpolate=function(a,b){return Lg(a[0]* R,a[1]*R,b[0]*R,b[1]*R)};r.geo.length=function(a){return Zc=0,r.geo.stream(a,Mb),Zc};var Zc,Mb={sphere:I,point:I,lineStart:function(){function a(a,g){var n=Math.sin(g*=R),m=Math.cos(g),l=U((a*=R)-b),e=Math.cos(l);Zc+=Math.atan2(Math.sqrt((l=m*Math.sin(l))*l+(l=d*n-c*m*e)*l),c*n+d*m*e);b=a;c=n;d=m}var b,c,d;Mb.point=function(f,g){b=f*R;c=Math.sin(g*=R);d=Math.cos(g);Mb.point=a};Mb.lineEnd=function(){Mb.point=Mb.lineEnd=I}},lineEnd:I,polygonStart:I,polygonEnd:I},gg=Vb(function(a){return Math.sqrt(2/ (1+a))},function(a){return 2*Math.asin(a/2)});(r.geo.azimuthalEqualArea=function(){return lb(gg)}).raw=gg;var hg=Vb(function(a){return(a=Math.acos(a))&&a/Math.sin(a)},ra);(r.geo.azimuthalEquidistant=function(){return lb(hg)}).raw=hg;(r.geo.conicConformal=function(){return qd(Qe)}).raw=Qe;(r.geo.conicEquidistant=function(){return qd(Re)}).raw=Re;var ig=Vb(function(a){return 1/a},Math.atan);(r.geo.gnomonic=function(){return lb(ig)}).raw=ig;uc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-ya]}; (r.geo.mercator=function(){return Se(uc)}).raw=uc;var jg=Vb(function(){return 1},Math.asin);(r.geo.orthographic=function(){return lb(jg)}).raw=jg;var kg=Vb(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(r.geo.stereographic=function(){return lb(kg)}).raw=kg;vd.invert=function(a,b){return[Math.atan2(w(a),Math.cos(b)),l(Math.sin(b)/C(a))]};(r.geo.transverseMercator=function(){return Se(vd)}).raw=vd;r.geom={};r.geom.hull=function(a){function b(a){if(3>a.length)return[];var b,n,m,l,e, h,r,w,p,k;w=V(c);p=V(d);k=a.length;var C=k-1,t=[],B=[],H=0;if(w===ub&&d===Fb)b=a;else for(m=0,b=[];k>m;++m)b.push([+w.call(this,n=a[m],m),+p.call(this,n,m)]);for(m=1;k>m;++m)(b[m][1]<b[H][1]||b[m][1]==b[H][1]&&b[m][0]<b[H][0])&&(H=m);for(m=0;k>m;++m)m!==H&&(e=b[m][1]-b[H][1],l=b[m][0]-b[H][0],t.push({angle:Math.atan2(e,l),index:m}));t.sort(function(a,b){return a.angle-b.angle});k=t[0].angle;p=t[0].index;w=0;for(m=1;C>m;++m){if(n=t[m].index,k==t[m].angle){if(l=b[p][0]-b[H][0],e=b[p][1]-b[H][1],h=b[n][0]- b[H][0],r=b[n][1]-b[H][1],l*l+e*e>=h*h+r*r){t[m].index=-1;continue}t[w].index=-1}k=t[m].angle;w=m;p=n}B.push(H);for(n=m=0;2>m;++n)-1<t[n].index&&(B.push(t[n].index),m++);for(m=B.length;C>n;++n)if(!(0>t[n].index)){for(;!Mg(B[m-2],B[m-1],t[n].index,b);)--m;B[m++]=t[n].index}b=[];for(m-=1;0<=m;--m)b.push(a[B[m]]);return b}var c=ub,d=Fb;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)};r.geom.polygon=function(a){return cc(a, $c),a};var $c=r.geom.polygon.prototype=[];$c.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],f=0;++b<c;)a=d,d=this[b],f+=a[1]*d[0]-a[0]*d[1];return 0.5*f};$c.centroid=function(a){var b,c,d=-1,f=this.length,g=0,n=0,m=this[f-1];for(arguments.length||(a=-1/(6*this.area()));++d<f;)b=m,m=this[d],c=b[0]*m[1]-m[0]*b[1],g+=(b[0]+m[0])*c,n+=(b[1]+m[1])*c;return[g*a,n*a]};$c.clip=function(a){for(var b,c,d,f,g,n,m=Ue(a),l=-1,e=this.length-Ue(this),h=this[e-1];++l<e;){b=a.slice();a.length=0;f=this[l]; g=b[(d=b.length-m)-1];for(c=-1;++c<d;)n=b[c],wd(n,h,f)?(wd(g,h,f)||a.push(Te(g,n,h,f)),a.push(n)):wd(g,h,f)&&a.push(Te(g,n,h,f)),g=n;m&&a.push(a[0]);h=f}return a};var Jb,vb,Hb,zd,Wb,We=[],$e=[];Ye.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Ze),b.length};xc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};Ad.prototype= {insert:function(a,b){var c,d,f;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=bf(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);b.L=b.R=null;b.U=c;b.C=!0;for(a=b;c&&c.C;)d=c.U,c===d.L?(f=d.R,f&&f.C?(c.C=f.C=!1,d.C=!0,a=d):(a===c.R&&(Yb(this,c),a=c,c=a.U),c.C=!1,d.C=!0,Zb(this,d))):(f=d.L,f&&f.C?(c.C=f.C=!1,d.C=!0,a=d):(a===c.L&&(Zb(this,c),a=c,c=a.U),c.C=!1,d.C=!0,Yb(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&& (a.N.P=a.P);a.P&&(a.P.N=a.N);a.N=a.P=null;var b,c,d,f=a.U,g=a.L,n=a.R;if(c=g?n?bf(n):g:n,f?f.L===a?f.L=c:f.R=c:this._=c,g&&n?(d=c.C,c.C=a.C,c.L=g,g.U=c,c!==n?(f=c.U,c.U=a.U,a=c.R,f.L=a,c.R=n,n.U=c):(c.U=f,f=c,a=c.R)):(d=a.C,a=c),a&&(a.U=f),!d){if(a&&a.C)return a.C=!1,void 0;do{if(a===this._)break;if(a===f.L){if(b=f.R,b.C&&(b.C=!1,f.C=!0,Yb(this,f),b=f.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,Zb(this,b),b=f.R);b.C=f.C;f.C=b.R.C=!1;Yb(this,f);a=this._;break}}else if(b=f.L,b.C&&(b.C=!1, f.C=!0,Zb(this,f),b=f.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,Yb(this,b),b=f.L);b.C=f.C;f.C=b.L.C=!1;Zb(this,f);a=this._;break}b.C=!0;a=f;f=f.U}while(!a.C);a&&(a.C=!1)}}};r.geom.voronoi=function(a){function b(a){var b=Array(a.length),d=m[0][0],g=m[0][1],f=m[1][0],n=m[1][1];return Bd(c(a),m).cells.forEach(function(c,m){var l=c.edges,e=c.site;(b[m]=l.length?l.map(function(a){a=a.start();return[a.x,a.y]}):e.x>=d&&e.x<=f&&e.y>=g&&e.y<=n?[[d,n],[f,n],[f,g],[d,g]]:[]).point=a[m]}),b}function c(a){return a.map(function(a, b){return{x:Math.round(g(a,b)/L)*L,y:Math.round(n(a,b)/L)*L,i:b}})}var d=ub,f=Fb,g=d,n=f,m=ad;return a?b(a):(b.links=function(a){return Bd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return Bd(c(a)).cells.forEach(function(c,d){for(var g,f=c.site,n=c.edges.sort(Ze),m=-1,l=n.length,e=n[l-1].edge,e=e.l===f?e.r:e.l;++m<l;)g=e,e=n[m].edge,e=e.l===f?e.r:e.l,d<g.i&&d<e.i&&0>(f.x-e.x)*(g.y-f.y)-(f.x-g.x)*(e.y- f.y)&&b.push([a[d],a[g.i],a[e.i]])}),b},b.x=function(a){return arguments.length?(g=V(d=a),b):d},b.y=function(a){return arguments.length?(n=V(f=a),b):f},b.clipExtent=function(a){return arguments.length?(m=null==a?ad:a,b):m===ad?null:m},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):m===ad?null:m&&m[1]},b)};var ad=[[-1E6,-1E6],[1E6,1E6]];r.geom.delaunay=function(a){return r.geom.voronoi().triangles(a)};r.geom.quadtree=function(a,b,c,d,f){function g(a){function g(a,b,c,d,f,n,m, l){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var h=a.x,r=a.y;if(null!=h){if(!(0.01>U(h-c)+U(r-d))){var w=a.point;a.x=a.y=a.point=null;e(a,w,h,r,f,n,m,l)}e(a,b,c,d,f,n,m,l)}else a.x=c,a.y=d,a.point=b}else e(a,b,c,d,f,n,m,l)}function e(a,b,c,d,f,n,m,l){var h=0.5*(f+m),r=0.5*(n+l),w=c>=h,u=d>=r,y=(u<<1)+w;a.leaf=!1;a=a.nodes[y]||(a.nodes[y]=cf());w?f=h:m=h;u?n=r:l=r;g(a,b,c,d,f,n,m,l)}var h,r,w,p,k,C,t,B,s,x=V(m),q=V(l);if(null!=b)C=b,t=c,B=d,s=f;else if(B=s=-(C=t=1/0),r=[],w=[],k=a.length,n)for(p=0;k>p;++p)h= a[p],h.x<C&&(C=h.x),h.y<t&&(t=h.y),h.x>B&&(B=h.x),h.y>s&&(s=h.y),r.push(h.x),w.push(h.y);else for(p=0;k>p;++p){var K=+x(h=a[p],p);h=+q(h,p);C>K&&(C=K);t>h&&(t=h);K>B&&(B=K);h>s&&(s=h);r.push(K);w.push(h)}K=B-C;h=s-t;K>h?s=t+K:B=C+h;var v=cf();if(v.add=function(a){g(v,a,+x(a,++p),+q(a,p),C,t,B,s)},v.visit=function(a){$b(a,v,C,t,B,s)},p=-1,null==b){for(;++p<k;)g(v,a[p],r[p],w[p],C,t,B,s);--p}else a.forEach(v.add);return r=w=a=h=null,v}var n,m=ub,l=Fb;return(n=arguments.length)?(m=Sg,l=Tg,3===n&&(f= c,d=b,c=b=0),g(a)):(g.x=function(a){return arguments.length?(m=a,g):m},g.y=function(a){return arguments.length?(l=a,g):l},g.extent=function(a){return arguments.length?(null==a?b=c=d=f=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],f=+a[1][1]),g):null==b?null:[[b,c],[d,f]]},g.size=function(a){return arguments.length?(null==a?b=c=d=f=null:(b=c=0,d=+a[0],f=+a[1]),g):null==b?null:[d-b,f-c]},g)};r.interpolateRgb=Cd;r.interpolateObject=df;r.interpolateNumber=cb;r.interpolateString=ef;var yc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g; r.interpolate=wb;r.interpolators=[function(a,b){var c=typeof b;return("string"===c?ec.has(b)||/^(#|rgb\(|hsl\()/.test(b)?Cd:ef:b instanceof ga?Cd:"object"===c?Array.isArray(b)?zc:df:cb)(a,b)}];r.interpolateArray=zc;var lg=function(){return ra},ci=r.map({linear:lg,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return Vg},cubic:function(){return Wg},sin:function(){return Yg},exp:function(){return Zg},circle:function(){return $g},elastic:function(a,b){var c;return 2>arguments.length&& (b=0.45),arguments.length?c=b/Aa*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Aa/b)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return ah}}),di=r.map({"in":ra,out:ff,"in-out":gf,"out-in":function(a){return gf(ff(a))}});r.ease=function(a){var b=a.indexOf("-"),c=0<=b?a.substring(0,b):a,b=0<=b?a.substring(b+1):"in";return c=ci.get(c)||lg,b=di.get(b)||ra,Ug(b(c.apply(null,Zf.call(arguments,1))))};r.interpolateHcl= function(a,b){a=r.hcl(a);b=r.hcl(b);var c=a.h,d=a.c,f=a.l,g=b.h-c,n=b.c-d,m=b.l-f;return isNaN(n)&&(n=0,d=isNaN(d)?b.c:d),isNaN(g)?(g=0,c=isNaN(c)?b.h:c):180<g?g-=360:-180>g&&(g+=360),function(a){return Z(c+g*a,d+n*a,f+m*a)+""}};r.interpolateHsl=function(a,b){a=r.hsl(a);b=r.hsl(b);var c=a.h,d=a.s,f=a.l,g=b.h-c,n=b.s-d,m=b.l-f;return isNaN(n)&&(n=0,d=isNaN(d)?b.s:d),isNaN(g)?(g=0,c=isNaN(c)?b.h:c):180<g?g-=360:-180>g&&(g+=360),function(a){return Ia(c+g*a,d+n*a,f+m*a)+""}};r.interpolateLab=function(a, b){a=r.lab(a);b=r.lab(b);var c=a.l,d=a.a,f=a.b,g=b.l-c,n=b.a-d,m=b.b-f;return function(a){return Ua(c+g*a,d+n*a,f+m*a)+""}};r.interpolateRound=hf;r.transform=function(a){var b=Sa.createElementNS(r.ns.prefix.svg,"g");return(r.transform=function(a){if(null!=a){b.setAttribute("transform",a);var d=b.transform.baseVal.consolidate()}return new jf(d?d.matrix:ei)})(a)};jf.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ei= {a:1,b:0,c:0,d:1,e:0,f:0};r.interpolateTransform=lf;r.layout={};r.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(dh(a[c]));return b}};r.layout.chord=function(){function a(){var a,e,w,p,u,k={},C=[],t=r.range(g),B=[];c=[];d=[];a=0;for(p=-1;++p<g;){e=0;for(u=-1;++u<g;)e+=f[p][u];C.push(e);B.push(r.range(g));a+=e}n&&t.sort(function(a,b){return n(C[a],C[b])});m&&B.forEach(function(a,b){a.sort(function(a,c){return m(f[b][a],f[b][c])})});a=(Aa-h*g)/a;e=0;for(p=-1;++p< g;){w=e;for(u=-1;++u<g;){var s=t[p],x=B[s][u],q=f[s][x],K=e,v=e+=q*a;k[s+"-"+x]={index:s,subindex:x,startAngle:K,endAngle:v,value:q}}d[s]={index:s,startAngle:w,endAngle:e,value:(e-w)/a};e+=h}for(p=-1;++p<g;)for(u=p-1;++u<g;)a=k[p+"-"+u],e=k[u+"-"+p],(a.value||e.value)&&c.push(a.value<e.value?{source:e,target:a}:{source:a,target:e});l&&b()}function b(){c.sort(function(a,b){return l((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,f,g,n,m,l,e={},h=0;return e.matrix=function(a){return arguments.length? (g=(f=a)&&f.length,c=d=null,e):f},e.padding=function(a){return arguments.length?(h=a,c=d=null,e):h},e.sortGroups=function(a){return arguments.length?(n=a,c=d=null,e):n},e.sortSubgroups=function(a){return arguments.length?(m=a,c=null,e):m},e.sortChords=function(a){return arguments.length?(l=a,c&&b(),e):l},e.chords=function(){return c||a(),c},e.groups=function(){return d||a(),d},e};r.layout.force=function(){function a(a){return function(b,c,d,g){if(b.point!==a){d=b.cx-a.x;var f=b.cy-a.y,n=1/Math.sqrt(d* d+f*f);if(t>(g-c)*n)return c=b.charge*n*n,a.px-=d*c,a.py-=f*c,!0;b.point&&isFinite(n)&&(c=b.pointCharge*n*n,a.px-=d*c,a.py-=f*c)}return!b.charge}}function b(a){a.px=r.event.x;a.py=r.event.y;m.resume()}var c,d,f,g,n,m={},l=r.dispatch("start","tick","end"),e=[1,1],h=0.9,w=fi,p=gi,k=-30,C=0.1,t=0.8,B=[],s=[];return m.tick=function(){if(0.005>(d*=0.99))return l.end({type:"end",alpha:d=0}),!0;var b,c,m,w,p,t,x,q,K=B.length,v=s.length;for(c=0;v>c;++c)m=s[c],b=m.source,w=m.target,x=w.x-b.x,q=w.y-b.y,(p= x*x+q*q)&&(p=d*g[c]*((p=Math.sqrt(p))-f[c])/p,x*=p,q*=p,w.x-=x*(t=b.weight/(w.weight+b.weight)),w.y-=q*t,b.x+=x*(t=1-t),b.y+=q*t);if((t=d*C)&&(x=e[0]/2,q=e[1]/2,c=-1,t))for(;++c<K;)m=B[c],m.x+=(x-m.x)*t,m.y+=(q-m.y)*t;if(k)for(nf(b=r.geom.quadtree(B),d,n),c=-1;++c<K;)(m=B[c]).fixed||b.visit(a(m));for(c=-1;++c<K;)m=B[c],m.fixed?(m.x=m.px,m.y=m.py):(m.x-=(m.px-(m.px=m.x))*h,m.y-=(m.py-(m.py=m.y))*h);l.tick({type:"tick",alpha:d})},m.nodes=function(a){return arguments.length?(B=a,m):B},m.links=function(a){return arguments.length? (s=a,m):s},m.size=function(a){return arguments.length?(e=a,m):e},m.linkDistance=function(a){return arguments.length?(w="function"==typeof a?a:+a,m):w},m.distance=m.linkDistance,m.linkStrength=function(a){return arguments.length?(p="function"==typeof a?a:+a,m):p},m.friction=function(a){return arguments.length?(h=+a,m):h},m.charge=function(a){return arguments.length?(k="function"==typeof a?a:+a,m):k},m.gravity=function(a){return arguments.length?(C=+a,m):C},m.theta=function(a){return arguments.length? (t=+a,m):t},m.alpha=function(a){return arguments.length?(a=+a,d?d=0<a?a:0:0<a&&(l.start({type:"start",alpha:d=a}),r.timer(m.tick)),m):d},m.start=function(){function a(d,g){if(!c){c=Array(l);for(m=0;l>m;++m)c[m]=[];for(m=0;e>m;++m){var f=s[m];c[f.source.index].push(f.target);c[f.target.index].push(f.source)}}for(var n=c[b],m=-1,e=n.length;++m<e;)if(!isNaN(f=n[m][d]))return f;return Math.random()*g}var b,c,d,l=B.length,h=s.length,r=e[0],y=e[1];for(b=0;l>b;++b)(d=B[b]).index=b,d.weight=0;for(b=0;h>b;++b)d= s[b],"number"==typeof d.source&&(d.source=B[d.source]),"number"==typeof d.target&&(d.target=B[d.target]),++d.source.weight,++d.target.weight;for(b=0;l>b;++b)d=B[b],isNaN(d.x)&&(d.x=a("x",r)),isNaN(d.y)&&(d.y=a("y",y)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof w)for(b=0;h>b;++b)f[b]=+w.call(this,s[b],b);else for(b=0;h>b;++b)f[b]=w;if(g=[],"function"==typeof p)for(b=0;h>b;++b)g[b]=+p.call(this,s[b],b);else for(b=0;h>b;++b)g[b]=p;if(n=[],"function"==typeof k)for(b=0;l> b;++b)n[b]=+k.call(this,B[b],b);else for(b=0;l>b;++b)n[b]=k;return m.resume()},m.resume=function(){return m.alpha(0.1)},m.stop=function(){return m.alpha(0)},m.drag=function(){return c||(c=r.behavior.drag().origin(ra).on("dragstart.force",eh).on("drag.force",b).on("dragend.force",fh)),arguments.length?(this.on("mouseover.force",gh).on("mouseout.force",hh).call(c),void 0):c},r.rebind(m,l,"on")};var fi=20,gi=1;r.layout.hierarchy=function(){function a(b,m,l){var e=f.call(c,b,m);if(b.depth=m,l.push(b), e&&(h=e.length)){for(var h,w=-1,r=b.children=Array(h),p=0,k=m+1;++w<h;)m=r[w]=a(e[w],k,l),m.parent=b,p+=m.value;d&&r.sort(d);g&&(b.value=p)}else delete b.children,g&&(b.value=+g.call(c,b,m)||0);return b}function b(a,d){var f=a.children,l=0;if(f&&(e=f.length))for(var e,h=-1,w=d+1;++h<e;)l+=b(f[h],w);else g&&(l=+g.call(c,a,d)||0);return g&&(a.value=l),l}function c(b){var c=[];return a(b,0,c),c}var d=lh,f=jh,g=kh;return c.sort=function(a){return arguments.length?(d=a,c):d},c.children=function(a){return arguments.length? (f=a,c):f},c.value=function(a){return arguments.length?(g=a,c):g},c.revalue=function(a){return b(a,0),a},c};r.layout.partition=function(){function a(b,c,d,f){var l=b.children;if(b.x=c,b.y=b.depth*f,b.dx=d,b.dy=f,l&&(e=l.length)){var e,h,w=-1;for(d=b.value?d/b.value:0;++w<e;)a(h=l[w],c,b=h.value*d,f),c+=b}}function b(a){a=a.children;var c=0;if(a&&(d=a.length))for(var d,f=-1;++f<d;)c=Math.max(c,b(a[f]));return 1+c}function c(c,n){var m=d.call(this,c,n);return a(m[0],0,f[0],f[1]/b(m[0])),m}var d=r.layout.hierarchy(), f=[1,1];return c.size=function(a){return arguments.length?(f=a,c):f},ac(c,d)};r.layout.pie=function(){function a(g){var n=g.map(function(c,d){return+b.call(a,c,d)}),m=+("function"==typeof d?d.apply(this,arguments):d),l=(("function"==typeof f?f.apply(this,arguments):f)-m)/r.sum(n),e=r.range(g.length);null!=c&&e.sort(c===mg?function(a,b){return n[b]-n[a]}:function(a,b){return c(g[a],g[b])});var h=[];return e.forEach(function(a){var b;h[a]={data:g[a],value:b=n[a],startAngle:m,endAngle:m+=b*l}}),h}var b= Number,c=mg,d=0,f=Aa;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(f=b,a):f},a};var mg={};r.layout.stack=function(){function a(m,l){var e=m.map(function(c,d){return b.call(a,c,d)}),h=e.map(function(b){return b.map(function(b,c){return[g.call(a,b,c),n.call(a,b,c)]})}),w=c.call(a,h,l),e=r.permute(e,w),h=r.permute(h,w),p,k,t= d.call(a,h,l),C=e.length,B=e[0].length;for(p=0;B>p;++p)for(f.call(a,e[0][p],k=t[p],h[0][p][1]),w=1;C>w;++w)f.call(a,e[w][p],k+=h[w-1][p][1],h[w][p][1]);return m}var b=ra,c=Dd,d=Ed,f=oh,g=mh,n=nh;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:hi.get(b)||Dd,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:ii.get(b)||Ed,a):d},a.x=function(b){return arguments.length?(g=b,a):g},a.y=function(b){return arguments.length? (n=b,a):n},a.out=function(b){return arguments.length?(f=b,a):f},a};var hi=r.map({"inside-out":function(a){var b,c=a.length,d=a.map(ph),f=a.map(qh),g=r.range(c).sort(function(a,b){return d[a]-d[b]}),n=0,m=0,l=[],e=[];for(a=0;c>a;++a)b=g[a],m>n?(n+=f[b],l.push(b)):(m+=f[b],e.push(b));return e.reverse().concat(l)},reverse:function(a){return r.range(a.length).reverse()},"default":Dd}),ii=r.map({silhouette:function(a){var b,c,d,f=a.length,g=a[0].length,n=[],m=0,l=[];for(c=0;g>c;++c){for(d=b=0;f>b;b++)d+= a[b][c][1];d>m&&(m=d);n.push(d)}for(c=0;g>c;++c)l[c]=(m-n[c])/2;return l},wiggle:function(a){var b,c,d,f,g,n,m,l,e,h=a.length,w=a[0],r=w.length,p=[];p[0]=l=e=0;for(c=1;r>c;++c){for(f=b=0;h>b;++b)f+=a[b][c][1];g=b=0;for(m=w[c][0]-w[c-1][0];h>b;++b){d=0;for(n=(a[b][c][1]-a[b][c-1][1])/(2*m);b>d;++d)n+=(a[d][c][1]-a[d][c-1][1])/m;g+=n*a[b][c][1]}p[c]=l-=f?g/f*m:0;e>l&&(e=l)}for(c=0;r>c;++c)p[c]-=e;return p},expand:function(a){var b,c,d,f=a.length,g=a[0].length,n=1/f,m=[];for(c=0;g>c;++c){for(d=b=0;f> b;b++)d+=a[b][c][1];if(d)for(b=0;f>b;b++)a[b][c][1]/=d;else for(b=0;f>b;b++)a[b][c][1]=n}for(c=0;g>c;++c)m[c]=0;return m},zero:Ed});r.layout.histogram=function(){function a(a,n){var m,l,e=[],h=a.map(c,this),w=d.call(this,h,n),p=f.call(this,w,h,n);n=-1;for(var k=h.length,t=p.length-1,C=b?1:1/k;++n<t;)m=e[n]=[],m.dx=p[n+1]-(m.x=p[n]),m.y=0;if(0<t)for(n=-1;++n<k;)l=h[n],l>=w[0]&&l<=w[1]&&(m=e[r.bisect(p,l,1,t)-1],m.y+=C,m.push(a[n]));return e}var b=!0,c=Number,d=th,f=sh;return a.value=function(b){return arguments.length? (c=b,a):c},a.range=function(b){return arguments.length?(d=V(b),a):d},a.bins=function(b){return arguments.length?(f="number"==typeof b?function(a){return of(a,b)}:V(b),a):f},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a};r.layout.tree=function(){function a(a,n){function m(a,b){var d=a.children,f=a._tree;if(d&&(g=d.length)){for(var g,n,l,e=d[0],h=e,w=-1;++w<g;){l=d[w];m(l,n);var r=l;if(n){for(var p=void 0,k=r,u=r,y=r.parent.children[0],t=k._tree.mod,C=u._tree.mod,B=n._tree.mod,s=y._tree.mod;n= Gd(n),k=Fd(k),n&&k;){y=Fd(y);u=Gd(u);u._tree.ancestor=r;p=n._tree.prelim+B-k._tree.prelim-t+c(n,k);if(0<p){var x=n._tree.ancestor.parent==r.parent?n._tree.ancestor:h,q=r,D=p,x=x._tree,q=q._tree,K=D/(q.number-x.number);x.change+=K;q.change-=K;q.shift+=D;q.prelim+=D;q.mod+=D;t+=p;C+=p}B+=n._tree.mod;t+=k._tree.mod;s+=y._tree.mod;C+=u._tree.mod}n&&!Gd(u)&&(u._tree.thread=n,u._tree.mod+=B-C);k&&!Fd(y)&&(y._tree.thread=k,y._tree.mod+=t-s,h=r)}n=l}w=g=0;r=a.children;for(h=r.length;0<=--h;)d=r[h]._tree, d.prelim+=g,d.mod+=g,g+=d.shift+(w+=d.change);l=0.5*(e._tree.prelim+l._tree.prelim);b?(f.prelim=b._tree.prelim+c(a,b),f.mod=f.prelim-l):f.prelim=l}else b&&(f.prelim=b._tree.prelim+c(a,b))}function l(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(d=c.length)){var d,f=-1;for(b+=a._tree.mod;++f<d;)l(c[f],b)}}var e=b.call(this,a,n),h=e[0];db(h,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}});m(h);l(h,-h._tree.prelim);var w=Ac(h,vh),r=Ac(h,uh),p=Ac(h, wh),k=w.x-c(w,r)/2,t=r.x+c(r,w)/2,C=p.depth||1;return db(h,f?function(a){a.x*=d[0];a.y=a.depth*d[1];delete a._tree}:function(a){a.x=(a.x-k)/(t-k)*d[0];a.y=a.depth/C*d[1];delete a._tree}),e}var b=r.layout.hierarchy().sort(null).value(null),c=pf,d=[1,1],f=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(f=null==(d=b),a):f?null:d},a.nodeSize=function(b){return arguments.length?(f=null!=(d=b),a):f?d:null},ac(a,b)};r.layout.pack=function(){function a(a, n){var m=c.call(this,a,n),l=m[0],e=f[0],h=f[1],w=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(l.x=l.y=0,db(l,function(a){a.r=+w(a.value)}),db(l,sf),d){var r=d*(b?1:Math.max(2*l.r/e,2*l.r/h))/2;db(l,function(a){a.r+=r});db(l,sf);db(l,function(a){a.r-=r})}return uf(l,e/2,h/2,b?1:1/Math.max(2*l.r/e,2*l.r/h)),m}var b,c=r.layout.hierarchy().sort(xh),d=0,f=[1,1];return a.size=function(b){return arguments.length?(f=b,a):f},a.radius=function(c){return arguments.length?(b=null==c||"function"== typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},ac(a,c)};r.layout.cluster=function(){function a(a,n){var m,l=b.call(this,a,n),e=l[0],h=0;db(e,function(a){var b=a.children;b&&b.length?(a.x=Bh(b),a.y=Ah(b)):(a.x=m?h+=c(a,m):0,a.y=0,m=a)});var w=vf(e),r=wf(e),p=w.x-c(w,r)/2,k=r.x+c(r,w)/2;return db(e,f?function(a){a.x=(a.x-e.x)*d[0];a.y=(e.y-a.y)*d[1]}:function(a){a.x=(a.x-p)/(k-p)*d[0];a.y=(1-(e.y?a.y/e.y:1))*d[1]}),l}var b=r.layout.hierarchy().sort(null).value(null),c= pf,d=[1,1],f=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(f=null==(d=b),a):f?null:d},a.nodeSize=function(b){return arguments.length?(f=null!=(d=b),a):f?d:null},ac(a,b)};r.layout.treemap=function(){function a(a,b){for(var c,d,f=-1,g=a.length;++f<g;)d=(c=a[f]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,l=h(c),n=[],m=f.slice(),e=1/0,w="slice"===p?l.dx:"dice"===p?l.dy:"slice-dice"=== p?1&c.depth?l.dy:l.dx:Math.min(l.dx,l.dy);a(m,l.dx*l.dy/c.value);for(n.area=0;0<(c=m.length);){n.push(c=m[c-1]);n.area+=c.area;var r;if(!(r="squarify"!==p)){c=w;g=void 0;var u=n.area;r=0;for(var y=1/0,t=-1,C=n.length;++t<C;)(g=n[t].area)&&(y>g&&(y=g),g>r&&(r=g));r=(g=(u*=u,c*=c,u?Math.max(c*r*k/u,u/(c*y*k)):1/0))<=e}r?(m.pop(),e=g):(n.area-=n.pop().area,d(n,w,l,!1),w=Math.min(l.dx,l.dy),n.length=n.area=0,e=1/0)}n.length&&(d(n,w,l,!0),n.length=n.area=0);f.forEach(b)}}function c(b){var f=b.children; if(f&&f.length){var g=h(b),n=f.slice(),l=[];a(n,g.dx*g.dy/b.value);for(l.area=0;b=n.pop();)l.push(b),l.area+=b.area,null!=b.z&&(d(l,b.z?g.dx:g.dy,g,!n.length),l.length=l.area=0);f.forEach(c)}}function d(a,b,c,d){var f,g=-1,n=a.length,l=c.x,e=c.y,h=b?m(a.area/b):0;if(b==c.dx){for((d||h>c.dy)&&(h=c.dy);++g<n;)f=a[g],f.x=l,f.y=e,f.dy=h,l+=f.dx=Math.min(c.x+c.dx-l,h?m(f.area/h):0);f.z=!0;f.dx+=c.x+c.dx-l;c.y+=h;c.dy-=h}else{for((d||h>c.dx)&&(h=c.dx);++g<n;)f=a[g],f.x=l,f.y=e,f.dx=h,e+=f.dy=Math.min(c.y+ c.dy-e,h?m(f.area/h):0);f.z=!1;f.dy+=c.y+c.dy-e;c.x+=h;c.dx-=h}}function f(d){d=g||n(d);var f=d[0];return f.x=0,f.y=0,f.dx=l[0],f.dy=l[1],g&&n.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),w&&(g=d),d}var g,n=r.layout.hierarchy(),m=Math.round,l=[1,1],e=null,h=Id,w=!1,p="squarify",k=0.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(l=a,f):l},f.padding=function(a){function b(c){var d=a.call(f,c,c.depth);return null==d?Id(c):xf(c,"number"==typeof d?[d,d,d,d]:d)}function c(b){return xf(b, a)}if(!arguments.length)return e;var d;return h=null==(e=a)?Id:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(m=a?Math.round:Number,f):m!=Number},f.sticky=function(a){return arguments.length?(w=a,g=null,f):w},f.ratio=function(a){return arguments.length?(k=a,f):k},f.mode=function(a){return arguments.length?(p=a+"",f):p},ac(f,n)};r.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,f;do c=2*Math.random()- 1,f=2*Math.random()-1,f=c*c+f*f;while(!f||1<f);return a+b*c*Math.sqrt(-2*Math.log(f)/f)}},logNormal:function(){var a=r.random.normal.apply(r,arguments);return function(){return Math.exp(a())}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b/a}}};r.scale={};var Dh={floor:ra,ceil:ra};r.scale.linear=function(){return zf([0,1],[0,1],wb,!1)};var Gh={s:1,g:1,p:1,r:1,e:1};r.scale.log=function(){return Bf(r.scale.linear().domain([0,1]),10,!0,[1,10])};var Cf=r.format(".0e"), Hh={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};r.scale.pow=function(){return Df(r.scale.linear(),1,[0,1])};r.scale.sqrt=function(){return r.scale.pow().exponent(0.5)};r.scale.ordinal=function(){return Ef([],{t:"range",a:[[]]})};r.scale.category10=function(){return r.scale.ordinal().range(ji)};r.scale.category20=function(){return r.scale.ordinal().range(ki)};r.scale.category20b=function(){return r.scale.ordinal().range(li)};r.scale.category20c=function(){return r.scale.ordinal().range(mi)}; var ji=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(qb),ki=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(qb),li=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(qb),mi=[3244733,7057110,10406625, 13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(qb);r.scale.quantile=function(){return Ff([],[])};r.scale.quantize=function(){return Gf(0,1,[0,1])};r.scale.threshold=function(){return Hf([0.5],[0,1])};r.scale.identity=function(){return If([0,1])};r.svg={};r.svg.arc=function(){function a(){var a=b.apply(this,arguments),l=c.apply(this,arguments),m=d.apply(this,arguments)+xb,e=f.apply(this,arguments)+ xb,h=(m>e&&(h=m,m=e,e=h),e-m),w=T>h?"0":"1",r=Math.cos(m),m=Math.sin(m),p=Math.cos(e),e=Math.sin(e);return h>=ni?a?"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+" 0 1,1 0,"+l+"M0,"+a+"A"+a+","+a+" 0 1,0 0,"+-a+"A"+a+","+a+" 0 1,0 0,"+a+"Z":"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+" 0 1,1 0,"+l+"Z":a?"M"+l*r+","+l*m+"A"+l+","+l+" 0 "+w+",1 "+l*p+","+l*e+"L"+a*p+","+a*e+"A"+a+","+a+" 0 "+w+",0 "+a*r+","+a*m+"Z":"M"+l*r+","+l*m+"A"+l+","+l+" 0 "+w+",1 "+l*p+","+l*e+"L0,0Z"}var b=Ih,c=Jh,d=Jf, f=Kf;return a.innerRadius=function(c){return arguments.length?(b=V(c),a):b},a.outerRadius=function(b){return arguments.length?(c=V(b),a):c},a.startAngle=function(b){return arguments.length?(d=V(b),a):d},a.endAngle=function(b){return arguments.length?(f=V(b),a):f},a.centroid=function(){var a=(b.apply(this,arguments)+c.apply(this,arguments))/2,l=(d.apply(this,arguments)+f.apply(this,arguments))/2+xb;return[Math.cos(l)*a,Math.sin(l)*a]},a};var xb=-ya,ni=Aa-L;r.svg.line=function(){return Lf(ra)};var Md= r.map({linear:Ga,"linear-closed":function(a){return Ga(a)+"Z"},step:function(a){for(var b=0,c=a.length,d=a[0],f=[d[0],",",d[1]];++b<c;)f.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return 1<c&&f.push("H",d[0]),f.join("")},"step-before":Nd,"step-after":Od,basis:Mf,"basis-open":function(a){if(4>a.length)return Ga(a);for(var b,c=[],d=-1,f=a.length,g=[0],l=[0];3>++d;)b=a[d],g.push(b[0]),l.push(b[1]);c.push(Ma(nb,g)+","+Ma(nb,l));for(--d;++d<f;)b=a[d],g.shift(),g.push(b[0]),l.shift(),l.push(b[1]),Qd(c,g,l); return c.join("")},"basis-closed":function(a){for(var b,c,d=-1,f=a.length,g=f+4,l=[],m=[];4>++d;)c=a[d%f],l.push(c[0]),m.push(c[1]);b=[Ma(nb,l),",",Ma(nb,m)];for(--d;++d<g;)c=a[d%f],l.shift(),l.push(c[0]),m.shift(),m.push(c[1]),Qd(b,l,m);return b.join("")},bundle:function(a,b){var c=a.length-1;if(c)for(var d,f,g=a[0][0],l=a[0][1],m=a[c][0]-g,e=a[c][1]-l,h=-1;++h<=c;)d=a[h],f=h/c,d[0]=b*d[0]+(1-b)*(g+f*m),d[1]=b*d[1]+(1-b)*(l+f*e);return Mf(a)},cardinal:function(a,b){return 3>a.length?Ga(a):a[0]+Ec(a, Pd(a,b))},"cardinal-open":function(a,b){return 4>a.length?Ga(a):a[1]+Ec(a.slice(1,a.length-1),Pd(a,b))},"cardinal-closed":function(a,b){return 3>a.length?Ga(a):a[0]+Ec((a.push(a[0]),a),Pd([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){if(3>a.length)a=Ga(a);else{var b=a[0],c,d,f,g,l=[],m;c=0;m=a.length-1;for(var e=[],h=a[1],w=e[0]=Rd(a[0],h);++c<m;)e[c]=(w+(w=Rd(h,h=a[c+1])))/2;m=(e[c]=w,e);e=-1;for(h=a.length-1;++e<h;)c=Rd(a[e],a[e+1]),U(c)<L?m[e]=m[e+1]=0:(d=m[e]/c,f=m[e+1]/c,g=d*d+f* f,9<g&&(g=3*c/Math.sqrt(g),m[e]=g*d,m[e+1]=g*f));for(e=-1;++e<=h;)g=(a[Math.min(h,e+1)][0]-a[Math.max(0,e-1)][0])/(6*(1+m[e]*m[e])),l.push([g||0,m[e]*g||0]);a=b+Ec(a,l)}return a}});Md.forEach(function(a,b){b.key=a;b.closed=/-closed$/.test(a)});var Nf=[0,2/3,1/3,0],Of=[0,1/3,2/3,0],nb=[0,1/6,2/3,1/6];r.svg.line.radial=function(){var a=Lf(Pf);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};Nd.reverse=Od;Od.reverse=Nd;r.svg.area=function(){return Qf(ra)};r.svg.area.radial=function(){var a=Qf(Pf); return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};r.svg.chord=function(){function a(a,g){var l=b(this,d,a,g),m=b(this,f,a,g);return"M"+l.p0+c(l.r,l.p1,l.a1-l.a0)+(l.a0==m.a0&&l.a1==m.a1?"Q 0,0 "+l.p0:"Q 0,0 "+m.p0+c(m.r,m.p1,m.a1-m.a0)+("Q 0,0 "+l.p0))+"Z"}function b(a,b,c,d){var f=b.call(a,c,d);b=g.call(a,f,d);c=l.call(a,f,d)+xb;a=m.call(a,f,d)+xb;return{r:b,a0:c,a1:a,p0:[b* Math.cos(c),b*Math.sin(c)],p1:[b*Math.cos(a),b*Math.sin(a)]}}function c(a,b,c){return"A"+a+","+a+" 0 "+ +(c>T)+",1 "+b}var d=td,f=ud,g=Kh,l=Jf,m=Kf;return a.radius=function(b){return arguments.length?(g=V(b),a):g},a.source=function(b){return arguments.length?(d=V(b),a):d},a.target=function(b){return arguments.length?(f=V(b),a):f},a.startAngle=function(b){return arguments.length?(l=V(b),a):l},a.endAngle=function(b){return arguments.length?(m=V(b),a):m},a};r.svg.diagonal=function(){function a(a,g){var l= b.call(this,a,g),m=c.call(this,a,g),e=(l.y+m.y)/2,l=[l,{x:l.x,y:e},{x:m.x,y:e},m];return l=l.map(d),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var b=td,c=ud,d=Rf;return a.source=function(c){return arguments.length?(b=V(c),a):b},a.target=function(b){return arguments.length?(c=V(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a};r.svg.diagonal.radial=function(){var a=r.svg.diagonal(),b=Rf,c=a.projection;return a.projection=function(a){return arguments.length?c(Lh(b=a)):b},a};r.svg.symbol= function(){function a(a,f){return(ng.get(b.call(this,a,f))||Sf)(c.call(this,a,f))}var b=Nh,c=Mh;return a.type=function(c){return arguments.length?(b=V(c),a):b},a.size=function(b){return arguments.length?(c=V(b),a):c},a};var ng=r.map({circle:Sf,cross:function(a){a=Math.sqrt(a/5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*og));var b=a*og;return"M0,"+-a+"L"+b+",0 0,"+a+" "+-b+",0Z"},square:function(a){a= Math.sqrt(a)/2;return"M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/cd);var b=a*cd/2;return"M0,"+b+"L"+a+","+-b+" "+-a+","+-b+"Z"},"triangle-up":function(a){a=Math.sqrt(a/cd);var b=a*cd/2;return"M0,"+-b+"L"+a+","+b+" "+-a+","+b+"Z"}});r.svg.symbolTypes=ng.keys();var Ab,Nc,cd=Math.sqrt(3),og=Math.tan(30*R),ka=[],dg=0;ka.call=Y.call;ka.empty=Y.empty;ka.node=Y.node;ka.size=Y.size;r.transition=function(a){return arguments.length?Ab?a.transition():a: cg.transition()};r.transition.prototype=ka;ka.select=function(a){var b,c,d,f=this.id,g=[];a=e(a);for(var l=-1,m=this.length;++l<m;){g.push(b=[]);for(var h=this[l],w=-1,r=h.length;++w<r;)(d=h[w])&&(c=a.call(d,d.__data__,w,l))?("__data__"in d&&(c.__data__=d.__data__),Fc(c,w,f,d.__transition__[f]),b.push(c)):b.push(null)}return bc(g,f)};ka.selectAll=function(a){var b,c,d,f,g=this.id,l=[];a=t(a);for(var m=-1,e=this.length;++m<e;)for(var h=this[m],w=-1,r=h.length;++w<r;)if(b=h[w]){f=b.__transition__[g]; c=a.call(b,b.__data__,w,m);l.push(b=[]);for(var p=-1,k=c.length;++p<k;)(d=c[p])&&Fc(d,p,g,f),b.push(d)}return bc(l,g)};ka.filter=function(a){var b,c,d,f=[];"function"!=typeof a&&(a=ta(a));for(var g=0,l=this.length;l>g;g++){f.push(b=[]);c=this[g];for(var m=0,e=c.length;e>m;m++)(d=c[m])&&a.call(d,d.__data__,m,g)&&b.push(d)}return bc(f,this.id)};ka.tween=function(a,b){var c=this.id;return 2>arguments.length?this.node().__transition__[c].tween.get(a):ha(this,null==b?function(b){b.__transition__[c].tween.remove(a)}: function(d){d.__transition__[c].tween.set(a,b)})};ka.attr=function(a,b){function c(){this.removeAttribute(m)}function d(){this.removeAttributeNS(m.space,m.local)}function f(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(m);return c!==a&&(b=l(c,a),function(a){this.setAttribute(m,b(a))})})}function g(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(m.space,m.local);return c!==a&&(b=l(c,a),function(a){this.setAttributeNS(m.space,m.local,b(a))})})}if(2>arguments.length){for(b in a)this.attr(b, a[b]);return this}var l="transform"==a?lf:wb,m=r.ns.qualify(a);return Sd(this,"attr."+a,b,m.local?g:f)};ka.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(f));return d&&function(a){this.setAttribute(f,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(f.space,f.local));return d&&function(a){this.setAttributeNS(f.space,f.local,d(a))}}var f=r.ns.qualify(a);return this.tween("attr."+a,f.local?d:c)};ka.style=function(a,b,c){function d(){this.style.removeProperty(a)} var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return Sd(this,"style."+a,b,function(b){return null==b?d:(b+="",function(){var d,f=qa.getComputedStyle(this,null).getPropertyValue(a);return f!==b&&(d=wb(f,b),function(b){this.style.setProperty(a,d(b),c)})})})};ka.styleTween=function(a,b,c){return 3>arguments.length&&(c=""),this.tween("style."+a,function(d,f){var g=b.call(this,d,f,qa.getComputedStyle(this,null).getPropertyValue(a));return g&& function(b){this.style.setProperty(a,g(b),c)}})};ka.text=function(a){return Sd(this,"text",a,Oh)};ka.remove=function(){return this.each("end.transition",function(){var a;2>this.__transition__.count&&(a=this.parentNode)&&a.removeChild(this)})};ka.ease=function(a){var b=this.id;return 1>arguments.length?this.node().__transition__[b].ease:("function"!=typeof a&&(a=r.ease.apply(r,arguments)),ha(this,function(c){c.__transition__[b].ease=a}))};ka.delay=function(a){var b=this.id;return ha(this,"function"== typeof a?function(c,d,f){c.__transition__[b].delay=+a.call(c,c.__data__,d,f)}:(a=+a,function(c){c.__transition__[b].delay=a}))};ka.duration=function(a){var b=this.id;return ha(this,"function"==typeof a?function(c,d,f){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,f))}:(a=Math.max(1,a),function(c){c.__transition__[b].duration=a}))};ka.each=function(a,b){var c=this.id;if(2>arguments.length){var d=Nc,f=Ab;Ab=c;ha(this,function(b,d,f){Nc=b.__transition__[c];a.call(b,b.__data__,d,f)}); Nc=d;Ab=f}else ha(this,function(d){d=d.__transition__[c];(d.event||(d.event=r.dispatch("start","end"))).on(a,b)});return this};ka.transition=function(){for(var a,b,c,d,f=this.id,g=++dg,l=[],m=0,e=this.length;e>m;m++){l.push(a=[]);b=this[m];for(var h=0,w=b.length;w>h;h++)(c=b[h])&&(d=Object.create(c.__transition__[f]),d.delay+=d.duration,Fc(c,h,g,d)),a.push(c)}return bc(l,g)};r.svg.axis=function(){function a(a){a.each(function(){var a,h=r.select(this),w=this.__chart__||c,p=this.__chart__=c.copy(), k=null==e?p.ticks?p.ticks.apply(p,m):p.domain():e,t=null==b?p.tickFormat?p.tickFormat.apply(p,m):ra:b,C=h.selectAll(".tick").data(k,p),k=C.enter().insert("g",".domain").attr("class","tick").style("opacity",L),u=r.transition(C.exit()).style("opacity",L).remove(),B=r.transition(C).style("opacity",1),s=Bc(p),h=h.selectAll(".domain").data([0]),h=(h.enter().append("path").attr("class","domain"),r.transition(h));k.append("line");k.append("text");var x=k.select("line"),q=B.select("line"),t=C.select("text").text(t), C=k.select("text"),K=B.select("text");switch(d){case "bottom":a=Tf;x.attr("y2",f);C.attr("y",Math.max(f,0)+l);q.attr("x2",0).attr("y2",f);K.attr("x",0).attr("y",Math.max(f,0)+l);t.attr("dy",".71em").style("text-anchor","middle");h.attr("d","M"+s[0]+","+g+"V0H"+s[1]+"V"+g);break;case "top":a=Tf;x.attr("y2",-f);C.attr("y",-(Math.max(f,0)+l));q.attr("x2",0).attr("y2",-f);K.attr("x",0).attr("y",-(Math.max(f,0)+l));t.attr("dy","0em").style("text-anchor","middle");h.attr("d","M"+s[0]+","+-g+"V0H"+s[1]+ "V"+-g);break;case "left":a=Uf;x.attr("x2",-f);C.attr("x",-(Math.max(f,0)+l));q.attr("x2",-f).attr("y2",0);K.attr("x",-(Math.max(f,0)+l)).attr("y",0);t.attr("dy",".32em").style("text-anchor","end");h.attr("d","M"+-g+","+s[0]+"H0V"+s[1]+"H"+-g);break;case "right":a=Uf,x.attr("x2",f),C.attr("x",Math.max(f,0)+l),q.attr("x2",f).attr("y2",0),K.attr("x",Math.max(f,0)+l).attr("y",0),t.attr("dy",".32em").style("text-anchor","start"),h.attr("d","M"+g+","+s[0]+"H0V"+s[1]+"H"+g)}if(p.rangeBand)var v=p,Q=v.rangeBand()/ 2,w=p=function(a){return v(a)+Q};else w.rangeBand?w=p:u.call(a,p);k.call(a,w);B.call(a,p)})}var b,c=r.scale.linear(),d=pg,f=6,g=6,l=3,m=[10],e=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in oi?b+"":pg,a):d},a.ticks=function(){return arguments.length?(m=arguments,a):m},a.tickValues=function(b){return arguments.length?(e=b,a):e},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length; return c?(f=+b,g=+arguments[c-1],a):f},a.innerTickSize=function(b){return arguments.length?(f=+b,a):f},a.outerTickSize=function(b){return arguments.length?(g=+b,a):g},a.tickPadding=function(b){return arguments.length?(l=+b,a):l},a.tickSubdivide=function(){return arguments.length&&a},a};var pg="bottom",oi={top:1,right:1,bottom:1,left:1};r.svg.brush=function(){function a(g){g.each(function(){var g=r.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush", f).on("touchstart.brush",f),l=g.selectAll(".background").data([0]);l.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var m=g.selectAll(".resize").data(C,ra);m.exit().remove();m.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return pi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)? -3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");m.style("display",a.empty()?"none":null);var n,g=r.transition(g),l=r.transition(l);e&&(n=Bc(e),l.attr("x",n[0]).attr("width",n[1]-n[0]),c(g));h&&(n=Bc(h),l.attr("y",n[0]).attr("height",n[1]-n[0]),d(g));b(g)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+w[+/e$/.test(a)]+","+p[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x", w[0]);a.selectAll(".extent,.n>rect,.s>rect").attr("width",w[1]-w[0])}function d(a){a.select(".extent").attr("y",p[0]);a.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function f(){function f(){var a=r.mouse(q),g=!1;x&&(a[0]+=x[0],a[1]+=x[1]);E||(r.event.altKey?(s||(s=[(w[0]+w[1])/2,(p[0]+p[1])/2]),$[0]=w[+(a[0]<s[0])],$[1]=p[+(a[1]<s[1])]):s=null);A&&C(a,e,0)&&(c(Q),g=!0);ga&&C(a,h,1)&&(d(Q),g=!0);g&&(b(Q),v({type:"brush",mode:E?"move":"resize"}))}function C(a,b,c){var d,f,m=Bc(b); b=m[0];var m=m[1],e=$[c],h=c?p:w,r=h[1]-h[0];return E&&(b-=e,m-=r+e),d=(c?t:k)?Math.max(b,Math.min(m,a[c])):a[c],E?f=(d+=e)+r:(s&&(e=Math.max(b,Math.min(m,2*s[c]-d))),d>e?(f=d,d=e):f=e),h[0]!=d||h[1]!=f?(c?l=null:g=null,h[0]=d,h[1]=f,!0):void 0}function B(){f();Q.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);r.select("body").style("cursor",null);da.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush", null).on("keyup.brush",null);J();v({type:"brushend"})}var s,x,q=this,K=r.select(r.event.target),v=m.of(q,arguments),Q=r.select(q),V=K.datum(),A=!/^(n|s)$/.test(V)&&e,ga=!/^(e|w)$/.test(V)&&h,E=K.classed("extent"),J=Ca(),$=r.mouse(q),da=r.select(qa).on("keydown.brush",function(){32==r.event.keyCode&&(E||(s=null,$[0]-=w[1],$[1]-=p[1],E=2),z())}).on("keyup.brush",function(){32==r.event.keyCode&&2==E&&($[0]+=w[1],$[1]+=p[1],E=0,z())});if(r.event.changedTouches?da.on("touchmove.brush",f).on("touchend.brush", B):da.on("mousemove.brush",f).on("mouseup.brush",B),Q.interrupt().selectAll("*").interrupt(),E)$[0]=w[0]-$[0],$[1]=p[0]-$[1];else if(V){var I=+/w$/.test(V),V=+/^n/.test(V);x=[w[1-I]-$[0],p[1-V]-$[1]];$[0]=w[I];$[1]=p[V]}else r.event.altKey&&(s=$.slice());Q.style("pointer-events","none").selectAll(".resize").style("display",null);r.select("body").style("cursor",K.style("cursor"));v({type:"brushstart"});f()}var g,l,m=x(a,"brushstart","brush","brushend"),e=null,h=null,w=[0,0],p=[0,0],k=!0,t=!0,C=ae[0]; return a.event=function(a){a.each(function(){var a=m.of(this,arguments),b={x:w,y:p,i:g,j:l},c=this.__chart__||b;this.__chart__=b;Ab?r.select(this).transition().each("start.brush",function(){g=c.i;l=c.j;w=c.x;p=c.y;a({type:"brushstart"})}).tween("brush:brush",function(){var c=zc(w,b.x),d=zc(p,b.y);return g=l=null,function(f){w=b.x=c(f);p=b.y=d(f);a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i;l=b.j;a({type:"brush",mode:"resize"});a({type:"brushend"})}):(a({type:"brushstart"}), a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(e=b,C=ae[!e<<1|!h],a):e},a.y=function(b){return arguments.length?(h=b,C=ae[!e<<1|!h],a):h},a.clamp=function(b){return arguments.length?(e&&h?(k=!!b[0],t=!!b[1]):e?k=!!b:h&&(t=!!b),a):e&&h?[k,t]:e?k:h?t:null},a.extent=function(b){var c,d,f,m,r;return arguments.length?(e&&(c=b[0],d=b[1],h&&(c=c[0],d=d[0]),g=[c,d],e.invert&&(c=e(c),d=e(d)),c>d&&(r=c,c=d,d=r),(c!=w[0]||d!=w[1])&&(w=[c,d])),h&&(f=b[0],m=b[1], e&&(f=f[1],m=m[1]),l=[f,m],h.invert&&(f=h(f),m=h(m)),f>m&&(r=f,f=m,m=r),(f!=p[0]||m!=p[1])&&(p=[f,m])),a):(e&&(g?(c=g[0],d=g[1]):(c=w[0],d=w[1],e.invert&&(c=e.invert(c),d=e.invert(d)),c>d&&(r=c,c=d,d=r))),h&&(l?(f=l[0],m=l[1]):(f=p[0],m=p[1],h.invert&&(f=h.invert(f),m=h.invert(m)),f>m&&(r=f,f=m,m=r))),e&&h?[[c,f],[d,m]]:e?[c,d]:h&&[f,m])},a.clear=function(){return a.empty()||(w=[0,0],p=[0,0],g=l=null),a},a.empty=function(){return!!e&&w[0]==w[1]||!!h&&p[0]==p[1]},r.rebind(a,m,"on")};var pi={n:"ns-resize", e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ae=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],M=r.time={},sa=Date;eb.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()}, getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){fb.setUTCDate.apply(this._,arguments)},setDay:function(){fb.setUTCDay.apply(this._,arguments)},setFullYear:function(){fb.setUTCFullYear.apply(this._,arguments)},setHours:function(){fb.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){fb.setUTCMilliseconds.apply(this._, arguments)},setMinutes:function(){fb.setUTCMinutes.apply(this._,arguments)},setMonth:function(){fb.setUTCMonth.apply(this._,arguments)},setSeconds:function(){fb.setUTCSeconds.apply(this._,arguments)},setTime:function(){fb.setTime.apply(this._,arguments)}};var fb=Date.prototype,be="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ce="Sun Mon Tue Wed Thu Fri Sat".split(" "),de="January February March April May June July August September October November December".split(" "),ee="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "); M.year=yb(function(a){return a=M.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()});M.years=M.year.range;M.years.utc=M.year.utc.range;M.day=yb(function(a){var b=new sa(2E3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1});M.days=M.day.range;M.days.utc=M.day.utc.range;M.dayOfYear=function(a){var b=M.year(a);return Math.floor((a-b-6E4*(a.getTimezoneOffset()- b.getTimezoneOffset()))/864E5)};"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ").forEach(function(a,b){a=a.toLowerCase();b=7-b;var c=M[a]=yb(function(a){return(a=M.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=M.year(a).getDay();return Math.floor((M.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});M[a+"s"]=c.range;M[a+"s"].utc=c.utc.range;M[a+"OfYear"]=function(a){var c=M.year(a).getDay();return Math.floor((M.dayOfYear(a)+ (c+b)%7)/7)}});M.week=M.sunday;M.weeks=M.sunday.range;M.weeks.utc=M.sunday.utc.range;M.weekOfYear=M.sundayOfYear;M.format=va;var qg=Jc(be),qi=Kc(be),rg=Jc(ce),ri=Kc(ce),sg=Jc(de),si=Kc(de),tg=Jc(ee),ti=Kc(ee),ug=/^%/,Vf={"-":"",_:" ",0:"0"},Hc={a:function(a){return ce[a.getDay()]},A:function(a){return be[a.getDay()]},b:function(a){return ee[a.getMonth()]},B:function(a){return de[a.getMonth()]},c:va("%a %b %e %X %Y"),d:function(a,b){return wa(a.getDate(),b,2)},e:function(a,b){return wa(a.getDate(), b,2)},H:function(a,b){return wa(a.getHours(),b,2)},I:function(a,b){return wa(a.getHours()%12||12,b,2)},j:function(a,b){return wa(1+M.dayOfYear(a),b,3)},L:function(a,b){return wa(a.getMilliseconds(),b,3)},m:function(a,b){return wa(a.getMonth()+1,b,2)},M:function(a,b){return wa(a.getMinutes(),b,2)},p:function(a){return 12<=a.getHours()?"PM":"AM"},S:function(a,b){return wa(a.getSeconds(),b,2)},U:function(a,b){return wa(M.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return wa(M.mondayOfYear(a), b,2)},x:va("%m/%d/%Y"),X:va("%H:%M:%S"),y:function(a,b){return wa(a.getFullYear()%100,b,2)},Y:function(a,b){return wa(a.getFullYear()%1E4,b,4)},Z:function(a){var b=a.getTimezoneOffset();a=0<b?"-":"+";var c=~~(U(b)/60),b=U(b)%60;return a+wa(c,"0",2)+wa(b,"0",2)},"%":function(){return"%"}},Ph={a:function(a,b,c){rg.lastIndex=0;return(b=rg.exec(b.substring(c)))?(a.w=ri.get(b[0].toLowerCase()),c+b[0].length):-1},A:function(a,b,c){qg.lastIndex=0;return(b=qg.exec(b.substring(c)))?(a.w=qi.get(b[0].toLowerCase()), c+b[0].length):-1},b:function(a,b,c){tg.lastIndex=0;return(b=tg.exec(b.substring(c)))?(a.m=ti.get(b[0].toLowerCase()),c+b[0].length):-1},B:function(a,b,c){sg.lastIndex=0;return(b=sg.exec(b.substring(c)))?(a.m=si.get(b[0].toLowerCase()),c+b[0].length):-1},c:function(a,b,c){return Ic(a,Hc.c.toString(),b,c)},d:Wf,e:Wf,H:Xf,I:Xf,j:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+3)))?(a.j=+b[0],c+b[0].length):-1},L:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+3)))?(a.L= +b[0],c+b[0].length):-1},m:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+2)))?(a.m=b[0]-1,c+b[0].length):-1},M:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+2)))?(a.M=+b[0],c+b[0].length):-1},p:function(a,b,c){b=ui.get(b.substring(c,c+=2).toLowerCase());return null==b?-1:(a.p=b,c)},S:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+2)))?(a.S=+b[0],c+b[0].length):-1},U:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c)))?(a.U=+b[0],c+b[0].length): -1},w:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c,c+1)))?(a.w=+b[0],c+b[0].length):-1},W:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c)))?(a.W=+b[0],c+b[0].length):-1},x:function(a,b,c){return Ic(a,Hc.x.toString(),b,c)},X:function(a,b,c){return Ic(a,Hc.X.toString(),b,c)},y:function(a,b,c){ia.lastIndex=0;if(b=ia.exec(b.substring(c,c+2))){var d=+b[0];a=(a.y=d+(68<d?1900:2E3),c+b[0].length)}else a=-1;return a},Y:function(a,b,c){ia.lastIndex=0;return(b=ia.exec(b.substring(c, c+4)))?(a.y=+b[0],c+b[0].length):-1},Z:function(a,b,c){return/^[+-]\d{4}$/.test(b=b.substring(c,c+5))?(a.Z=+b,c+5):-1},"%":function(a,b,c){ug.lastIndex=0;return(a=ug.exec(b.substring(c,c+1)))?c+a[0].length:-1}},ia=/^\s*\d+/,ui=r.map({am:0,pm:1});va.utc=Xa;var vg=Xa("%Y-%m-%dT%H:%M:%S.%LZ");va.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Td:vg;Td.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Td.toString=vg.toString;M.second=yb(function(a){return new sa(1E3*Math.floor(a/ 1E3))},function(a,b){a.setTime(a.getTime()+1E3*Math.floor(b))},function(a){return a.getSeconds()});M.seconds=M.second.range;M.seconds.utc=M.second.utc.range;M.minute=yb(function(a){return new sa(6E4*Math.floor(a/6E4))},function(a,b){a.setTime(a.getTime()+6E4*Math.floor(b))},function(a){return a.getMinutes()});M.minutes=M.minute.range;M.minutes.utc=M.minute.utc.range;M.hour=yb(function(a){var b=a.getTimezoneOffset()/60;return new sa(36E5*(Math.floor(a/36E5-b)+b))},function(a,b){a.setTime(a.getTime()+ 36E5*Math.floor(b))},function(a){return a.getHours()});M.hours=M.hour.range;M.hours.utc=M.hour.utc.range;M.month=yb(function(a){return a=M.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()});M.months=M.month.range;M.months.utc=M.month.utc.range;var Lc=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],fe=[[M.second,1],[M.second,5],[M.second,15],[M.second,30],[M.minute,1],[M.minute,5],[M.minute,15],[M.minute, 30],[M.hour,1],[M.hour,3],[M.hour,6],[M.hour,12],[M.day,1],[M.day,2],[M.week,1],[M.month,1],[M.month,3],[M.year,1]],vi=[[va("%Y"),Eb],[va("%B"),function(a){return a.getMonth()}],[va("%b %d"),function(a){return 1!=a.getDate()}],[va("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[va("%I %p"),function(a){return a.getHours()}],[va("%I:%M"),function(a){return a.getMinutes()}],[va(":%S"),function(a){return a.getSeconds()}],[va(".%L"),function(a){return a.getMilliseconds()}]],wi=Yf(vi);fe.year= M.year;M.scale=function(){return Ud(r.scale.linear(),fe,wi)};var Qh={range:function(a,b,c){return r.range(+a,+b,c).map(zb)}},wg=fe.map(function(a){return[a[0].utc,a[1]]}),xi=[[Xa("%Y"),Eb],[Xa("%B"),function(a){return a.getUTCMonth()}],[Xa("%b %d"),function(a){return 1!=a.getUTCDate()}],[Xa("%a %d"),function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],[Xa("%I %p"),function(a){return a.getUTCHours()}],[Xa("%I:%M"),function(a){return a.getUTCMinutes()}],[Xa(":%S"),function(a){return a.getUTCSeconds()}], [Xa(".%L"),function(a){return a.getUTCMilliseconds()}]],yi=Yf(xi);return wg.year=M.year.utc,M.scale.utc=function(){return Ud(r.scale.linear(),wg,yi)},r.text=hd(function(a){return a.responseText}),r.json=function(a,b){return id(a,"application/json",Rh,b)},r.html=function(a,b){return id(a,"text/html",Sh,b)},r.xml=hd(function(a){return a.responseXML}),r}(); (function(){var k=this,q=k._,v={},A=Array.prototype,F=Object.prototype,J=A.push,E=A.slice,I=A.concat,O=F.toString,S=F.hasOwnProperty,z=A.forEach,s=A.map,x=A.reduce,h=A.reduceRight,e=A.filter,t=A.every,K=A.some,Q=A.indexOf,da=A.lastIndexOf,F=Array.isArray,pa=Object.keys,la=Function.prototype.bind,p=function(l){return l instanceof p?l:this instanceof p?(this._wrapped=l,void 0):new p(l)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p): k._=p;p.VERSION="1.5.2";var W=p.each=p.forEach=function(l,e,h){if(null!=l)if(z&&l.forEach===z)l.forEach(e,h);else if(l.length===+l.length)for(var k=0,t=l.length;t>k&&e.call(h,l[k],k,l)!==v;k++);else for(var s=p.keys(l),k=0,t=s.length;t>k&&e.call(h,l[s[k]],s[k],l)!==v;k++);};p.map=p.collect=function(l,e,h){var p=[];return null==l?p:s&&l.map===s?l.map(e,h):(W(l,function(l,k,t){p.push(e.call(h,l,k,t))}),p)};p.reduce=p.foldl=p.inject=function(l,e,h,k){var t=2<arguments.length;if(null==l&&(l=[]),x&&l.reduce=== x)return k&&(e=p.bind(e,k)),t?l.reduce(e,h):l.reduce(e);if(W(l,function(l,p,s){t?h=e.call(k,h,l,p,s):(h=l,t=!0)}),!t)throw new TypeError("Reduce of empty array with no initial value");return h};p.reduceRight=p.foldr=function(l,e,k,t){var s=2<arguments.length;if(null==l&&(l=[]),h&&l.reduceRight===h)return t&&(e=p.bind(e,t)),s?l.reduceRight(e,k):l.reduceRight(e);var x=l.length;if(x!==+x)var q=p.keys(l),x=q.length;if(W(l,function(h,p,K){p=q?q[--x]:--x;s?k=e.call(t,k,l[p],p,K):(k=l[p],s=!0)}),!s)throw new TypeError("Reduce of empty array with no initial value"); return k};p.find=p.detect=function(l,e,h){var p;return ea(l,function(l,k,t){return e.call(h,l,k,t)?(p=l,!0):void 0}),p};p.filter=p.select=function(l,h,p){var k=[];return null==l?k:e&&l.filter===e?l.filter(h,p):(W(l,function(l,e,t){h.call(p,l,e,t)&&k.push(l)}),k)};p.reject=function(l,e,h){return p.filter(l,function(l,p,k){return!e.call(h,l,p,k)},h)};p.every=p.all=function(l,e,h){e||(e=p.identity);var k=!0;return null==l?k:t&&l.every===t?l.every(e,h):(W(l,function(l,p,t){return(k=k&&e.call(h,l,p,t))? void 0:v}),!!k)};var ea=p.some=p.any=function(l,e,h){e||(e=p.identity);var k=!1;return null==l?k:K&&l.some===K?l.some(e,h):(W(l,function(l,p,t){return k||(k=e.call(h,l,p,t))?v:void 0}),!!k)};p.contains=p.include=function(l,e){return null==l?!1:Q&&l.indexOf===Q?-1!=l.indexOf(e):ea(l,function(l){return l===e})};p.invoke=function(l,e){var h=E.call(arguments,2),k=p.isFunction(e);return p.map(l,function(l){return(k?e:l[e]).apply(l,h)})};p.pluck=function(l,e){return p.map(l,function(l){return l[e]})};p.where= function(l,e,h){return p.isEmpty(e)?h?void 0:[]:p[h?"find":"filter"](l,function(l){for(var h in e)if(e[h]!==l[h])return!1;return!0})};p.findWhere=function(l,e){return p.where(l,e,!0)};p.max=function(l,e,h){if(!e&&p.isArray(l)&&l[0]===+l[0]&&65535>l.length)return Math.max.apply(Math,l);if(!e&&p.isEmpty(l))return-1/0;var k={computed:-1/0,value:-1/0};return W(l,function(l,p,t){p=e?e.call(h,l,p,t):l;p>k.computed&&(k={value:l,computed:p})}),k.value};p.min=function(l,e,h){if(!e&&p.isArray(l)&&l[0]===+l[0]&& 65535>l.length)return Math.min.apply(Math,l);if(!e&&p.isEmpty(l))return 1/0;var k={computed:1/0,value:1/0};return W(l,function(l,p,t){p=e?e.call(h,l,p,t):l;p<k.computed&&(k={value:l,computed:p})}),k.value};p.shuffle=function(l){var e,h=0,k=[];return W(l,function(l){e=p.random(h++);k[h-1]=k[e];k[e]=l}),k};p.sample=function(l,e,h){return 2>arguments.length||h?l[p.random(l.length-1)]:p.shuffle(l).slice(0,Math.max(0,e))};var ta=function(l){return p.isFunction(l)?l:function(e){return e[l]}};p.sortBy=function(l, e,h){var k=ta(e);return p.pluck(p.map(l,function(l,e,p){return{value:l,index:e,criteria:k.call(h,l,e,p)}}).sort(function(l,e){var h=l.criteria,p=e.criteria;if(h!==p){if(h>p||void 0===h)return 1;if(p>h||void 0===p)return-1}return l.index-e.index}),"value")};var na=function(l){return function(e,h,k){var t={},s=null==h?p.identity:ta(h);return W(e,function(h,p){var C=s.call(k,h,p,e);l(t,C,h)}),t}};p.groupBy=na(function(l,e,h){(p.has(l,e)?l[e]:l[e]=[]).push(h)});p.indexBy=na(function(l,e,h){l[e]=h});p.countBy= na(function(l,e){p.has(l,e)?l[e]++:l[e]=1});p.sortedIndex=function(l,e,h,k){h=null==h?p.identity:ta(h);e=h.call(k,e);for(var t=0,s=l.length;s>t;){var x=t+s>>>1;h.call(k,l[x])<e?t=x+1:s=x}return t};p.toArray=function(l){return l?p.isArray(l)?E.call(l):l.length===+l.length?p.map(l,p.identity):p.values(l):[]};p.size=function(l){return null==l?0:l.length===+l.length?l.length:p.keys(l).length};p.first=p.head=p.take=function(l,e,h){return null==l?void 0:null==e||h?l[0]:E.call(l,0,e)};p.initial=function(l, e,h){return E.call(l,0,l.length-(null==e||h?1:e))};p.last=function(l,e,h){return null==l?void 0:null==e||h?l[l.length-1]:E.call(l,Math.max(l.length-e,0))};p.rest=p.tail=p.drop=function(l,e,h){return E.call(l,null==e||h?1:e)};p.compact=function(l){return p.filter(l,p.identity)};var ha=function(l,e,h){return e&&p.every(l,p.isArray)?I.apply(h,l):(W(l,function(l){p.isArray(l)||p.isArguments(l)?e?J.apply(h,l):ha(l,e,h):h.push(l)}),h)};p.flatten=function(l,e){return ha(l,e,[])};p.without=function(l){return p.difference(l, E.call(arguments,1))};p.uniq=p.unique=function(l,e,h,k){p.isFunction(e)&&(k=h,h=e,e=!1);h=h?p.map(l,h,k):l;var t=[],s=[];return W(h,function(h,k){(e?k&&s[s.length-1]===h:p.contains(s,h))||(s.push(h),t.push(l[k]))}),t};p.union=function(){return p.uniq(p.flatten(arguments,!0))};p.intersection=function(l){var e=E.call(arguments,1);return p.filter(p.uniq(l),function(l){return p.every(e,function(e){return 0<=p.indexOf(e,l)})})};p.difference=function(l){var e=I.apply(A,E.call(arguments,1));return p.filter(l, function(l){return!p.contains(e,l)})};p.zip=function(){for(var l=p.max(p.pluck(arguments,"length").concat(0)),e=Array(l),h=0;l>h;h++)e[h]=p.pluck(arguments,""+h);return e};p.object=function(l,e){if(null==l)return{};for(var h={},p=0,k=l.length;k>p;p++)e?h[l[p]]=e[p]:h[l[p][0]]=l[p][1];return h};p.indexOf=function(l,e,h){if(null==l)return-1;var k=0,t=l.length;if(h){if("number"!=typeof h)return k=p.sortedIndex(l,e),l[k]===e?k:-1;k=0>h?Math.max(0,t+h):h}if(Q&&l.indexOf===Q)return l.indexOf(e,h);for(;t> k;k++)if(l[k]===e)return k;return-1};p.lastIndexOf=function(l,e,h){if(null==l)return-1;var p=null!=h;if(da&&l.lastIndexOf===da)return p?l.lastIndexOf(e,h):l.lastIndexOf(e);for(h=p?h:l.length;h--;)if(l[h]===e)return h;return-1};p.range=function(l,e,h){1>=arguments.length&&(e=l||0,l=0);h=arguments[2]||1;for(var p=Math.max(Math.ceil((e-l)/h),0),k=0,t=Array(p);p>k;)t[k++]=l,l+=h;return t};var ua=function(){};p.bind=function(l,e){var h,k;if(la&&l.bind===la)return la.apply(l,E.call(arguments,1));if(!p.isFunction(l))throw new TypeError; return h=E.call(arguments,2),k=function(){if(!(this instanceof k))return l.apply(e,h.concat(E.call(arguments)));ua.prototype=l.prototype;var p=new ua;ua.prototype=null;var t=l.apply(p,h.concat(E.call(arguments)));return Object(t)===t?t:p}};p.partial=function(l){var e=E.call(arguments,1);return function(){return l.apply(this,e.concat(E.call(arguments)))}};p.bindAll=function(l){var e=E.call(arguments,1);if(0===e.length)throw Error("bindAll must be passed function names");return W(e,function(e){l[e]= p.bind(l[e],l)}),l};p.memoize=function(l,e){var h={};return e||(e=p.identity),function(){var k=e.apply(this,arguments);return p.has(h,k)?h[k]:h[k]=l.apply(this,arguments)}};p.delay=function(l,e){var h=E.call(arguments,2);return setTimeout(function(){return l.apply(null,h)},e)};p.defer=function(l){return p.delay.apply(p,[l,1].concat(E.call(arguments,1)))};p.throttle=function(l,e,h){var p,k,t,s=null,x=0;h||(h={});var q=function(){x=!1===h.leading?0:new Date;s=null;t=l.apply(p,k)};return function(){var K= new Date;x||!1!==h.leading||(x=K);var v=e-(K-x);return p=this,k=arguments,0>=v?(clearTimeout(s),s=null,x=K,t=l.apply(p,k)):s||!1===h.trailing||(s=setTimeout(q,v)),t}};p.debounce=function(l,e,h){var p,k,t,s,x;return function(){t=this;k=arguments;s=new Date;var q=function(){var K=new Date-s;e>K?p=setTimeout(q,e-K):(p=null,h||(x=l.apply(t,k)))},K=h&&!p;return p||(p=setTimeout(q,e)),K&&(x=l.apply(t,k)),x}};p.once=function(l){var e,h=!1;return function(){return h?e:(h=!0,e=l.apply(this,arguments),l=null, e)}};p.wrap=function(l,e){return function(){var h=[l];return J.apply(h,arguments),e.apply(this,h)}};p.compose=function(){var l=arguments;return function(){for(var e=arguments,h=l.length-1;0<=h;h--)e=[l[h].apply(this,e)];return e[0]}};p.after=function(l,e){return function(){return 1>--l?e.apply(this,arguments):void 0}};p.keys=pa||function(l){if(l!==Object(l))throw new TypeError("Invalid object");var e=[],h;for(h in l)p.has(l,h)&&e.push(h);return e};p.values=function(l){for(var e=p.keys(l),h=e.length, k=Array(h),t=0;h>t;t++)k[t]=l[e[t]];return k};p.pairs=function(l){for(var e=p.keys(l),h=e.length,k=Array(h),t=0;h>t;t++)k[t]=[e[t],l[e[t]]];return k};p.invert=function(l){for(var e={},h=p.keys(l),k=0,t=h.length;t>k;k++)e[l[h[k]]]=h[k];return e};p.functions=p.methods=function(l){var e=[],h;for(h in l)p.isFunction(l[h])&&e.push(h);return e.sort()};p.extend=function(l){return W(E.call(arguments,1),function(e){if(e)for(var h in e)l[h]=e[h]}),l};p.pick=function(l){var e={},h=I.apply(A,E.call(arguments, 1));return W(h,function(h){h in l&&(e[h]=l[h])}),e};p.omit=function(l){var e={},h=I.apply(A,E.call(arguments,1)),k;for(k in l)p.contains(h,k)||(e[k]=l[k]);return e};p.defaults=function(l){return W(E.call(arguments,1),function(e){if(e)for(var h in e)void 0===l[h]&&(l[h]=e[h])}),l};p.clone=function(l){return p.isObject(l)?p.isArray(l)?l.slice():p.extend({},l):l};p.tap=function(l,e){return e(l),l};var Ba=function(e,h,k,t){if(e===h)return 0!==e||1/e==1/h;if(null==e||null==h)return e===h;e instanceof p&& (e=e._wrapped);h instanceof p&&(h=h._wrapped);var s=O.call(e);if(s!=O.call(h))return!1;switch(s){case "[object String]":return e==String(h);case "[object Number]":return e!=+e?h!=+h:0==e?1/e==1/h:e==+h;case "[object Date]":case "[object Boolean]":return+e==+h;case "[object RegExp]":return e.source==h.source&&e.global==h.global&&e.multiline==h.multiline&&e.ignoreCase==h.ignoreCase}if("object"!=typeof e||"object"!=typeof h)return!1;for(var x=k.length;x--;)if(k[x]==e)return t[x]==h;var x=e.constructor, q=h.constructor;if(x!==q&&!(p.isFunction(x)&&x instanceof x&&p.isFunction(q)&&q instanceof q))return!1;k.push(e);t.push(h);x=0;q=!0;if("[object Array]"==s){if(x=e.length,q=x==h.length)for(;x--&&(q=Ba(e[x],h[x],k,t)););}else{for(var K in e)if(p.has(e,K)&&(x++,!(q=p.has(h,K)&&Ba(e[K],h[K],k,t))))break;if(q){for(K in h)if(p.has(h,K)&&!x--)break;q=!x}}return k.pop(),t.pop(),q};p.isEqual=function(e,h){return Ba(e,h,[],[])};p.isEmpty=function(e){if(null==e)return!0;if(p.isArray(e)||p.isString(e))return 0=== e.length;for(var h in e)if(p.has(e,h))return!1;return!0};p.isElement=function(e){return!(!e||1!==e.nodeType)};p.isArray=F||function(e){return"[object Array]"==O.call(e)};p.isObject=function(e){return e===Object(e)};W("Arguments Function String Number Date RegExp".split(" "),function(e){p["is"+e]=function(h){return O.call(h)=="[object "+e+"]"}});p.isArguments(arguments)||(p.isArguments=function(e){return!(!e||!p.has(e,"callee"))});"function"!=typeof/./&&(p.isFunction=function(e){return"function"== typeof e});p.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};p.isNaN=function(e){return p.isNumber(e)&&e!=+e};p.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==O.call(e)};p.isNull=function(e){return null===e};p.isUndefined=function(e){return void 0===e};p.has=function(e,h){return S.call(e,h)};p.noConflict=function(){return k._=q,this};p.identity=function(e){return e};p.times=function(e,h,p){for(var k=Array(Math.max(0,e)),t=0;e>t;t++)k[t]=h.call(p,t);return k};p.random= function(e,h){return null==h&&(h=e,e=0),e+Math.floor(Math.random()*(h-e+1))};var ja={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};ja.unescape=p.invert(ja.escape);var Na={escape:RegExp("["+p.keys(ja.escape).join("")+"]","g"),unescape:RegExp("("+p.keys(ja.unescape).join("|")+")","g")};p.each(["escape","unescape"],function(e){p[e]=function(h){return null==h?"":(""+h).replace(Na[e],function(h){return ja[e][h]})}});p.result=function(e,h){if(null!=e){var k=e[h];return p.isFunction(k)? k.call(e):k}};p.mixin=function(e){W(p.functions(e),function(h){var k=p[h]=e[h];p.prototype[h]=function(){var e=[this._wrapped];return J.apply(e,arguments),xa.call(this,k.apply(p,e))}})};var Oa=0;p.uniqueId=function(e){var h=++Oa+"";return e?e+h:h};p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var X=/(.)^/,Ca={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},fa=/\\|'|\r|\n|\t|\u2028|\u2029/g;p.template=function(e, h,k){var t;k=p.defaults({},k,p.templateSettings);var s=RegExp([(k.escape||X).source,(k.interpolate||X).source,(k.evaluate||X).source].join("|")+"|$","g"),x=0,q="__p+='";e.replace(s,function(h,p,k,t,s){return q+=e.slice(x,s).replace(fa,function(e){return"\\"+Ca[e]}),p&&(q+="'+\n((__t=("+p+"))==null?'':_.escape(__t))+\n'"),k&&(q+="'+\n((__t=("+k+"))==null?'':__t)+\n'"),t&&(q+="';\n"+t+"\n__p+='"),x=s+h.length,h});q+="';\n";k.variable||(q="with(obj||{}){\n"+q+"}\n");q="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+ q+"return __p;\n";try{t=new Function(k.variable||"obj","_",q)}catch(K){throw K.source=q,K;}if(h)return t(h,p);h=function(e){return t.call(this,e,p)};return h.source="function("+(k.variable||"obj")+"){\n"+q+"}",h};p.chain=function(e){return p(e).chain()};var xa=function(e){return this._chain?p(e).chain():e};p.mixin(p);W("pop push reverse shift sort splice unshift".split(" "),function(e){var h=A[e];p.prototype[e]=function(){var p=this._wrapped;return h.apply(p,arguments),"shift"!=e&&"splice"!=e||0!== p.length||delete p[0],xa.call(this,p)}});W(["concat","join","slice"],function(e){var h=A[e];p.prototype[e]=function(){return xa.call(this,h.apply(this._wrapped,arguments))}});p.extend(p.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);shmotg=function(){return{MAX_NUMBER_OF_BIN_LEVELS:46,MAX_NUMBER_OF_ITEMS_PER_ARRAY:32,TIME_CONTEXT_VERTICAL_EACH:25}}(); (function(){var k=function(){return d3.interpolateString("rotate(0)","rotate(360)")};loader=function(){function q(k){O=k;k.each(function(h,e){var k=d3.select(this);S=S?S:k.append("svg").attr("width",J).attr("height",E);k=Math.min(J,E)/2;k=d3.svg.arc().innerRadius(k*A).outerRadius(k*F).startAngle(0);z=S.append("g").attr("transform","translate("+J/2+","+E/2+")").append("path").datum({endAngle:0.33*v}).style("fill","#4D4D4D").attr("d",k).call(s,1500)});d3.timer.flush()}var v=2*Math.PI,A=0.5,F=0.9,J= 25,E=25,I=!0,O,S,z,s=function(x,h){I&&(x.transition().ease("linear").duration(h).attrTween("transform",k),setTimeout(s,h,x,h))};q.width=function(k){if(!arguments.length)return J;J=k;return q};q.height=function(k){if(!arguments.length)return E;E=k;return q};q.update=function(){q(O)};q.isShowing=function(k){if(!arguments.length)return I;k&&!I&&(I=!0,s(z,1500));I=k;return q};return q}})(); msToCentury=function(){function k(h){var e=new Date;e.setTime(h);return e}function q(h){var e=new Date;e.setTime(A(h,z.ms));return e}function v(h,e){return Math.ceil(h/e)*e}function A(h,e){return Math.floor(h/e)*e}function F(h){var e=h.getMonth();h=1<=(e+1)/12?h.getFullYear()+1:h.getFullYear();e=new Date(h,(e+1)%12,1,1,1,1,1);e=k(e.getTime()-4E6);return e.getDate()}function J(h,e){for(var k=function(e){return e<h[1]&&e>h[0]},s=0;s<x.length;s++){var q=x[s];if(h[1]-h[0]<=q[0]*q[1]*e/S)return q=I(h[0], h[1],q[1],q[3],q[2],q[0]*q[1],e),q=_.filter(q,k),s}return-1}function E(h,e){var k=h.domain(),k=J(k,e);if(-1===k)return 0;k=x[k][1];return k/s[k]}function I(h,e,t,s,q,x,z){return s===d3.time.year?(h=d3.time.year.floor(k(h)),e=d3.time.year.ceil(k(e)),e=d3.range(h.getFullYear(),e.getFullYear()),e=_.filter(e,function(e){return 0===e%t}),e=_.map(e,function(e){return(new Date(e,0)).getTime()})):s===d3.time.month?(h=d3.time.year.floor(k(h)),e=d3.time.year.ceil(k(e)),e=d3.range(h.getFullYear(),e.getFullYear()), e=_.map(e,function(e){return _.map([0,1,2,3,4,5,6,7,8,9,10,11],function(h){return(new Date(e,h)).getTime()})}),e=_.flatten(e),e=_.filter(e,function(e,h){return 0===h%t})):q===d3.time.month?(h=d3.time.year.floor(k(h)),e=d3.time.year.ceil(k(e)),e=d3.range(h.getFullYear(),e.getFullYear()),e=_.map(e,function(e){return _.map([0,1,2,3,4,5,6,7,8,9,10,11],function(h){var k=F(new Date(e,h));return _.map(d3.range(1,k+1),function(s){return 0===(s-1)%t&&k+1-s>=t?(new Date(e,h,s)).getTime():[]})})}),e=_.flatten(e)): d3.range(q.floor(k(h)).getTime(),q.ceil(k(e)).getTime(),v(x*S/z,x))}var O={},S=100,z={ms:1,s:1E3,m:6E4,h:36E5,d:864E5,mo:2592E6,y:31536E6};O.times=z;O.NumberOfDaysInYear=function(h){var e=new Date(h.getFullYear(),0,0);h=(new Date(h.getFullYear()+1,0,0)).getTime()-e.getTime();return Math.floor(h/864E5)};O.TickFormat=function(h){return function(e){return function(h){var k=new Date;k.setTime(h);h=e.length-1;for(var s=e[h];!s[1](k);)s=e[--h];return s[0](k)}}([[d3.time.format("%Y"),function(){return!0}], [d3.time.format("%b"),function(e){return e.getMonth()}],[function(e){return d3.time.format("%a %-d")(e).toLowerCase()},function(e){return 1!=e.getDate()}],[d3.time.format("%H:00"),function(e){return e.getHours()}],[d3.time.format("%H:%M"),function(e){return e.getMinutes()}],[d3.time.format("%Ss"),function(e){return e.getSeconds()}],[d3.time.format("%Lms"),function(e){return e.getMilliseconds()}]])(h)};O.TickValues=function(h,e){var k=h.domain(),s=J(k,e);if(-1===s)return[1,10,100,1E3,1E4,1E5,1E6,1E7, 1E8,1E9,1E10,1E11,1E12,1E13,1E14];s=x[s];s=I(k[0],k[1],s[1],s[3],s[2],s[0]*s[1],e);return _.filter(s,function(e){return e<k[1]&&e>k[0]})};O.SubTickValues=function(h,e){var k=h.domain(),s=J(k,e);if(-1===s)return[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8,1E9,1E10,1E11,1E12,1E13,1E14];for(var q=x[s],s=I(k[0],k[1],q[1],q[3],q[2],q[0]*q[1],e),v=[],z=E(h,e),A=d3.range(1,z),q=q[0]*q[1],p=0;p<A.length;p++)v.push(s[0]-q/z*A[p]);for(p=0;p<s.length;p++)for(var F=0;F<A.length;F++)v.push(s[p]+q/z*A[F]);return _.filter(v, function(e){return e<k[1]&&e>k[0]})};var s={1:0.5,2:1,3:1,5:1,6:3,10:5,12:3,15:5,20:5,25:5,30:10,50:10,100:50,200:50,500:100},x=[[z.ms,1,d3.time.second,q],[z.ms,2,d3.time.second,q],[z.ms,5,d3.time.second,q],[z.ms,10,d3.time.second,q],[z.ms,20,d3.time.second,q],[z.ms,50,d3.time.second,q],[z.ms,100,d3.time.second,q],[z.ms,200,d3.time.second,q],[z.ms,500,d3.time.second,q],[z.s,1,d3.time.minute,d3.time.second],[z.s,2,d3.time.minute,d3.time.second],[z.s,5,d3.time.minute,d3.time.second],[z.s,15,d3.time.minute, d3.time.second],[z.s,30,d3.time.minute,d3.time.second],[z.m,1,d3.time.hour,d3.time.minute],[z.m,2,d3.time.hour,d3.time.minute],[z.m,5,d3.time.hour,d3.time.minute],[z.m,15,d3.time.hour,d3.time.minute],[z.m,30,d3.time.hour,d3.time.minute],[z.h,1,d3.time.day,d3.time.hour],[z.h,3,d3.time.day,d3.time.hour],[z.h,6,d3.time.day,d3.time.hour],[z.h,12,d3.time.day,d3.time.hour],[z.d,1,d3.time.month,d3.time.day],[z.d,2,d3.time.month,d3.time.day],[z.d,5,d3.time.month,d3.time.day],[z.d,10,d3.time.month,d3.time.day], [z.d,15,d3.time.month,d3.time.day],[z.mo,1,d3.time.year,d3.time.month],[z.mo,2,d3.time.year,d3.time.month],[z.mo,3,d3.time.year,d3.time.month],[z.mo,6,d3.time.year,d3.time.month],[z.mo,12,d3.time.year,d3.time.month],[z.y,1,d3.time.year,d3.time.year],[z.y,2,d3.time.year,d3.time.year],[z.y,5,d3.time.year,d3.time.year],[z.y,10,d3.time.year,d3.time.year],[z.y,25,d3.time.year,d3.time.year],[z.y,50,d3.time.year,d3.time.year],[z.y,100,d3.time.year,d3.time.year],[z.y,100,d3.time.year,d3.time.year]];return O}(); binnedData=function(){function k(h){return Math.pow(2,h)*z}function q(h,e){for(var k=[],s=h.length,q=0,x=0;x<e.length;x++)for(;;){if(q>=s){k.push(e[x]);break}if(h[q].ms>e[x].ms){k.push(e[x]);break}else if(h[q].ms===e[x].ms){isNaN(h[q].val)&&(h[q].val=e[x].val);break}else q++}return h.concat(k)}function v(h,e){var t=k(e)*shmotg.MAX_NUMBER_OF_ITEMS_PER_ARRAY;return Math.floor(h/t)*t}function A(h,e,k){var s=x.binContainerSize(k);h=v(h,k);return _.range(h,e,s)}function F(h,e){return _.groupBy(h,function(h){return v(h.ms, e)})}function J(h,e){for(var t=e+1;t<shmotg.MAX_NUMBER_OF_BIN_LEVELS;t++)for(var q=0;q<s.keys.length;q++){var v=s.keys[q],A,J=s;A=t-1;var I=v,p=s[v].func,F=h,O=[];if(J[0===A?"rawData":I].levels[A]){var S=E(J,A,I,F),na=[];"q1"===I?na=E(J,A,"q3",F):"q3"===I&&(na=E(J,A,"q1",F));for(J=0;J<S.length;J+=2){var F=0===S[J].ms%(Math.pow(2,A+1)*z),ha=S.length>J+1,ua=ha?S[J+1].ms-S[J].ms===k(A):!0;F&&ha&&ua?S[J+1]&&(F=S[J].ms,"q1"===I||"q3"===I?O.push({val:p(S[J].val,S[J+1].val,na[J].val,na[J+1].val),ms:F}): O.push({val:p(S[J].val,S[J+1].val),ms:F})):J-=1}}A=O;0!==A.length&&x.addData(A,v,t)}}function E(h,e,k,s){s=[v(s[0],e+1),v(s[1],e+1)+x.binContainerSize(e+1)];if(!s[0]||!s[1])return[];s=A(s[0],s[1],e);var q=[],z;for(z in s)h[0===e?"rawData":k].levels[e][s[z]]&&(q=q.concat(h[0===e?"rawData":k].levels[e][s[z]]));return q}function I(h){return d3.sum(h)/h.length}function O(h,e){var k=q(h,e);k.sort(function(e,h){return e.ms-h.ms});return k}function S(h,e){return _.filter(h,function(h){return!_.contains(e, h)})}var z=5,s={keys:["average","maxes","mins","q1","q3"],rawData:{levels:[]},average:{func:function(h,e){return(h+e)/2},levels:[]},maxes:{func:function(h,e){return d3.max([h,e])},levels:[]},mins:{func:function(h,e){return d3.min([h,e])},levels:[]},q1:{func:function(h,e,k,s){e=[h,e,k,s].slice();h=d3.min(e);e.splice(e.indexOf(h),1);e=d3.min(e);return I([h,e])},levels:[]},q3:{func:function(h,e,k,s){e=[h,e,k,s].slice();h=d3.max(e);e.splice(e.indexOf(h),1);e=d3.max(e);return I([h,e])},levels:[]},quartiles:{levels:[]}, missing:{levels:[]},missingBox:{levels:[]},loadingBox:{levels:[]}},x=function(){};x.addData=function(h,e,k){h=F(h,k);for(var q in h)h.hasOwnProperty(q)&&(s[e].levels[k]||(s[e].levels[k]={}),s[e].levels[k][q]||(s[e].levels[k][q]=[]),s[e].levels[k][q]=O(s[e].levels[k][q],h[q]))};x.addRawData=function(h,e){var k=d3.extent(h,function(e){return e.ms});x.addData(h,"rawData",0);e||J(k,0);return x};x.replaceRawData=function(h,e){var k=d3.extent(h,function(e){return e.ms});s.rawData.levels[0]||(s.rawData.levels[0]= []);s.rawData.levels[0]=h;e||J(k,0);return x};x.addBinnedData=function(h,e,k){for(var q=[],v=[],z=["average","q1","q3","mins","maxes"],A=function(e){return e.ms},E=0;E<z.length;E++)if(h[z[E]]&&h[z[E]].levels&&h[z[E]].levels[e]){var p=d3.extent(h[z[E]].levels[e],A);q.push(p[0]);v.push(p[1])}q=[d3.min(q),d3.max(v)];for(v=0;v<s.keys.length;v++)z=s.keys[v],x.addData(h[z].levels[e],z,e);k||J(q,e);return x};x.replaceBinnedData=function(h,e,k){for(var q=d3.extent(h.average.levels[e],function(e){return e.ms}), v=0;v<s.keys.length;v++){var z=s.keys[v];s[z].levels[e]||(s[z].levels[e]=[]);h[z].levels&&(s[z].levels[e]=h[z].levels[e])}k||J(q,0);return x};x.replaceAllData=function(h){s=h};x.haveDataInRange=function(h,e){var s=x.getDateRange([0===e?"rawData":"average"],e,h);if(0===s.length)return!1;var q=s[0].ms;if(q>h[0]+k(e))return!1;q=Math.floor((h[1]-q)/k(e));return s.length>=q};x.missingBins=function(h,e,s){var q;q=0===e?"rawData":"average";var v=Math.floor(h[0]/(Math.pow(2,e)*z)),A=Math.floor(h[1]/(Math.pow(2, e)*z)),v=[v*Math.pow(2,e)*z,(A+1)*Math.pow(2,e)*z];q=x.getDateRange([q],e,v);if(0===q.length)return s?[h[0]]:[h];h=_.range(v[0],v[1],k(e));h.forEach(function(h){Math.pow(2,e)});h=S(h,_.pluck(q,"ms"));h.total=q.length;if(s)return h;var E=[];_.each(h,function(h){E.push([h,h+k(e)])});return E};x.getExtentsForLvlKeysRange=function(h,e,k){return d3.extent(x.getDateRange(e,h,k),function(e){return e.val})};x.getMin=function(h){for(var e=999999,k="",q=function(e){return e.val},k=0===h?"rawData":"average", x=0;x<s[k].levels[h].length;x++)e=Math.min(d3.min(s[k].levels[h][x],q),e);return e};x.getMax=function(h){for(var e=-999999,k="",q=function(e){return e.val},k=0===h?"rawData":"average",x=0;x<s[k].levels[h].length;x++)e=Math.max(d3.max(s[k].levels[h][x],q),e);return e};x.getMinMS=function(h){var e="",e=0===h?"rawData":"average",k=Object.keys(s[e].levels[h]);return d3.min(s[e].levels[h][Math.min.apply(null,k)],function(e){return e.ms})};x.getMaxMS=function(h){var e="",e=0===h?"rawData":"average",k=Object.keys(s[e].levels[h]); return d3.max(s[e].levels[h][Math.max.apply(null,k)],function(e){return e.ms})};x.getColor=function(h){return s[h].color};x.getDash=function(h){return s[h].dash};x.getOpacity=function(h){return s[h].opacity};x.getAllInRange=function(h,e){for(var k=["average","q1","q3","mins","maxes"],s={},q=0;q<k.length;q++)s[k[q]]={},s[k[q]].levels=[],s[k[q]].levels[h]=x.getDateRange([k[q]],h,e);return s};x.getDateRangeWithMissingValues=function(h,e,k,s){var q=x.missingBins(k,e,!0),v=x.binSize(e),q=q.map(function(e){return{ms:e, val:NaN}});h=O(q,x.getDateRange([h],e,[k[0]-v,k[1]+v]));if(s)for(s=h.length,e=1;e<s;e++)isNaN(h[e].val)&&(h.splice(e,0,{ms:h[e].ms,val:h[e-1].val}),e++,s++);return h};x.getDateRange=function(h,e,k){for(var q=[],x=function(h){s[0===e?"rawData":E]&&s[0===e?"rawData":E].levels[e]&&(q=q.concat(_.filter(s[0===e?"rawData":E].levels[e][h],function(e){return e.ms<=k[1]&&e.ms>=k[0]})))},v=A(k[0],k[1],e),z=0;z<h.length;z++){var E=h[z];_.each(v,x)}return q=q.sort(function(e,h){return e.ms-h.ms})};x.removeAllLevelsBelow= function(h){for(var e=0;e<h;e++)for(var k=0;k<s.keys.length;k++)s[s.keys[k]].levels[e]={};0<h&&(s.rawData.levels[0]={})};x.importDataFromAnotherBinnedDataObject=function(h){for(var e=0;e<h.keys.length;e++)for(var k=h.keys[e],x=0;x<shmotg.MAX_NUMBER_OF_BIN_LEVELS;x++)if(h[k].levels[x])for(var v=0;v<h[k].levels[x].length;v++)s[k].levels[x]||(s[k].levels[x]={}),s[k].levels[x].hasOwnProperty(v)?s[k].levels[x][v]=q(s[k].levels[x][v],h[k].levels[x][v]):s[k].levels[x][v]=h[k].levels[x][v]};x.doToEachContainerInRange= function(h,e,k){A(h[0],h[1],e).forEach(function(e){k(e)})};x.binSize=function(h){return Math.pow(2,h)*z};x.oneSample=function(h){if(!arguments.length)return z;z=h;return x};x.binContainerSize=function(h){return x.binSize(h)*shmotg.MAX_NUMBER_OF_ITEMS_PER_ARRAY};x.getSurroundingBinContainers=function(h,e,k){return A(h,e,k)};x.getSurroundingBins=function(h,e,k){var s=Math.pow(2,k)*z;h=v(h,k);return _.range(h,e,s)};x.getBinContainerForMSAtLevel=function(h,e){return v(h,e)};x.getKeys=function(){return s.keys.slice(0)}; x.bd=function(){return s};x.combineAndSortArraysOfDateValObjects=function(h,e){return O(h,e)};x.getChildBins=function(h,e){var k=[h],s=x.binSize(e-1);0===h%(Math.pow(2,e)*z)?k.push(h+s):k.push(h-s);return k};x.toString=function(){return JSON.stringify(s)};x.rebinAll=function(h,e){J(h,e)};return x}; multiData=function(k){function q(k){return Math.pow(2,k)*O}function v(k,q){for(var h=[],e=k.length,t=0,v=0;v<q.length;v++)for(;;){if(t>=e){h.push(q[v]);break}if(k[t].ms>q[v].ms){h.push(q[v]);break}else if(k[t].ms===q[v].ms){isNaN(k[t].val)&&(k[t].val=q[v].val);break}else t++}return k.concat(h)}function A(k,x){var h=q(x)*shmotg.MAX_NUMBER_OF_ITEMS_PER_ARRAY;return Math.floor(k/h)*h}function F(k,q,h){var e=z.binContainerSize(h);k=A(k,h);return _.range(k,q,e)}function J(k,q){return _.groupBy(k,function(h){return A(h.ms, q)})}function E(k,q){var h=v(k,q);h.sort(function(e,h){return e.ms-h.ms});return h}function I(k,q){return _.filter(k,function(h){return!_.contains(q,h)})}var O=5,S=[],z=function(){};z.addData=function(k,q,h){k=J(k,h);for(var e in k)k.hasOwnProperty(e)&&(bd[q].levels[h]||(bd[q].levels[h]={}),bd[q].levels[h][e]||(bd[q].levels[h][e]=[]),bd[q].levels[h][e]=E(bd[q].levels[h][e],k[e]))};z.addRawData=function(k,q){return z};z.replaceRawData=function(k,q){d3.extent(k,function(h){return h.ms});bd.rawData.levels[0]|| (bd.rawData.levels[0]=[]);bd.rawData.levels[0]=k;return z};z.addBinnedData=function(k,q,h){return z};z.replaceBinnedData=function(k,q,h){d3.extent(k.average.levels[q],function(e){return e.ms});for(h=0;h<bd.keys.length;h++){var e=bd.keys[h];bd[e].levels[q]||(bd[e].levels[q]=[]);k[e].levels&&(bd[e].levels[q]=k[e].levels[q])}return z};z.replaceAllData=function(k){bd=k};z.haveDataInRange=function(k,x,h){h=z.getDateRange([0===x?"rawData":"average"],x,k,h);if(0===h.length)return!1;var e=h[0].ms;if(e>k[0]+ q(x))return!1;k=Math.floor((k[1]-e)/q(x));return h.length>=k};z.missingBins=function(k,x,h){var e;e=0===x?"rawData":"average";var t=Math.floor(k[0]/(Math.pow(2,x)*O)),v=Math.floor(k[1]/(Math.pow(2,x)*O)),t=[t*Math.pow(2,x)*O,(v+1)*Math.pow(2,x)*O];e=z.getDateRange([e],x,t);if(0===e.length)return h?[k[0]]:[k];k=_.range(t[0],t[1],q(x));k.forEach(function(e){Math.pow(2,x)});k=I(k,_.pluck(e,"ms"));k.total=e.length;if(h)return k;var A=[];_.each(k,function(e){A.push([e,e+q(x)])});return A};z.getMin=function(k){for(var q= 999999,h="",e=function(e){return e.val},h=0===k?"rawData":"average",t=0;t<bd[h].levels[k].length;t++)q=Math.min(d3.min(bd[h].levels[k][t],e),q);return q};z.getMax=function(k){for(var q=-999999,h="",e=function(e){return e.val},h=0===k?"rawData":"average",t=0;t<bd[h].levels[k].length;t++)q=Math.max(d3.max(bd[h].levels[k][t],e),q);return q};z.getMinMS=function(k){var q="",q=0===k?"rawData":"average",h=Object.keys(bd[q].levels[k]);return d3.min(bd[q].levels[k][Math.min.apply(null,h)],function(e){return e.ms})}; z.getMaxMS=function(k){var q="",q=0===k?"rawData":"average",h=Object.keys(bd[q].levels[k]);return d3.max(bd[q].levels[k][Math.max.apply(null,h)],function(e){return e.ms})};z.getColor=function(k){return S[0].bd()[k].color};z.getDash=function(k){return S[0].bd()[k].dash};z.getOpacity=function(k){return S[0].bd()[k].opacity};z.getAllInRange=function(k,q){for(var h=["average","q1","q3","mins","maxes"],e={},t=0;t<h.length;t++)e[h[t]]={},e[h[t]].levels=[],e[h[t]].levels[k]=z.getDateRange([h[t]],k,q);return e}; z.getDateRangeWithMissingValues=function(k,q,h,e,t){var v=[];_.each(S,function(A){v.push(z.normalizeArrayToDomainOfKeys(A,A.getDateRangeWithMissingValues(k,q,h,e),t,h,q))});return z.multiplyArraysOfDateValObjects(v)};z.normalizeArrayToDomainOfKeys=function(k,q,h,e,t){k=k.getExtentsForLvlKeysRange(t,h,e);return z.normalizeArrayOfMSValues(q,k)};z.normalizeArrayOfMSValues=function(k,q){var h=d3.scale.linear().range([1E-4,1]);q?h.domain(q):h.domain(d3.extent(k,function(e){return e.val}));return _.map(k, function(e){return{ms:e.ms,val:h(e.val)}})};z.multiplyArraysOfDateValObjects=function(q){var x=[];_.each(q,function(e){x=_.union(x,_.pluck(e,"ms"))});var x=x.sort(function(e,h){return e-h}),h=[];_.each(x,function(e){var t=[];_.each(q,function(h){h=_.find(h,function(h){return h.ms===e});void 0===h||isNaN(h.ms)?t.push(null):t.push(h.val)});if(!_.contains(t,null)){var x=d3.scale.linear().domain([-1,1]).range([0,1]);h.push({ms:e,val:_.reduce(t,function(e,h){return k?e*h:x(e-h)},1)})}});return h};z.getDateRange= function(k,q,h,e){var t=[];_.each(S,function(v){t.push(z.normalizeArrayToDomainOfKeys(v,v.getDateRange(k,q,h),e,h,q))});return z.multiplyArraysOfDateValObjects(t)};z.removeAllLevelsBelow=function(k){for(var q=0;q<k;q++)for(var h=0;h<bd.keys.length;h++)bd[bd.keys[h]].levels[q]={};0<k&&(bd.rawData.levels[0]={})};z.importDataFromAnotherBinnedDataObject=function(k){for(var q=0;q<k.keys.length;q++)for(var h=k.keys[q],e=0;e<shmotg.MAX_NUMBER_OF_BIN_LEVELS;e++)if(k[h].levels[e])for(var t=0;t<k[h].levels[e].length;t++)bd[h].levels[e]|| (bd[h].levels[e]={}),bd[h].levels[e].hasOwnProperty(t)?bd[h].levels[e][t]=v(bd[h].levels[e][t],k[h].levels[e][t]):bd[h].levels[e][t]=k[h].levels[e][t]};z.doToEachContainerInRange=function(k,q,h){F(k[0],k[1],q).forEach(function(e){h(e)})};z.binSize=function(k){return Math.pow(2,k)*O};z.oneSample=function(k){if(!arguments.length)return O;O=k;return z};z.binContainerSize=function(k){return z.binSize(k)*shmotg.MAX_NUMBER_OF_ITEMS_PER_ARRAY};z.getSurroundingBinContainers=function(k,q,h){return F(k,q,h)}; z.getSurroundingBins=function(k,q,h){var e=Math.pow(2,h)*O;k=A(k,h);return _.range(k,q,e)};z.getBinContainerForMSAtLevel=function(k,q){return A(k,q)};z.getKeys=function(){return S[0].bd().keys.slice(0)};z.bd=function(){return bd};z.combineAndSortArraysOfDateValObjects=function(k,q){return E(k,q)};z.getChildBins=function(k,q){var h=[k],e=z.binSize(q-1);0===k%(Math.pow(2,q)*O)?h.push(k+e):h.push(k-e);return h};z.toString=function(){return JSON.stringify(bd)};z.rebinAll=function(k,q){};z.addParentData= function(k){S.push(k)};return z}; (function(){slider=function(){function k(){var e=Math.floor((da+v/2-pa)/v);O(d3.transform(z.attr("transform")).translate[1],e,ha);la!==e&&d3.selectAll(".slider_boxes").classed("highlighted",function(h,l){return l==e});la=e}function q(q,C){S=q;ha=C;q.each(function(q,w){var C=d3.select(this);h=h?h:C.append("svg");h.attr("width",A).attr("height",F);ja&&(e=e?e:h.insert("defs").append("clipPath").attr("id","clip"+E).append("rect"),e.attr("width",v).attr("transform","translate("+I+", 0)").attr("height", F));ja&&(z=z?z:h.append("g").attr("id","slide_container"+E).attr("clip-path","url(#clip"+E+")").append("g").attr("id","slide_region"+E).attr("class","slide_region"),slide_dat_applied=z.selectAll("g").data(d3.range(J)),slide_enter=slide_dat_applied.enter().append("g"),slide_enter.append("path").attr("d",fa).on("mouseover",Na).on("mouseout",Oa).on("mousedown",X).on("click",Ca).attr("class","slider_boxes"),slide_enter.append("text").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("x", function(e){return I+v/2}).attr("y",function(e,h){return(h+1)*v-v/2}).text(function(e,h){return h}).attr("class","slider_text"),slide_dat_applied.exit().remove());if(ja){p=p?p:h.append("g").attr("id","surrounding_lines"+E);var C=[{x:0,y:0},{x:v+2*I,y:0}],O=[{x:0,y:F},{x:v+2*I,y:F}],S=[{x:I,y:0},{x:I,y:F}],ba=[{x:v+I,y:0},{x:v+I,y:F}];t=t?t:d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear");na=na?na:p.append("path").attr("class","slider_outlines");na.attr("d", t(C));W=W?W:p.append("path").attr("class","slider_outlines");W.attr("d",t(O));ea=ea?ea:p.append("path").attr("class","slider_outlines");ea.attr("d",t(S));ta=ta?ta:p.append("path").attr("class","slider_outlines");ta.attr("d",t(ba))}s=s?s:h.append("g").attr("id","handle_region"+E).attr("class","handle_region");s.attr("transform","translate(0,"+da+")");C=Math.max(0,v/2);O=Math.min(F,v/2);S=v/2;K=K?K:s.append("clipPath").attr("id","clip-handle"+E).append("path").attr("d",xa(C,O,S));Q=Q?Q:s.append("path").attr("d", xa(C,O,S)).attr("id","handle"+E).attr("clip-path","url(#clip-handle"+E+")").attr("class","handle");x=x?x:s.append("g").attr("id","dragLines"+E);x.selectAll("path").data([0,1,2]).enter().append("path").attr("d",l).attr("class","dragLines").attr("transform","translate("+(I+v+S)+",0)");ja&&(z.call(ua),s.call(Ba));ha&&k();ja=!1});d3.timer.flush()}var v=30,A=90,F=140,J=12,E="_id",I=0,O=function(){},S,z,s,x,h,e,t,K,Q,da=0,pa=0,la=-1,p,W,ea,ta,na,ha,ua=d3.behavior.drag().origin(Object).on("drag",function(){var e= d3.event.dy,h=z,l=d3.transform(h.attr("transform")).translate,p=l[0],e=Math.max(-J*v+F,Math.min(0,l[1]+e));h.attr("transform","translate("+p+","+e+")");k()}),Ba=d3.behavior.drag().origin(Object).on("drag",function(e){var h=d3.event.dy;e=s;var l=d3.transform(e.attr("transform")).translate,p=l[0];da=h=Math.min(F-v,Math.max(0,l[1]+h));e.attr("transform","translate("+p+","+h+")");k()}),ja=!0,Na=function(){d3.select(this).classed("hover",!0);d3.select(this).classed("mousedown",!1)},Oa=function(){d3.select(this).classed("hover", !1);d3.select(this).classed("mousedown",!1)},X=function(e){d3.select(this).classed("hover",!1);d3.select(this).classed("mousedown",!0);e.preventDefault&&e.preventDefault();e.returnValue=!1},Ca=function(){d3.event.defaultPrevented||(d3.select(this).classed("hover",!1),d3.select(this).classed("mousedown",!1),q.handlePosition(this.__data__*v+pa).update(!0))},fa=function(e,h){dat=[{x:I+v,y:h*v},{x:I,y:h*v},{x:I,y:(h+1)*v},{x:I+v,y:(h+1)*v}];return d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear")(dat)}, xa=function(e,h,l){dat=[{x:v+I,y:e},{x:v+I+l,y:0},{x:v+I+l+v,y:0},{x:v+I+l+v,y:0+v},{x:v+I+l,y:0+v},{x:v+I,y:h}];return function(){return d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear")(dat)}},l=function(e,h){dat=[{x:1/3*v,y:(h+2)/6*v},{x:2/3*v,y:(h+2)/6*v}];return d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear")(dat)};q.width=function(e){if(!arguments.length)return A;A=e;return q};q.height=function(e){if(!arguments.length)return F; F=e;return q};q.boxSize=function(e){if(!arguments.length)return v;v=e;return q};q.numberOfLevels=function(e){if(!arguments.length)return J;J=e;return q};q.changeCallBack=function(e){if(!arguments.length)return O;O=e;return q};q.pastExtents=function(e){return e<F-v*J?!0:0<e?!0:!1};q.scrollPosition=function(e){if(!arguments.length)return pa;if(e===pa)return q;pa=Math.min(0,Math.max(F-v*J,e));var h=d3.select("#slide_region"+E),l=d3.transform(h.attr("transform")).translate[0];h.attr("transform","translate("+ l+","+pa+")");return q};q.handlePosition=function(e){if(!arguments.length)return da;da=Math.max(0,Math.min(F-v,e));return q};q.highlightSliderElement=function(){k()};q.update=function(e){e&&q(S,!0);q(S)};return q}})();String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}; var justItself=function(k){return k},justValue=function(k){return k.value},justval=function(k){return k.val},notNaNVal=function(k){return!isNaN(k.val)},notNaNValFirst=function(k){return notNaNVal(k[0])},isNaNVal=function(k){return isNaN(k.val)};function addBValuesToA(k,q){var v,A=q.length;for(v=0;v<A;v+=1)k.push(q[v])} var msDifference=function(k,q){return k.ms-q.ms},generateLoadingBoxArray=function(k,q,v,A){v=A.getDateRangeWithMissingValues("average",k,q,!1,v);var F=[],J=0,E=[];1>=v.length?(E.push({val:NaN,ms:q[0]}),E.push({val:NaN,ms:q[1]})):E=_.map(v,function(q){var v={};v.val=q.val;v.ms=q.ms;isNaN(v.val)&&(q=A.binSize(k),A.getChildBins(v.ms,k),F.push({val:v.val,ms:v.ms+q-1}));J++;return v});E.sort(msDifference);return E=A.combineAndSortArraysOfDateValObjects(E,F)},generateMissingArray=function(k,q,v,A){var F= A.getDateRangeWithMissingValues("average",k,q,!1,v),J=[],E=0,I=_.map(F,function(q){tmp={};tmp.val=q.val;tmp.ms=q.ms;if(isNaN(tmp.val)){q=A.binSize(k);var x=A.getChildBins(tmp.ms,k);tmp.val=averageOfRange(A.getDateRangeWithMissingValues("average",k-1,x,!1,v));F[E-1]&&!isNaN(F[E-1].val)&&J.push({val:F[E-1].val,ms:F[E-1].ms});F[E+1]&&!isNaN(F[E+1].val)?J.push({val:F[E+1].val,ms:F[E+1].ms}):J.push({val:tmp.val,ms:tmp.ms+q-1})}E++;return tmp});I.sort(msDifference);var I=A.combineAndSortArraysOfDateValObjects(I, J),O=[],S=0,z=[];1>=F.length?(z.push({val:NaN,ms:q[0]}),z.push({val:NaN,ms:q[1]})):z=_.map(F,function(q){tmp={};tmp.val=q.val;tmp.ms=q.ms;isNaN(tmp.val)&&(q=A.binSize(k),A.getChildBins(tmp.ms,k),O.push({val:tmp.val,ms:tmp.ms+q-1}));S++;return tmp});z.sort(msDifference);z=A.combineAndSortArraysOfDateValObjects(z,O);return[I,z]},averageOfRange=function(k){for(var q=0,v=0,A=0;A<k.length;A++)isNaN(k[A].val)||(q+=k[A].val,v++);return 0===v?NaN:q/v},isWithinRange=function(k,q){return k[0]>=q[0]&&k[1]<= q[1]};function getScaleValue(k){return(k.range()[1]-k.range()[0])/(k.domain()[1]-k.domain()[0])}function transformScale(k,q,v){getScaleValue(k);var A=getScaleValue(k);k=v.left+A*(q.domain()[0]-k.domain()[0]);v=v.top;q=A/getScaleValue(q);return"translate("+k+","+v+")scale("+q+",1)"}function generateKey(k){return k.key+k.which+k.interpolate} function drawElements(k,q,v,A,F,J,E,I,O,S,z,s,x,h,e,t,K,Q){k=q.selectAll("."+K+v).data(k,generateKey);I?k.attr("transform",transformScale(O,e,h)).attr("d",function(e,h){return s[e.key]}).transition().ease(S).duration(z).attr("transform",transformScale(E,e,h)):k.attr("opacity",function(e){return x.getOpacity(e.key)}).attr("d",function(e,h){return s[e.key]?s[e.key]:"M -1000 -1000 L -1000 -1000"}).attr("transform",transformScale(E,e,h));k.enter().append("path").attr("class",function(e){return K+v+" "+ e.key}).attr("d",function(e,h){return s[e.key]});I?k.attr("transform",transformScale(O,e,h)).attr("opacity",0).transition().ease(S).duration(z).attr("transform",transformScale(E,e,h)).attr("opacity",function(e){return x.getOpacity(e.key)}):k.attr("transform",transformScale(E,e,h)).attr("opacity",function(e){return x.getOpacity(e.key)});k=I?k.exit().transition().ease(S).duration(z):k.exit();k.attr("transform",transformScale(E,O,h)).attr("opacity",0).remove()} function maxBinRenderSize(){return document.getElementById("renderdepth").value} var makeDataObjectForKeyFanciness=function(k,q,v,A){var F=[],J=0;k.getKeys();for(var E in q)for(k=q[E],J=0;J<shmotg.MAX_NUMBER_OF_BIN_LEVELS;J++)v===J&&F.push({key:k,which:J,interpolate:A});return F},makeQuartileObjectForKeyFanciness=function(k,q,v){var A=[],F=0;if(-1<k.indexOf("quartiles"))for(F=0;F<shmotg.MAX_NUMBER_OF_BIN_LEVELS;F++)q===F&&A.push({key:"quartiles",which:F,interpolate:v});-1<k.indexOf("missingBox")&&A.push({key:"missingBox",which:0,interpolate:v});return A}; function goToLevel(k,q){var v=maxBinRenderSize(),A=getScaleValue(k)*q,v=Math.log(v/A)/Math.log(2),v=Math.floor(v),v=d3.max([0,v]),v=d3.min([shmotg.MAX_NUMBER_OF_BIN_LEVELS-1,v]);d3.select("#current_level").text(v);return v} var times=msToCentury.times,timeContextFormatSpecifier=[{fun:function(k,q){return q-k<2*times.y},formIf:"%Y",formIfNot:""},{fun:function(k,q){return q-k<2*times.mo},formIf:" %b",formIfNot:""},{fun:function(k,q){return q-k<2*times.d},formIf:" %a %d",formIfNot:""},{fun:function(k,q){return q-k<2*times.h},formIf:" %H",formIfNot:""},{fun:function(k,q){return q-k<2*times.m},formIf:":%M",formIfNot:"h"},{fun:function(k,q){return q-k<2*times.s},formIf:":%Ss",formIfNot:""}]; function dt(k){var q=new Date;q.setTime(k);return q} var getTimeContextString=function(k,q){if(!q)return[];var v=k.domain()[0],A=k.domain()[1],F=!1;return d3.time.format(_.reduce(timeContextFormatSpecifier,function(k,q){if(F)return k;if(q.fun(v,A))return k+q.formIf;F=!0;return k+q.formIfNot},""))(dt(v))},binnedLineChart=function(k,q,v,A,F,J,E,I){function O(e){return Z.getOpacity(e.key)}function S(e,h,l,k,p,q,t,s,w,v,x,z,A,E,B,C,J,F){e=h.selectAll("."+J+l).data(e,generateKey);s?e.attr("transform",transformScale(w,B,E)).transition().ease(v).duration(x).attr("transform", transformScale(t,B,E)):e.attr("opacity",O).attr("transform",transformScale(t,B,E))}var z=[],s=[],x=!0,h=1,e=v,t=A,K=1,Q={top:10,right:27,bottom:25,left:120},da=150-Q.top-Q.bottom,pa=document.getElementById("chartContainer").offsetWidth,la=pa-Q.left-Q.right,p=J?J:0,W=["average","maxes","mins"],ea=["linear"],ta=!0,na,ha,ua,Ba,ja,Na,Oa,X,Ca,fa,xa,l=d3.scale.linear(),w,C,B,ga,$,pb,Ia=!1,ba=!0,Ta=!1,Z=binnedData();if(F)Z.oneSample(F);var aa=[],ma=[],Ua=[],Bb=[],Da=!1,oa={rawData:"",rawDataRanges:[],average:"", averageRanges:[],maxes:"",maxesRanges:[],mins:"",minsRanges:[],q1:"",q1Ranges:[],q2:"",q2Ranges:[],q3:"",q3Ranges:[],quartiles:"",quartilesRanges:[],missing:"",missingRanges:[],missingBox:"",missingBoxRanges:[],loadingBox:"",loadingBoxRanges:[]},Ob=function(){C||(Oa||(Oa=d3.svg.axis().ticks(5).tickSubdivide(!0).tickSize(la,0,0).orient("left")),Oa.scale(fa).tickSize(la,0,0));B=d3.select(this);ba&&(pb.attr("width",la),B.attr("width",la+Q.left+Q.right).attr("height",da+Q.top+Q.bottom));na||(na=B.insert("defs").append("clipPath").attr("id", "clip"+e+t).append("rect"));ba&&na.attr("width",la).attr("transform","translate("+Q.left+", "+Q.top+")").attr("height",da);ga=ga?ga:B.append("g").attr("id","paths"+e+t+"posArea");ba&&ga.attr("clip-path","url(#clip"+e+t+")").attr("class","posArea").attr("height",da);var k=makeQuartileObjectForKeyFanciness(aa,p,ea,!0);Da||ba?drawElements(k,ga,e+t,function(e){return Z.getColor(e.key)},function(e){return"rgba(0,0,0,0)"},function(e){return Z.getDash(e.key)},X,Ia,l,"cubic-in-out",500,oa,Z,Q,Pa,h,"posArea", Da||ba):S(k,ga,e+t,function(e){return Z.getColor(e.key)},function(e){return"rgba(0,0,0,0)"},function(e){return Z.getDash(e.key)},X,Ia,l,"cubic-in-out",500,oa,Z,Q,Pa,h,"posArea",Da||ba);$=$?$:B.append("g").attr("id","paths"+e+t+"posPath");$.attr("clip-path","url(#clip"+e+t+")").attr("class","posPath").attr("height",da);k=makeDataObjectForKeyFanciness(Z,0===p?["average"]:W,p,ea);-1<aa.indexOf("loadingBox")&&k.push({key:"loadingBox",which:0,interpolate:ea});Da||ba?drawElements(k,$,e+t,function(e){console.log(E); return E?"#F0F":"rgba(0,0,0,0)"},function(e){return E?"rgba(0,0,0,0)":0===p?"#4D4D4D":Z.getColor(e.key)},function(e){return Z.getDash(e.key)},X,Ia,l,"cubic-in-out",500,oa,Z,Q,Pa,h,"posPath",Da||ba):S(k,$,e+t,function(e){console.log(E);return E?"#F0F":"rgba(0,0,0,0)"},function(e){return E?"rgba(0,0,0,0)":0===p?"#4D4D4D":Z.getColor(e.key)},function(e){return Z.getDash(e.key)},X,Ia,l,"cubic-in-out",500,oa,Z,Q,Pa,h,"posPath",Da||ba);Ba||(Ba=d3.svg.axis().tickFormat(msToCentury.TickFormat).orient("bottom")); Ba.scale(X).tickValues(msToCentury.TickValues(X,la));ja||(ja=d3.svg.axis().tickFormat(null).scale(X).orient("bottom"));ja.scale(X).tickValues(msToCentury.SubTickValues(X,la));ha||(ha=B.append("g").attr("class","x axis"));ba&&ha.attr("transform","translate("+Q.left+", "+(Q.top+da)+")");ua||(ua=B.append("g").attr("class","x axis minor"));ba&&ua.attr("transform","translate("+Q.left+", "+(Q.top+da)+")");Ia?(ha.transition().duration(500).ease("cubic-in-out").call(Ba),ua.transition().duration(500).ease("cubic-in-out").call(ja)): (ha.call(Ba),ua.call(ja));Na||(Na=B.append("g").attr("class","y axis"));ba&&Na.attr("transform","translate("+(la+Q.left)+", "+Q.top+")");Na.call(Oa);w||(w=B.append("g"));var k=w.selectAll(".sensor_time_context").data([getTimeContextString(X,ta)]),q=w.selectAll(".sensor_title").data([e.capitalize()+" "+t]);k.enter().append("text").attr("class","sensor_time_context");q.enter().append("text").attr("class","sensor_title");k.text(justItself);ba&&k.attr("x",Q.left-5).attr("y",shmotg.TIME_CONTEXT_VERTICAL_EACH); q.text(justItself);ba&&q.attr("x",Q.left+la).attr("y",shmotg.TIME_CONTEXT_VERTICAL_EACH);k.exit().remove();q.exit().remove()},qb=function(e){return fa(e.val)},Ja=function(e){return fa(e[0].val)},Pb=function(e){return fa(e[1].val)},Ea=function(e){Qb(Pa,X);return(e.ms-Pa.domain()[0])*getScaleValue(Pa)},dc=function(e){return Ea(e[0])},fc=function(e,h,l){var k=!1;return function(e,h,l){e=d3.select("#"+e);if(!e)return h;k=k?k:e.append("linearGradient");l=k.attr("id",h).attr("gradientUnits","userSpaceOnUse").attr("x1", X.range()[0]).attr("y1",0).attr("x2",X.range()[1]).attr("y2",0).selectAll("stop").data(l);l.enter().append("stop");l.attr("offset",function(e,h){var l=e.ms,k=X,p=k.range()[0],k=k.range()[1];return(X(l)-p)/(k-p)*100+"%"}).attr("stop-opacity",function(e){return 1-parseFloat(e.val)}).attr("stop-color","black");l.exit().remove();return h}}(),Qb=function(e,h){e.domain()[0]=h.domain()[0];e.domain()[1]=h.domain()[1];e.range()[0]=h.range()[0];e.range()[1]=h.range()[1]},Pa=d3.scale.linear();Z.addRawData(k); var N=function(h){pb=h;la=pa-Q.left-Q.right;X||(X=d3.scale.linear().domain([0,100]));Ca||(Ca=[0,0]);Ca[1]=la;X.range(Ca);fa||(fa=d3.scale.linear());xa||(xa=[0,0]);xa[0]=da;fa.range(xa);aa.length=0;addBValuesToA(aa,W);-1!==W.indexOf("quartiles")&&(-1===W.indexOf("q3")&&aa.push("q3"),-1===W.indexOf("q1")&&aa.push("q1"));-1!==W.indexOf("missing")&&aa.unshift("missingBox");0===p&&(aa.length=0,aa.push("average"));aa.push("loadingBox");var l=X.domain()[1]-X.domain()[0];ma[0]=X.domain()[0]-l;ma[1]=X.domain()[1]+ l;Da=!1;Ua.length=0;for(var k in aa){var l=aa[k],s=0.1*(oa[l+"Ranges"][1]-oa[l+"Ranges"][0]);Bb[0]=oa[l+"Ranges"][0]+s;Bb[1]=oa[l+"Ranges"][1]-s;if(!isWithinRange(X.domain(),Bb)||ba){Da=!0;0===Ua.length&&(s=Z.binSize(p),Ua=d3.extent(Z.getDateRange(aa,p,[ma[0]-s,ma[1]+s],aa),justval));C||Ta||(I?fa.domain([0,1]):fa.domain([Ua[0]?Ua[0]:fa.domain()[0],Ua[1]?Ua[1]:fa.domain()[1]]));if("quartiles"===l){if(E)continue;var s=Z.getDateRangeWithMissingValues("q1",p,ma,"step-after"===ea,aa),w=Z.getDateRangeWithMissingValues("q3", p,ma,"step-after"===ea,aa);oa.quartiles=d3.svg.area().defined(notNaNValFirst).x(dc).y0(Ja).y1(Pb).interpolate(ea)(_.zip(s,w))}else"loadingBox"===l?(s=generateLoadingBoxArray(p,ma,aa,Z),oa.loadingBox=d3.svg.line().defined(isNaNVal).x(Ea).y(fa.range()[0]).interpolate(ea)(s)):"missing"!==l||E?E&&"average"!==l||(E&&"average"===l?(s=Z.getDateRange([l],p,ma,!1,aa),oa.average=d3.svg.area().defined(notNaNVal).x(Ea).y0(fa(0)).y1(fa(1)).interpolate(ea)(s),fc("cloudcover1","cloudgradient",s)):(s=Z.getDateRangeWithMissingValues(l, p,ma,"step-after"===ea,aa),oa[l]=d3.svg.line().defined(notNaNVal).x(Ea).y(qb).interpolate(ea)(s))):(s=generateMissingArray(p,ma,aa,Z),oa.missingBox=d3.svg.area().defined(isNaNVal).x(Ea).y0(fa.range()[0]).y1(fa.range()[1]).interpolate(ea)(s[1]),oa[l]=d3.svg.line().defined(notNaNVal).x(Ea).y(qb).interpolate(ea)(s[0]));oa[l+"Ranges"]=[ma[0],ma[1]]}}!Da||Ta||Z.haveDataInRange(ma,p,aa)||(k={sensorNumber:t,sensorType:e,ms_start:ma[0],ms_end:ma[1],bin_level:p},Ta=!0,void 0===q||q(k)||(Ta=!1));h.each(Ob); ba=Ia=!1};N.milliSecondsPerSample=function(e){if(!arguments.length)return K;K=e;return N};N.containerWidth=function(e){if(!arguments.length)return pa;pa!==e&&N.reRenderTheNextTime(!0);pa=e;return N};N.height=function(e){if(!arguments.length)return da+Q.bottom+Q.top;da!==e&&N.reRenderTheNextTime(!0);da=e;return N};N.whichLevelToRender=function(e){if(!arguments.length)return p;p!==e&&N.reRenderTheNextTime(!0);p=e-Math.floor(Math.log(F/5)/Math.log(2));p=Math.max(p,0);return N};N.whichLinesToRender=function(e){if(!arguments.length)return W; 0===_.difference(e,W).length&&0===_.difference(W,e).length||N.reRenderTheNextTime(!0);W=e;return N};N.strokeWidth=function(e){if(!arguments.length)return h;h=e;return N};N.transitionNextTime=function(e){if(!arguments.length)return Ia;Ia=e;return N};N.reRenderTheNextTime=function(e){if(!arguments.length)return ba;ba=e;return N};N.xScale=function(e){if(!arguments.length)return X;X?X.domain()[0]==e.domain()[0]&&X.domain()[1]==e.domain()[1]||Qb(l,X):l=d3.scale.linear();X=e;return N};N.yScale=function(e){if(!arguments.length)return fa; fa=e;return N};N.update=function(e){N.setSelectedLines();N(pb)};N.showTimeContext=function(e){if(!arguments.length)return ta;ta=e;Q.top+=ta?shmotg.TIME_CONTEXT_VERTICAL_EACH:0;return N};N.setSelectedLines=function(){var e=[].map.call(document.querySelectorAll("#render-lines input:checked"),justValue);N.whichLinesToRender(e);e=document.querySelector("#render-method input:checked").value;e!==ea&&N.reRenderTheNextTime(!0);ea=e;return N};N.uniqueID=function(h){return arguments.length?N:e+t};N.sensorType= function(h){if(!arguments.length)return e;e=h;return N};N.sensorNumber=function(e){if(!arguments.length)return t;t=e;return N};N.yAxisLock=function(e){if(!arguments.length)return C;!0===C&&!1===e&&(N.reRenderTheNextTime(!0),C=e,N.update());C=e;return N};N.addMultiChartChild=function(e){s.push(e)};N.makeIntoMultiChart=function(e,h){Z=multiData(h);for(var l=0;l<e.length;l++)N.addMultiChartParent(e[l]);N.reRenderTheNextTime(!0).update()};N.addMultiChartParent=function(e){z.push(e);Z.addParentData(e.bd())}; N.multiChart_parentBinnedCharts=function(e){if(!arguments.length)return z;z=e;return N};N.multiChart_childrenCharts=function(e){if(!arguments.length)return s;s=e;return N};N.displayThisChart=function(e){if(!arguments.length)return x;x=e;return N};N.binData=function(){return Z};N.incomingRequestedData=function(e){var h=e.req;N.uniqueID()===""+e.sensorType+e.sensorNumber&&N.addDataToBinData(h,e.bin_level).reRenderTheNextTime(!0).update()};N.addDataToBinData=function(e,h){Ta=!1;var l=[],l=0===h?_.filter(e, notNaNVal):e;0!==l.length&&(0===h?Z.addRawData(l):Z.addBinnedData(l,h));return N};N.bd=function(){return Z};return N},myLoader=loader().width(25).height(25);d3.select("#loader_container").call(myLoader);var supportsOrientationChange="onorientationchange"in window,orientationEvent=supportsOrientationChange?"orientationchange":"resize",windowListener=function(){navigator.userAgent.match(/android/i)?setTimeout(redraw,500):redraw()};window.addEventListener(orientationEvent,windowListener,!1); document.getElementById("render-lines").addEventListener("change",changeLines,!1);document.getElementById("render-method").addEventListener("change",changeLines,!1); var plots=[],msPS=5,margin={top:20,right:10,bottom:25,left:120},plotHeightDefault=150,zoomSVG=d3.select("#zoomSVG"),zoomRect=d3.select("#zoomRect"),zoomRectGreyOut=d3.select("#zoomRectGreyOut"),xScale=d3.scale.linear().domain([1325567551E3,1325567552E3]).range([0,document.getElementById("chartContainer").offsetWidth]),yScale=d3.scale.linear(),duration=500,sliderContainerName="#slider_container",curLevel=0,curPos=0,boxSize=34,sliderCallBack=function(k,q,v){if(curLevel!==q){for(var A=0;A<plots.length;A++)plots[A].whichLevelToRender(q).update(); curLevel=q}curPos!==k&&(q=Math.pow(2,k/boxSize),v||rescaleTo(q),curPos=k)},mySlider=slider().height(200).width(2.5*boxSize).boxSize(boxSize).changeCallBack(sliderCallBack).numberOfLevels(33);d3.select(sliderContainerName).call(mySlider);var copyScaleWithoutGarbage=function(k,q){k.domain()[0]=q.domain()[0];k.domain()[1]=q.domain()[1];k.range()[0]=q.range()[0];k.range()[1]=q.range()[1]};function swapItems(k,q,v){k[q]=k.splice(v,1,k[q])[0];return k} function insertItem(k,q,v){k.splice(v,0,q);return k}function insertItemBeforeItem(k,q,v){k.splice(k.indexOf(v),0,q);return k}var getTotalChartHeight=function(k){var q=0;_.each(k,function(k,A){q+=k.height()});return q},setAllYAxisLocks=function(k){for(var q=0;q<plots.length;q++)plots[q].yAxisLock(k)};function insertBeforeDOMPlot(k,q){var v=document.getElementById("charts"),A=v.childNodes;v.insertBefore(A[k],A[q])} function plots_filtered(){return _.filter(plots,function(k){return k.displayThisChart()})} var redraw=function(){var k=d3.select("#charts").selectAll("svg").data(plots_filtered(),function(k,q){return k.uniqueID()});k.enter().append("svg").attr("id",function(k,q){return k.sensorType()+k.sensorNumber()});k.exit().remove();k.call(function(k){k=k[0];for(var q=0;q<k.length;q++)d3.select(k[q]).call(plots_filtered()[q])});for(var k=_.map(plots,function(k){return k.sensorType()+"_"+k.sensorNumber()}),q=_.difference("girder_6 girder_18 girder_19 girder_20 girder_22 girder_40 girder_45".split(" "),k), k=_.map(q,function(k){k=k.split("_");var q=k[0],v=parseInt(k[1]);return{sensorNumber:function(){return v},sensorType:function(){return q}}}),v=plots[0]?plots[0].height():plotHeightDefault+margin.top+margin.bottom,q=document.getElementById("edit").checked?q.length*v:0,A=0,F=plots.length;A<F;A++)plots[A].containerWidth(document.getElementById("chartContainer").offsetWidth).update();d3.select("#charts").attr("width",document.getElementById("chartContainer").offsetWidth);zoomSVG.attr("width",document.getElementById("chartContainer").offsetWidth).transition().duration(duration).attr("height", getTotalChartHeight(plots_filtered())+q);zoomRect.attr("width",document.getElementById("chartContainer").offsetWidth-margin.left-margin.right-16).attr("transform","translate("+margin.left+", "+(margin.top+8)+")").attr("height",Math.max(0,getTotalChartHeight(plots_filtered())-8));zoomRectGreyOut.attr("width",document.getElementById("chartContainer").offsetWidth-margin.left-margin.right-16).attr("transform","translate("+margin.left+", "+(margin.top+8)+")").attr("height",Math.max(0,getTotalChartHeight(plots_filtered())- 8)).style("opacity",0.15).style("fill","#000");q=document.getElementById("chartContainer").offsetWidth-margin.right;A=d3.select("#edit_remove").selectAll("g").data(plots_filtered().concat(k),function(k){return""+k.sensorNumber()+k.sensorType()});F=A.enter().append("g").style("position","absolute");F.append("img").style("position","absolute").attr("width",70).attr("height",70).attr("cursor","pointer").attr("src","./img/remove.svg").on("click",function(k){removePlot(k)});F.append("img").style("position", "absolute").attr("width",70).attr("height",70).attr("cursor","pointer").attr("class","edit_on_top").attr("src","./img/add.svg").on("click",function(k,q){addPlot(k.sensorType(),k.sensorNumber())});A.select(".edit_on_top").transition().duration(duration).style("display","block").style("opacity",function(k){return _.contains(plots_filtered(),k)?0:1}).transition().duration(0).style("display",function(k){return _.contains(plots_filtered(),k)?"none":"block"});A.transition().duration(duration).style("left", q-70+"px").style("top",function(k,q){return q*v+(v-70)/2+"px"});A.exit().remove();A=d3.select("#edit_swap").selectAll("img").data(plots_filtered().slice(0,plots_filtered().length-1));A.enter().append("img").style("position","absolute").attr("src","./img/updown.svg").attr("width",90).attr("height",90).attr("cursor","pointer").on("click",function(k,q){var v=q+1;0>v-1||v>=plots.length||(swapItems(plots,v,v-1),insertBeforeDOMPlot(v,v-1));redraw()});A.style("left","130px").style("top",function(k,q){return v/ 2+20+q*v+(v-90)/2+"px"});A.exit().transition().duration(duration/2).style("opacity",0).transition().remove();A.exit().remove();A=d3.select("#edit_add").selectAll("text").data(k,function(k){return""+k.sensorNumber()+k.sensorType()});A.enter().append("text").attr("class","sensor_title_add").attr("cursor","default").text(function(k){return k.sensorType().capitalize()+" "+k.sensorNumber()}).style("opacity",1);A.transition().duration(duration).attr("x",q-15).attr("y",function(k,q){return getTotalChartHeight(plots_filtered())+ q*v+v/4});A.exit().transition().duration(duration/2).style("opacity",0).transition().remove();A=d3.select("#edit_mult").selectAll("img").data(plots_filtered().slice(0,plots_filtered().length-1));A.enter().append("img").style("position","absolute").attr("src","./img/mult.svg").attr("width",70).attr("height",70).attr("cursor","pointer").on("click",function(k,q){addMultiChart(q,q+1,!0);redraw()});A.style("left","220px").style("top",function(k,q){return v/2+30+q*v+(v-90)/2+"px"});A.exit().transition().duration(duration/ 2).style("opacity",0).transition().remove();A.exit().remove();A=d3.select("#edit_minus").selectAll("img").data(plots_filtered().slice(0,plots_filtered().length-1));A.enter().append("img").style("position","absolute").attr("src","./img/minus.svg").attr("width",70).attr("height",70).attr("cursor","pointer").on("click",function(k,q){addMultiChart(q,q+1,!1);redraw()});A.style("left","310px").style("top",function(k,q){return v/2+30+q*v+(v-90)/2+"px"});A.exit().transition().duration(duration/2).style("opacity", 0).transition().remove();A.exit().remove();updateZoom()}; function removePlot(k){printArrayOfPlots(plots_filtered());for(var q=_.find(plots,function(q){return k.sensorNumber()===q.sensorNumber()&&k.sensorType()===q.sensorType()}),v=0,A=q.multiChart_parentBinnedCharts().length;v<A;v++){var F=q.multiChart_parentBinnedCharts()[v];F.sensorType();F.sensorNumber();plots.splice(plots.indexOf(F),1);addPlot(F.sensorType(),F.sensorNumber())}v=_.find(plots,function(k){return k.sensorNumber()===q.sensorNumber()&&k.sensorType()===q.sensorType()});v=plots.indexOf(v); -1===v&&console.log("PLOT NOT IN PLOTS");plots.splice(v,1);redraw()}function printArrayOfPlots(k){console.log(_.map(k,function(k){return k.sensorType()+"-"+k.sensorNumber()}))} function addMultiChart(k,q,v){var A=plots[k];q=plots[q];var F=v?"x":"-",F=initPlot({},function(){},5,A.sensorType(),A.sensorNumber()+F+q.sensorNumber(),curLevel,!1,!0);F.makeIntoMultiChart([A,q],v);A.addMultiChartChild(F);q.addMultiChartChild(F);insertBeforeDOMPlot(plots_filtered().indexOf(F),k);putLastItemBeforeIndex(plots,k);A.displayThisChart(!1);q.displayThisChart(!1);redraw()}function putLastItemBeforeIndex(k,q){k.splice(q,0,k.pop());return k} function addPlot(k,q){initPlot({},sendRequestToServer,5,k,q,curLevel)}function setAllPlotLevels(){plots.forEach(function(k){k.whichLevelToRender(curLevel).update()})}function transitionAllNextTime(){plots.forEach(function(k){k.transitionNextTime(!0)})}function setLoadingIcon(k){d3.select("#loader_container").style("opacity",k?1:0);d3.selectAll(".loadingBox").style("opacity",k?1:0);myLoader.isShowing(k)} function initPlot(k,q,v,A,F,J,E,I){var O;O=binnedLineChart(k,q,A,F,v,J,E,I);O.xScale(xScale.copy());O.containerWidth(document.getElementById("chartContainer").offsetWidth).height(plotHeightDefault).showTimeContext(!0).milliSecondsPerSample(msPS);plots.push(O);redraw();d3.select("#charts").attr("height",getTotalChartHeight(plots_filtered())).attr("width",document.getElementById("chartContainer").offsetWidth);zoomRect.attr("fill","rgba(0,0,0,0)").call(zoom);updateZoom=function(){zoomAll();xScale=O.xScale(); yScale=O.yScale();zoom.x(xScale);xScale.range([0,document.getElementById("chartContainer").offsetWidth])};updateZoom();return O}var updateZoom=function(){return 0},oldXScale=d3.scale.linear(); function zoomAll(){var k=getScaleValue(xScale),q=boxSize*(Math.log(k)/Math.log(2));if(mySlider.pastExtents(q)){q=oldXScale.copy();for(k=0;k<plots.length;k++)plots[k].xScale(q.copy()).update();xScale=q.copy();zoom.x(xScale)}else for(mySlider.scrollPosition(q).update(!0),k=0;k<plots.length;k++)plots[k].xScale(xScale).update();copyScaleWithoutGarbage(oldXScale,xScale)}var zoom=d3.behavior.zoom().on("zoom",zoomAll);function changeLines(){plots.forEach(function(k){k.setSelectedLines().update()})} function rescaleTo(k){var q=xScale.domain()[1]-xScale.domain()[0];getScaleValue(xScale);zoom.scale();k=((xScale.range()[1]-xScale.range()[0])/k-q)/2;q=d3.scale.linear().range(xScale.range());q.domain([xScale.domain()[0]-k,xScale.domain()[1]+k]);xScale=q;zoom.x(xScale);zoomAll()}function getScaleValue(k){return(k.range()[1]-k.range()[0])/(k.domain()[1]-k.domain()[0])}function zoomin(){changeZoom(function(k,q){return k+q/4},function(k,q){return k-q/4})} function zoomout(){changeZoom(function(k,q){return k-q/2},function(k,q){return k+q/2})}function scrollleft(){changeZoom(function(k,q){return k+q/4},function(k,q){return k+q/4})}function scrollright(){changeZoom(function(k,q){return k-q/4},function(k,q){return k-q/4})}var socket=io.connect("130.179.231.28:8080/"),firstTime=!0;socket.on("news",function(k){firstTime&&(firstTime=!1,socket.emit("ack","Message received!"),initPlot({},sendRequestToServer,5,"girder",18,curLevel))}); var sizeOfQueue=function(){var k=0,q;for(q in serverQueue)serverQueue.hasOwnProperty(q)&&k++;return k},removeFromQueue=function(k){delete serverQueue[k]},serverQueue={};function addToServerQueue(k){serverQueue[k.id]=k.req}var uniqueRequestID=0,listOfRequestsMade=[]; function sendRequestToServer(k){if(_.findWhere(listOfRequestsMade,{sensorNumber:k.sensorNumber,sensorType:k.sensorType,ms_start:k.ms_start,ms_end:k.ms_end,bin_level:k.bin_level}))return!1;setLoadingIcon(!0);listOfRequestsMade.push(k);k={id:uniqueRequestID,req:k};uniqueRequestID+=1;addToServerQueue(k);socket.emit("req",JSON.stringify(k));return!0}socket.on("req_data",function(k){k=JSON.parse(k);removeFromQueue(k.id);0===sizeOfQueue()&&setTimeout(disableLoadingIfQueueIsEmpty,100);for(i=0;i<plots.length;i++)plots[i].incomingRequestedData(k)}); var disableLoadingIfQueueIsEmpty=function(){0===sizeOfQueue()&&setLoadingIcon(!1)}; function offlinedata(){function k(k,q){d3.csv(k,function(k,q){var v=new Date(k.Year,k.Month-1,k.Day,k.Time[0]+""+k.Time[1]);return{val:parseFloat(k.Temp),ms:v.getTime()}},function(k,v){k?console.log("error"):q.addDataToBinData(v,0)})}function q(k,q){d3.csv(k,function(k,q){return{val:"Clear"===k.Weather||"Mainly Clear"===k.Weather?1:0,ms:(new Date(k.Year,k.Month-1,k.Day,k.Time[0]+""+k.Time[1])).getTime()}},function(k,v){k?console.log("error"):q.addDataToBinData(v,0)})}for(var v=initPlot([],function(){}, 36E5,"temperature",1,curLevel),A=initPlot([],function(){},36E5,"cloudcover",1,curLevel,!0,!0),F="weather/eng-hourly-01012012-01312012.csv weather/eng-hourly-02012012-02292012.csv weather/eng-hourly-03012012-03312012.csv weather/eng-hourly-04012012-04302012.csv weather/eng-hourly-08012011-08312011.csv weather/eng-hourly-09012011-09302011.csv weather/eng-hourly-10012011-10312011.csv weather/eng-hourly-11012011-11302011.csv weather/eng-hourly-12012011-12312011.csv".split(" "),J=0;J<F.length;J++)k(F[J], v),q(F[J],A)}rescaleTo(Math.pow(2,mySlider.handlePosition()/boxSize));d3.select("#edit").on("click",toggleEditables); function toggleEditables(){document.getElementById("edit").checked?(d3.select("#edit_remove").style("display","block"),d3.select("#edit_add").style("display","block"),d3.select("#edit_swap").style("display","block"),d3.select("#edit_mult").style("display","block"),d3.select("#edit_minus").style("display","block"),d3.select("#zoomRectGreyOut").style("display","block")):(d3.select("#edit_remove").style("display","none"),d3.select("#edit_add").style("display","none"),d3.select("#edit_swap").style("display", "none"),d3.select("#edit_mult").style("display","none"),d3.select("#edit_minus").style("display","none"),d3.select("#zoomRectGreyOut").style("display","none"));redraw()}toggleEditables();
