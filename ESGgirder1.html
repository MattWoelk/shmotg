<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1">
  <script src="datavisdemo/d3/d3.js"></script> <!-- TODO: fix this so that we're using d3.v2.js for everything (if possible) -->
  <script src="datavisdemo/d3/d3.csv.js"></script>
    <script type="text/javascript" src="json2.js"></script>

    <title>Data visualisation demo</title>
  </head>
  <body>
    <script type="text/javascript">
      if((navigator.userAgent.match(/iPad/i)) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/iPhone/i)) {
        document.write("<button id='back' onclick='history.go(-1);return true;'>back</button>");
      }
    </script>

    <svg id="chart"></svg>

    <script type="text/javascript">

var h = 200;
var w = 0;
var chart = d3.select("#chart")
    .attr("height", h);
var x = d3.scale.linear()
var y = d3.scale.linear()

////d3.json("./queries/ESGgirder1_from_SPBRTData_0A.js", function (data) {
//d3.json("./queries/unemployment.json", function (data) {
//    console.log("data:")
//    console.log(data);
////  d3.select("#chart").selectAll("circle")
////      .data(data)
////    .enter().append("circle")
////      .attr("r", function(d) { return d.ESGgirder1; })
////      .attr("cx", function(d) { return d.ESGgirder1 * 20; })
////      .attr("cy", function(d) { return 20*d.ESGgirder1; })
////      .attr("class", function(d) { return d.ESGgirder1 + "_svg"; });
//});

//raw_data = d3.text("queries/ESGgirder1_from_SPBRTData_0A.js", "text/plain", function(text) { console.log(text); return text; });
//console.log(raw_data);
//json_data = JSON.parse("");
//console.log(json_data);

//d3.json("queries/ESGgirder1_from_SPBRTData_0A.js", function(json) {
//d3.text("queries/ESGgirder1_from_SPBRTData_0A.js", "text/plain", function(json) {
//d3.csv("queries/ESgirder1.csv", function(json) {
d3.json("queries/ESGgirder1_from_SPBRTData_0A.js", function(json) {
    //console.log(json);
    //data = JSON.parse(json);
    data = json;
    w = data.length;
    chart.attr("width", w);

    x.domain([0, data.length])
      .range([0, w]);
    y.domain([d3.min(data, function (d) { return d.ESGgirder1; }), d3.max(data, function (d) { return d.ESGgirder1; })])//d3.max(data)//
      .range([h, 0]);

//    console.log(data);
//    for (nim in data) {
//      console.log(nim);
//    }

    chart.selectAll("rect")
        .data(data)
      .enter().append("rect")
        .attr("y", 0)
        .attr("x", function(d,i) { return x(i); })
        .attr("height", function(d) { return y(d.ESGgirder1); })
        .attr("width", 1);

    //console.log(data);
    });

    </script>

  </body>
</html>
