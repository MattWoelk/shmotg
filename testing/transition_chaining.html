<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <!--[if lt IE 9]>
    <script src="dist/html5shiv.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="normalize.css">

    <title>Transition Chaining</title>
  </head>
  <body style="margin: 10px">
    Click for a transition:<br />
    <div id="charts"></div>
    <script src="d3.v3.js"></script>
    <!--<script src="http://d3js.org/d3.v3.js"></script>-->
    <script src="underscore.js"></script>

    <script type="text/javascript">
var data = [1, 3, 2, 5, 4, 3, 7, 1];
var margin = {top: 40, right: 10, bottom: 20, left: 10},
    width = 460 - margin.left - margin.right,
    height = 180 - margin.top - margin.bottom;

var crtz = d3.select("#charts").append("svg")
  .attr("height", height + margin.top + margin.bottom)
  .attr("width" , width + margin.left + margin.right)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var rect = crtz.selectAll("rect")
  .data(data)
  .enter().append("rect")
    .attr("x", function (d, i) { return i*22; })
    .attr("y", function (d) { return height - d*20; })
    .attr("height", function (d, i) { return d*20; })
    .attr("width", 20)
    .attr("fill", "#404")
    .on("click", transition_randomly);

function transition_randomly (d, i) {
  rect.transition().duration(500)
      .delay(function (d, i) { return i * 100; })
      .attr("height", function() { return Math.random()*100; })
    .transition().duration(2000)
      .attr("y", function() { return Math.random()*60; });
};


    </script>
  </body>
</html>
